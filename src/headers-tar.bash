Li9lbXVsYXRvcl9hcGkuaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMDA2NDQAMDAwMTc1
MAAwMDAxNzUwADAwMDAwMDQzNDY2ADEyMzU3Mjc1NDExADAxMzQxMwAgMAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB1c3RhciAgAHBhbG1lcgAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAcGFsbWVyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv
LyBIZWFkZXIgZm9yIENoaXNlbCBlbXVsYXRvciBBUEkKI2lmbmRlZiBfX0lTX0VNVUxBVE9SX0FQ
SV9fCiNkZWZpbmUgX19JU19FTVVMQVRPUl9BUElfXwoKI2luY2x1ZGUgImVtdWxhdG9yX21vZC5o
IgoKI2luY2x1ZGUgPHN0cmluZz4KI2luY2x1ZGUgPHNzdHJlYW0+CiNpbmNsdWRlIDxtYXA+CiNp
bmNsdWRlIDxjYXNzZXJ0PgoKLyoqCiAqIENvbnZlcnRzIGFuIGludGVnZXIgdG8gYSBzdGQ6OnN0
cmluZyB3aXRob3V0IG5lZWRpbmcgYWRkaXRpb25hbCBsaWJyYXJpZXMKICogb3IgQysrMTEuCiAq
LwpzdGF0aWMgc3RkOjpzdHJpbmcgaXRvcyhpbnQgaW4pIHsKCXN0ZDo6c3RyaW5nc3RyZWFtIG91
dDsKCW91dCA8PCBpbjsKCXJldHVybiBvdXQuc3RyKCk7Cn0KCi8qKgogKiBDb3B5IG9uZSB2YWxf
dCBhcnJheSB0byBhbm90aGVyLgogKiBuYiBtdXN0IGJlIHRoZSBleGFjdCBudW1iZXIgb2YgYml0
cyB0aGUgdmFsX3QgcmVwcmVzZW50cy4KICovCnN0YXRpYyB2b2lkIHZhbF9jcHkodmFsX3QqIGRz
dCwgdmFsX3QqIHNyYywgaW50IG5iKSB7CiAgICBmb3IgKGludCBpPTA7IGk8dmFsX25fd29yZHMo
bmIpOyBpKyspIHsKICAgICAgICBkc3RbaV0gPSBzcmNbaV07CiAgICB9Cn0KCi8qKgogKiBFbXB0
eSBhIHZhbF90IGFycmF5IChzZXRzIHRvIHplcm8pLgogKiBuYiBtdXN0IGJlIHRoZSBleGFjdCBu
dW1iZXIgb2YgYml0cyB0aGUgdmFsX3QgcmVwcmVzZW50cy4KICovCnN0YXRpYyB2b2lkIHZhbF9l
bXB0eSh2YWxfdCogZHN0LCBpbnQgbmIpIHsKICAgIGZvciAoaW50IGk9MDsgaTx2YWxfbl93b3Jk
cyhuYik7IGkrKykgewogICAgICAgIGRzdFtpXSA9IDA7CiAgICB9Cn0KCi8qKgogKiBTZXQgYSB2
YWxfdCBhcnJheSB0byBhIGludGVnZXIgbnVtYmVyLiBPYnZpb3VzbHksIHRoZSBtYXhpbXVtIGlu
dGVnZXIKICogaXMgY2FwcGVkIGJ5IHRoZSB3aWR0aCBvZiBhIHNpbmdsZSB2YWxfdCBlbGVtZW50
LgogKiBuYiBtdXN0IGJlIHRoZSBleGFjdCBudW1iZXIgb2YgYml0cyB0aGUgdmFsX3QgcmVwcmVz
ZW50cy4KICovCnN0YXRpYyB2b2lkIHZhbF9zZXQodmFsX3QqIGRzdCwgdmFsX3QgbmIsIHZhbF90
IG51bSkgewogICAgdmFsX2VtcHR5KGRzdCwgbmIpOwogICAgZHN0WzBdID0gbnVtOwp9CgovKioK
ICogU2V0cyBhIGRhdF90IGZyb20gYSBzdHJpbmcsIHdoZXJlIHRoZSBpbnB1dCByYWRpeCBpcyBh
dXRvbWF0aWNhbGx5IGRldGVybWluZWQKICogZnJvbSB0aGUgc3RyaW5nIChvciBkZWZhdWx0cyB0
byAxMCkuCiAqIFJldHVybnMgdHJ1ZSBvbiBzdWNjZXNzLgogKi8KdGVtcGxhdGUgPGludCB3Pgpi
b29sIGRhdF9mcm9tX3N0cihzdGQ6OnN0cmluZyBpbiwgZGF0X3Q8dz4mIHJlcywgaW50IHBvcyA9
IDApIHsKICAgIGludCByYWRpeCA9IDEwOwoKICAgIGlmICghaW4uc3Vic3RyKHBvcywgMSkuY29t
cGFyZSgiZCIpKSB7CiAgICAgICAgcmFkaXggPSAxMDsKICAgICAgICBwb3MrKzsKICAgIH0gZWxz
ZSBpZiAoIWluLnN1YnN0cihwb3MsIDEpLmNvbXBhcmUoImgiKQogICAgICAgICAgICAgICB8fCAh
aW4uc3Vic3RyKHBvcywgMSkuY29tcGFyZSgieCIpKSB7CiAgICAgICAgcmFkaXggPSAxNjsKICAg
ICAgICBwb3MrKzsKICAgIH0gZWxzZSBpZiAoIWluLnN1YnN0cihwb3MsIDIpLmNvbXBhcmUoIjBo
IikKICAgICAgICAgICAgICAgfHwgIWluLnN1YnN0cihwb3MsIDIpLmNvbXBhcmUoIjB4IikpIHsK
ICAgICAgICByYWRpeCA9IDE2OwogICAgICAgIHBvcyArPSAyOwogICAgfSBlbHNlIGlmICghaW4u
c3Vic3RyKHBvcywgMSkuY29tcGFyZSgiYiIpKSB7CiAgICAgICAgcmFkaXggPSAyOwogICAgICAg
IHBvcysrOwogICAgfSBlbHNlIGlmICghaW4uc3Vic3RyKHBvcywgMikuY29tcGFyZSgiMGIiKSkg
ewogICAgICAgIHJhZGl4ID0gMjsKICAgICAgICBwb3MgKz0gMjsKICAgIH0KCiAgICBjb25zdCBp
bnQgbG9nX21heF9yYWRpeCA9IDQ7CiAgICBhc3NlcnQocmFkaXggPD0gKDEgPDwgbG9nX21heF9y
YWRpeCkpOwoKICAgIGRhdF90PHc+IGN1cnJfYmFzZSA9IDE7CiAgICByZXMgPSAwOwoKICAgIGZv
ciAoaW50IHJwb3M9aW4ubGVuZ3RoKCktMTsgcnBvcz49cG9zOyBycG9zLS0pIHsKICAgICAgICBj
aGFyIGMgPSBpbltycG9zXTsKICAgICAgICB2YWxfdCBjX3ZhbCA9IDA7CiAgICAgICAgaWYgKGMg
PT0gJ18nKSB7CiAgICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KICAgICAgICBpZiAoYyA+
PSAnMCcgJiYgYyA8PSAnOScpIHsKICAgICAgICAgICAgY192YWwgPSBjIC0gJzAnOwogICAgICAg
IH0gZWxzZSBpZiAoYyA+PSAnYScgJiYgYyA8PSAneicpIHsKICAgICAgICAgICAgY192YWwgPSBj
IC0gJ2EnICsgMTA7CiAgICAgICAgfSBlbHNlIGlmIChjID49ICdBJyAmJiBjIDw9ICdaJykgewog
ICAgICAgICAgICBjX3ZhbCA9IGMgLSAnQScgKyAxMDsKICAgICAgICB9IGVsc2UgewogICAgICAg
ICAgICBzdGQ6OmNlcnIgPDwgImRhdF9mcm9tX3N0cjogSW52YWxpZCBjaGFyYWN0ZXIgJyIgPDwg
YyA8PCAiJyIgPDwKICAgICAgICAgICAgCQlzdGQ6OmVuZGw7CiAgICAgICAgICAgIHJldHVybiBm
YWxzZTsKICAgICAgICB9CiAgICAgICAgaWYgKGNfdmFsID4gcmFkaXggLyogfHwgY192YWwgPCAw
ICovKSB7CiAgICAgICAgICAgIHN0ZDo6Y2VyciA8PCAiZGF0X2Zyb21fc3RyOiBJbnZhbGlkIGNo
YXJhY3RlciAnIiA8PCBjIDw8ICInIiA8PAogICAgICAgICAgICAJCXN0ZDo6ZW5kbDsKICAgICAg
ICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgZGF0X3Q8dz4gdGVtcF9wcm9k
ID0gY3Vycl9iYXNlICogZGF0X3Q8bG9nX21heF9yYWRpeD4oY192YWwpOwogICAgICAgIHJlcyA9
IHJlcyArIHRlbXBfcHJvZDsKICAgICAgICBjdXJyX2Jhc2UgPSBjdXJyX2Jhc2UgKiBkYXRfdDxs
b2dfbWF4X3JhZGl4KzE+KHJhZGl4KTsKICAgIH0KICAgIHJldHVybiB0cnVlOwp9CgovLyBBUEkg
YmFzZSBjbGFzcywgcHJvdmlkaW5nIGNvbW1vbiBmdW5jdGlvbnMKY2xhc3MgYXBpX2Jhc2Ugewpw
dWJsaWM6CglhcGlfYmFzZShjb25zdCBjaGFyKiBuZXdfbmFtZSwgY29uc3QgY2hhciogbmV3X3Bh
dGgpIDoKCQluYW1lKG5ld19uYW1lKSwKCQlwYXRoKG5ld19wYXRoKQoJe30KCS8vIHJldHVybnMg
dGhlIGZ1bGx5IHF1YWxpZmllZCBuYW1lIG9mIHRoaXMgb2JqZWN0IChwYXRoICsgZG90ICsgbmFt
ZSkKCXN0ZDo6c3RyaW5nIGdldF9wYXRobmFtZSgpIHsKCQlpZiAoKnBhdGggPT0gJ1wwJykgewoJ
CQlyZXR1cm4gbmFtZTsKCQl9IGVsc2UgewoJCQlyZXR1cm4gZ2V0X3BhdGgoKSArICIuIiArIG5h
bWU7CgkJfQoJfQoJLy8gcmV0dXJucyB0aGUgc2hvcnQgbmFtZSBvZiB0aGlzIG9iamVjdAoJc3Rk
OjpzdHJpbmcgZ2V0X25hbWUoKSB7CgkJcmV0dXJuIG5hbWU7Cgl9CgkvLyByZXR1cm5zIHRoZSBw
YXRoIG9mIHRoaXMgb2JqZWN0ICh3aXRob3V0IGEgdHJhaWxpbmcgZG90KQoJc3RkOjpzdHJpbmcg
Z2V0X3BhdGgoKSB7CgkJcmV0dXJuIHBhdGg7Cgl9CnByb3RlY3RlZDoKCWNvbnN0IGNoYXIqIG5h
bWU7Cgljb25zdCBjaGFyKiBwYXRoOwp9OwoKLy8gQVBJIGJhc2UgKG5vbiB3aWR0aCB0ZW1wbGF0
ZWQpIGNsYXNzIGZvciBBUEkgYWNjZXNzb3JzIHRvIGRhdF90CmNsYXNzIGRhdF9hcGlfYmFzZSA6
IHB1YmxpYyBhcGlfYmFzZSB7CnB1YmxpYzoKCWRhdF9hcGlfYmFzZShjb25zdCBjaGFyKiBuZXdf
bmFtZSwgY29uc3QgY2hhciogbmV3X3BhdGgpIDoKCQlhcGlfYmFzZShuZXdfbmFtZSwgbmV3X3Bh
dGgpCgl7fQoJLy8gcmV0dXJucyB0aGUgdmFsdWUgb2YgdGhpcyB3aXJlIGFzIGEgc3RyaW5nLCBv
ciBlbXB0eSBzdHJpbmcgb24gZmFpbHVyZQoJdmlydHVhbCBzdGQ6OnN0cmluZyBnZXRfdmFsdWUo
KSA9IDA7CgkvLyBzZXRzIHRoZSB2YWx1ZSBvZiB0aGlzIHdpcmUgZnJvbSBhIHN0cmluZywgcmV0
dXJuaW5nIHRydWUgb24gc3VjY2VzcwoJdmlydHVhbCBib29sIHNldF92YWx1ZShzdGQ6OnN0cmlu
ZyB2YWx1ZSkgPSAwOwoJLy8gcmV0dXJucyB0aGUgYml0d2lkdGggb2YgdGhpcyB3aXJlCgl2aXJ0
dWFsIHN0ZDo6c3RyaW5nIGdldF93aWR0aCgpID0gMDsKfTsKCi8vIGRhdF9hcGkgZHVtbXkgY2xh
c3MsIGRvZXMgbm90aGluZyBleGNlcHQgZm9yIHJldHVybiBlcnJvcnMKLy8gdG8gYmUgdXNlZCB3
aGVuIGEgcmVhbCBkYXRfYXBpIG9iamVjdCBjYW4ndCBiZSBmb3VuZApjbGFzcyBkYXRfZHVtbXkg
OiBwdWJsaWMgZGF0X2FwaV9iYXNlIHsKcHVibGljOgoJZGF0X2R1bW15KCkgOgoJCWRhdF9hcGlf
YmFzZSgiZXJyb3IiLCAiIikKCXt9CglzdGQ6OnN0cmluZyBnZXRfdmFsdWUoKSB7CgkJcmV0dXJu
ICJlcnJvciI7Cgl9CgoJYm9vbCBzZXRfdmFsdWUoc3RkOjpzdHJpbmcgdmFsdWUpIHsKCQlyZXR1
cm4gZmFsc2U7Cgl9CgoJc3RkOjpzdHJpbmcgZ2V0X3dpZHRoKCkgewoJCXJldHVybiAiZXJyb3Ii
OwoJfQp9OwoKdGVtcGxhdGU8aW50IHc+IGNsYXNzIGRhdF9hcGkgOiBwdWJsaWMgZGF0X2FwaV9i
YXNlIHsKcHVibGljOgoJZGF0X2FwaShkYXRfdDx3PiogbmV3X2RhdCwgY29uc3QgY2hhciogbmV3
X25hbWUsIGNvbnN0IGNoYXIqIG5ld19wYXRoKSA6CgkJZGF0X2FwaV9iYXNlKG5ld19uYW1lLCBu
ZXdfcGF0aCksCgkJZGF0X3B0cihuZXdfZGF0KQoJe30KCglzdGQ6OnN0cmluZyBnZXRfdmFsdWUo
KSB7CgkJcmV0dXJuIGRhdF9wdHItPnRvX3N0cigpOwoJfQoKCWJvb2wgc2V0X3ZhbHVlKHN0ZDo6
c3RyaW5nIHZhbHVlKSB7CgkJcmV0dXJuIGRhdF9mcm9tX3N0cjx3Pih2YWx1ZSwgKmRhdF9wdHIp
OwoJfQoKCXN0ZDo6c3RyaW5nIGdldF93aWR0aCgpIHsKCQlyZXR1cm4gaXRvcyh3KTsKCX0KCnBy
b3RlY3RlZDoKCWRhdF90PHc+KiBkYXRfcHRyOwp9OwoKLy8gQVBJIGJhc2UgKG5vbiB3aWR0aC9k
ZXB0aCB0ZW1wbGF0ZWQpIGNsYXNzIGZvciBBUEkgYWNjZXNzb3JzIHRvIG1lbV90CmNsYXNzIG1l
bV9hcGlfYmFzZSA6IHB1YmxpYyBhcGlfYmFzZSB7CnB1YmxpYzoKCW1lbV9hcGlfYmFzZShjb25z
dCBjaGFyKiBuZXdfbmFtZSwgY29uc3QgY2hhciogbmV3X3BhdGgpIDoKCQlhcGlfYmFzZShuZXdf
bmFtZSwgbmV3X3BhdGgpCgl7fQoJLy8gcmV0dXJuIHRoZSB2YWx1ZSBvZiBhbiBlbGVtZW50IGFz
IGEgc3RyaW5nLCBvciBlbXB0eSBzdHJpbmcgb24gZmFpbHVyZQoJdmlydHVhbCBzdGQ6OnN0cmlu
ZyBnZXRfZWxlbWVudChzdGQ6OnN0cmluZyBpbmRleCkgPSAwOwoJLy8gc2V0cyB0aGUgdmFsdWUg
b2YgYW4gZWxlbWVudCBmcm9tIGEgc3RyaW5nLCByZXR1cm5pbmcgdHJ1ZSBvbiBzdWNjZXNzCgl2
aXJ0dWFsIGJvb2wgc2V0X2VsZW1lbnQoc3RkOjpzdHJpbmcgaW5kZXgsIHN0ZDo6c3RyaW5nIHZh
bHVlKSA9IDA7CgkvLyByZXR1cm5zIHRoZSBiaXR3aWR0aCBvZiBhIG1lbW9yeSBlbGVtZW50Cgl2
aXJ0dWFsIHN0ZDo6c3RyaW5nIGdldF93aWR0aCgpID0gMDsKCS8vIHJldHVybnMgdGhlIG51bWJl
ciBvZiBtZW1vcnkgZWxlbWVudHMKCXZpcnR1YWwgc3RkOjpzdHJpbmcgZ2V0X2RlcHRoKCkgPSAw
Owp9OwoKLy8gbWVtX2FwaSBkdW1teSBjbGFzcywgZG9lcyBub3RoaW5nIGV4Y2VwdCBmb3IgcmV0
dXJuIGVycm9ycwovLyB0byBiZSB1c2VkIHdoZW4gYSByZWFsIG1lbV9hcGkgb2JqZWN0IGNhbid0
IGJlIGZvdW5kCmNsYXNzIG1lbV9kdW1teSA6IHB1YmxpYyBtZW1fYXBpX2Jhc2UgewpwdWJsaWM6
CgltZW1fZHVtbXkoKSA6CgkJbWVtX2FwaV9iYXNlKCJlcnJvciIsICIiKQoJe30KCXN0cmluZyBn
ZXRfZWxlbWVudChzdGQ6OnN0cmluZyBpbmRleCkgewoJCXJldHVybiAiZXJyb3IiOwoJfQoKCWJv
b2wgc2V0X2VsZW1lbnQoc3RkOjpzdHJpbmcgaW5kZXgsIHN0ZDo6c3RyaW5nIHZhbHVlKSB7CgkJ
cmV0dXJuIGZhbHNlOwoJfQoKCXN0ZDo6c3RyaW5nIGdldF93aWR0aCgpIHsKCQlyZXR1cm4gImVy
cm9yIjsKCX0KCglzdGQ6OnN0cmluZyBnZXRfZGVwdGgoKSB7CgkJcmV0dXJuICJlcnJvciI7Cgl9
Cn07Cgp0ZW1wbGF0ZTxpbnQgdywgaW50IGQ+IGNsYXNzIG1lbV9hcGkgOiBwdWJsaWMgbWVtX2Fw
aV9iYXNlIHsKcHVibGljOgoJbWVtX2FwaShtZW1fdDx3LCBkPiogbmV3X21lbSwgY29uc3QgY2hh
ciogbmV3X25hbWUsIGNvbnN0IGNoYXIqIG5ld19wYXRoKSA6CgkJbWVtX2FwaV9iYXNlKG5ld19u
YW1lLCBuZXdfcGF0aCksCgkJbWVtX3B0cihuZXdfbWVtKQoJe30KCglzdHJpbmcgZ2V0X2VsZW1l
bnQoc3RkOjpzdHJpbmcgaW5kZXgpIHsKCQlpbnQgaW5kZXhfaW50ID0gYXRvaShpbmRleC5jX3N0
cigpKTsKCQlyZXR1cm4gbWVtX3B0ci0+Y29udGVudHNbaW5kZXhfaW50XS50b19zdHIoKTsKCX0K
Cglib29sIHNldF9lbGVtZW50KHN0ZDo6c3RyaW5nIGluZGV4LCBzdGQ6OnN0cmluZyB2YWx1ZSkg
ewoJCWludCBpbmRleF9pbnQgPSBhdG9pKGluZGV4LmNfc3RyKCkpOwoJCXJldHVybiBkYXRfZnJv
bV9zdHI8dz4odmFsdWUsIG1lbV9wdHItPmNvbnRlbnRzW2luZGV4X2ludF0pOwoJfQoKCXN0ZDo6
c3RyaW5nIGdldF93aWR0aCgpIHsKCQlyZXR1cm4gaXRvcyh3KTsKCX0KCglzdGQ6OnN0cmluZyBn
ZXRfZGVwdGgoKSB7CgkJcmV0dXJuIGl0b3MoZCk7Cgl9Cgpwcm90ZWN0ZWQ6CgltZW1fdDx3LCBk
PiogbWVtX3B0cjsKfTsKCmNsYXNzIG1vZF9hcGlfdCB7CnB1YmxpYzoKCW1vZF9hcGlfdCgpOgoJ
CXRlZWZpbGUoTlVMTCkKCXt9CgoJdm9pZCBpbml0KG1vZF90KiBuZXdfbW9kdWxlKSB7CgkJbW9k
dWxlID0gbmV3X21vZHVsZTsKCQlpbml0X21hcHBpbmdfdGFibGUoKTsKCX0KCgl2b2lkIHNldF90
ZWVmaWxlKEZJTEUqIG5ld190ZWVmaWxlKSB7CgkJdGVlZmlsZSA9IG5ld190ZWVmaWxlOwoJfQoK
CW1vZF90KiBnZXRfbW9kdWxlKCkgewoJCXJldHVybiBtb2R1bGU7Cgl9CgoJLy8gQVBJIGJhc2lj
IGZ1bmN0aW9ucwoJc3RkOjpzdHJpbmcgZ2V0X2hvc3RfbmFtZSgpIHtyZXR1cm4gIkMrKyBFbXVs
YXRvciBBUEkiO30KCXN0ZDo6c3RyaW5nIGdldF9hcGlfdmVyc2lvbigpIHtyZXR1cm4gIjAiO30K
CXN0ZDo6c3RyaW5nIGdldF9hcGlfc3VwcG9ydCgpIHtyZXR1cm4gIlBlZWtQb2tlIEludHJvc3Bl
Y3Rpb24iO30KCgkvLyBFeHRlcm5hbCBhY2Nlc3MgZnVuY3Rpb25zICYgaGVscGVycwoJc3RkOjp2
ZWN0b3I8IHN0ZDo6c3RyaW5nID4gdG9rZW5pemUoc3RkOjpzdHJpbmcgc3RyKSB7CgkgICAgc3Rk
Ojp2ZWN0b3I8IHN0ZDo6c3RyaW5nID4gcmVzOwoJICAgIGludCBpID0gMDsKCSAgICBpbnQgYyA9
ICcgJzsKCSAgICB3aGlsZSAoIGkgPCBzdHIuc2l6ZSgpICkgewoJICAgICAgd2hpbGUgKGlzc3Bh
Y2UoYykpIHsKCSAgICAgICAgaWYgKGkgPj0gc3RyLnNpemUoKSkgcmV0dXJuIHJlczsKCSAgICAg
ICAgYyA9IHN0cltpKytdOwoJICAgICAgfQoJICAgICAgc3RkOjpzdHJpbmcgczsKCSAgICAgIHdo
aWxlICghaXNzcGFjZShjKSAmJiBpIDwgc3RyLnNpemUoKSkgewoJICAgICAgICBzLnB1c2hfYmFj
ayhjKTsKCSAgICAgICAgYyA9IHN0cltpKytdOwoJICAgICAgfQoJICAgICAgaWYgKGkgPj0gc3Ry
LnNpemUoKSkgcy5wdXNoX2JhY2soYyk7CgkgICAgICBpZiAocy5zaXplKCkgPiAwKQoJICAgICAg
ICByZXMucHVzaF9iYWNrKHMpOwoJICAgIH0KCSAgICByZXR1cm4gcmVzOwoJfQoKCS8vIGhlbHBl
ciB0byB2ZXJpZnkgY29tbWFuZCBsZW5ndGgsIHJldHVybmluZyBmYWxzZSBhbmQgcHJpbnRpbmcg
YW4gZXJyb3IKCS8vIHRvIHN0ZGVyciBpZiB0aGUgbGVuZ3RoIGlzbid0IGluIHRoZSBzcGVjaWZp
ZWQgcmFuZ2UKCWJvb2wgY2hlY2tfY29tbWFuZF9sZW5ndGgoc3RkOjp2ZWN0b3I8c3RkOjpzdHJp
bmc+JiB0b2tlbml6ZWRfY29tbWFuZCwKCQkJaW50IG1pbl9hcmdzLCBpbnQgbWF4X2FyZ3M9LTEp
IHsKCQlpZiAodG9rZW5pemVkX2NvbW1hbmQuc2l6ZSgpIC0gMSA8IG1pbl9hcmdzKSB7CgkJCXN0
ZDo6Y2VyciA8PCB0b2tlbml6ZWRfY29tbWFuZFswXSA8PCAiIGV4cGVjdHMgYXQgbGVhc3QgIiA8
PCBtaW5fYXJncwoJCQkJCTw8ICIgYXJncywgZ290ICIgPDwgdG9rZW5pemVkX2NvbW1hbmQuc2l6
ZSgpIC0gMQoJCQkJCTw8IHN0ZDo6ZW5kbDsKCQkJcmV0dXJuIGZhbHNlOwoJCX0gZWxzZSBpZiAo
bWF4X2FyZ3MgPj0gMCAmJiB0b2tlbml6ZWRfY29tbWFuZC5zaXplKCkgLSAxID4gbWF4X2FyZ3Mp
IHsKCQkJc3RkOjpjZXJyIDw8IHRva2VuaXplZF9jb21tYW5kWzBdIDw8ICIgZXhwZWN0cyBhdCBt
b3N0ICIgPDwgbWF4X2FyZ3MKCQkJCQk8PCAiIGFyZ3MsIGdvdCAiIDw8IHRva2VuaXplZF9jb21t
YW5kLnNpemUoKSAtIDEKCQkJCQk8PCBzdGQ6OmVuZGw7CgkJCXJldHVybiBmYWxzZTsKCQl9CgkJ
cmV0dXJuIHRydWU7Cgl9CgoJLy8gRXZhbHVhdGVzIGFuIEFQSSBjb21tYW5kLCByZXR1cm5pbmcg
dGhlIHJlcGx5IGFzIGEgc3RyaW5nICh3aXRob3V0CgkvLyB0aGUgdHJhaWxpbmcgbmV3bGluZSku
CgkvLyBFcnJvcnMgcmV0dXJuICJlcnJvciIsIHByaW50aW5nIGEgbW9yZSBkZXRhaWxlZCBkZXNj
cmlwdGlvbiB0byBzdGRlcnIuCgkvLyBUT0RPOiBmaW5kIGEgd2F5IHRvIHBhc3MgZXJyb3JzIGlu
LWxpbmUsIHNvIHRyYW5zcG9ydCBsYXllcnMgb3RoZXIgdGhhbgoJLy8gc3RkaW4vc3Rkb3V0IChs
aWtlIFRDUC9JUCkgYXJlIHBvc3NpYmxlIHdoaWxlIGFsc28gY29tbXVuaWNhdGluZyBlcnJvcnMu
CglzdGQ6OnN0cmluZyBldmFsX2NvbW1hbmQoc3RyaW5nIGNvbW1hbmQpIHsKCQlzdGQ6OnZlY3Rv
cjxzdGQ6OnN0cmluZz4gdG9rZW5zID0gdG9rZW5pemUoY29tbWFuZCk7CgkJaWYgKHRva2Vucy5z
aXplKCkgPT0gMCkgewoJCQlzdGQ6OmNlcnIgPDwgIkVtcHR5IGNvbW1hbmQ6ICciIDw8IGNvbW1h
bmQgPDwgIiciIDw8IHN0ZDo6ZW5kbDsKCQkJcmV0dXJuICJlcnJvciI7CgkJfQoJCWlmICh0b2tl
bnNbMF0gPT0gImdldF9ob3N0X25hbWUiKSB7CgkJCS8vIElOOiAgZ2V0X2hvc3RfbmFtZQoJCQkv
LyBPVVQ6IEFQSSBob3N0J3MgbmFtZSAoYXJiaXRyYXJ5IHN0cmluZykKCQkJaWYgKCFjaGVja19j
b21tYW5kX2xlbmd0aCh0b2tlbnMsIDAsIDApKSB7IHJldHVybiAiZXJyb3IiOyB9CgkJCXJldHVy
biBnZXRfaG9zdF9uYW1lKCk7CgkJfSBlbHNlIGlmICh0b2tlbnNbMF0gPT0gImdldF9hcGlfdmVy
c2lvbiIpIHsKCQkJLy8gQkVUQSBGVU5DVElPTjogc2VtYW50aWNzIHN1YmplY3QgdG8gY2hhbmdl
LCB1c2Ugd2l0aCBjYXV0aW9uCgkJCS8vIElOOiAgZ2V0X2FwaV92ZXJzaW9uCgkJCS8vIE9VVDog
QVBJIHZlcnNpb24gc3VwcG9ydGVkIGJ5IHRoaXMgaG9zdAoJCQlpZiAoIWNoZWNrX2NvbW1hbmRf
bGVuZ3RoKHRva2VucywgMCwgMCkpIHsgcmV0dXJuICJlcnJvciI7IH0KCQkJcmV0dXJuIGdldF9h
cGlfdmVyc2lvbigpOwoJCX0gZWxzZSBpZiAodG9rZW5zWzBdID09ICJnZXRfYXBpX3N1cHBvcnQi
KSB7CgkJCS8vIEJFVEEgRlVOQ1RJT046IHNlbWFudGljcyBzdWJqZWN0IHRvIGNoYW5nZSwgdXNl
IHdpdGggY2F1dGlvbgoJCQkvLyBJTjogIGdldF9hcGlfc3VwcG9ydAoJCQkvLyBPVVQ6IGxpc3Qg
b2Ygc3VwcG9ydGVkIEFQSSBmZWF0dXJlcwoJCQlpZiAoIWNoZWNrX2NvbW1hbmRfbGVuZ3RoKHRv
a2VucywgMCwgMCkpIHsgcmV0dXJuICJlcnJvciI7IH0KCQkJcmV0dXJuIGdldF9hcGlfc3VwcG9y
dCgpOwoJCX0gZWxzZSBpZiAodG9rZW5zWzBdID09ICJjbG9jayIpIHsKCQkJLy8gQkVUQSBGVU5D
VElPTjogc2VtYW50aWNzIHN1YmplY3QgdG8gY2hhbmdlLCB1c2Ugd2l0aCBjYXV0aW9uCgkJCS8v
IElOOiAgY2xvY2sgPG51bV9jeWNsZXM+CgkJCS8vIE9VVDogYWN0dWFsIG51bWJlciBvZiBjeWNs
ZXMgc3RlcHBlZAoJCQlpZiAoIWNoZWNrX2NvbW1hbmRfbGVuZ3RoKHRva2VucywgMSwgMSkpIHsg
cmV0dXJuICJlcnJvciI7IH0KCQkJaW50IGN5Y2xlcyA9IGF0b2kodG9rZW5zWzFdLmNfc3RyKCkp
OwoJCSAgICBmb3IgKGludCBpPTA7IGk8Y3ljbGVzOyBpKyspIHsKCQkgICAgCW1vZHVsZS0+Y2xv
Y2tfbG8oZGF0X3Q8MT4oMCkpOwoJCSAgICAJbW9kdWxlLT5jbG9ja19oaShkYXRfdDwxPigwKSk7
CgkJCW1vZHVsZS0+ZHVtcCgpOwoJCSAgICB9CgkJICAgIG1vZHVsZS0+Y2xvY2tfbG8oZGF0X3Q8
MT4oMCkpOwoJCSAgICByZXR1cm4gaXRvcyhjeWNsZXMpOwoJCX0gZWxzZSBpZiAodG9rZW5zWzBd
ID09ICJwcm9wYWdhdGUiKSB7CgkJCS8vIEJFVEEgRlVOQ1RJT046IHNlbWFudGljcyBzdWJqZWN0
IHRvIGNoYW5nZSwgdXNlIHdpdGggY2F1dGlvbgoJCQkvLyBJTjogIHByb3BhZ2F0ZQoJCQkvLyBP
VVQ6IG9rIChvbiBzdWNjZXNzKQoJCQkvLyBUaGlzIGZ1bmN0aW9uIHByb3BhZ2F0ZXMgdGhlIGNv
bWJpbmF0aW9uYWwgbG9naWMsIHdpdGhvdXQKCQkJLy8gdXBkYXRpbmcgcmVnaXN0ZXJzLgoJCSAg
ICBtb2R1bGUtPmNsb2NrX2xvKGRhdF90PDE+KDApKTsKCQkgICAgcmV0dXJuICJvayI7CgkJfSBl
bHNlIGlmICh0b2tlbnNbMF0gPT0gInN0ZXAiKSB7CgkJCS8vIElOOiAgc3RlcCA8bnVtX2N5Y2xl
cz4KCQkJLy8gT1VUOiBhY3R1YWwgbnVtYmVyIG9mIGN5Y2xlcyBzdGVwcGVkCgkJCWlmICghY2hl
Y2tfY29tbWFuZF9sZW5ndGgodG9rZW5zLCAxLCAxKSkgeyByZXR1cm4gImVycm9yIjsgfQoJCQlp
bnQgbiA9IGF0b2kodG9rZW5zWzFdLmNfc3RyKCkpOwoJCSAgICBpbnQgcmV0ID0gbW9kdWxlLT5z
dGVwKGZhbHNlLCBuKTsKCQkgICAgcmV0dXJuIGl0b3MocmV0KTsKCQl9IGVsc2UgaWYgKHRva2Vu
c1swXSA9PSAic2V0X2Nsb2NrcyIpIHsKCQkJLy8gQkVUQSBGVU5DVElPTjogc2VtYW50aWNzIHN1
YmplY3QgdG8gY2hhbmdlLCB1c2Ugd2l0aCBjYXV0aW9uCgkJCS8vIElOOiAgc2V0X2Nsb2NrcwoJ
CQkvLyBPVVQ6ID8/PwoJCQkvLyBJJ20gbm90IHJlYWxseSBzdXJlIHdoYXQgdGhpcyBpcyBzdXBw
b3NlZCB0byBkbywgYnV0IGl0IHdhcwoJCQkvLyBpbiB0aGUgb2xkIGNvbW1hbmQgQVBJLCBzbyBp
dCdzIGhlcmUgbm93CgkgICAgICAgIHN0ZDo6dmVjdG9yPCBpbnQgPiBwZXJpb2RzOwoJICAgICAg
ICBmb3IgKGludCBpID0gMTsgaSA8IHRva2Vucy5zaXplKCk7IGkrKykgewoJICAgICAgICAgIGlu
dCBwZXJpb2QgPSBhdG9pKHRva2Vuc1tpXS5jX3N0cigpKTsKCSAgICAgICAgICBwZXJpb2RzLnB1
c2hfYmFjayhwZXJpb2QpOwoJICAgICAgICB9CgkgICAgICAgIG1vZHVsZS0+c2V0Q2xvY2tzKHBl
cmlvZHMpOwoJICAgICAgICByZXR1cm4gIm9rIjsKCgkJfSBlbHNlIGlmICh0b2tlbnNbMF0gPT0g
InJlc2V0IikgewoJCQkvLyBJTjogIHJlc2V0IDxudW1fY3ljbGVzPgoJCQkvLyBPVVQ6IGFjdHVh
bCBudW1iZXIgb2YgY3ljbGVzIGluIHJlc2V0CgkJCWlmICghY2hlY2tfY29tbWFuZF9sZW5ndGgo
dG9rZW5zLCAwLCAxKSkgeyByZXR1cm4gImVycm9yIjsgfQoJCQlpbnQgY3ljbGVzID0gMTsKCQkJ
aWYgKHRva2Vucy5zaXplKCkgPj0gMikgewoJCQkJY3ljbGVzID0gYXRvaSh0b2tlbnNbMV0uY19z
dHIoKSk7CgkJCX0KCQkJZm9yIChpbnQgaT0wOyBpPGN5Y2xlczsgaSsrKSB7CgkJCSAgIAltb2R1
bGUtPmNsb2NrX2xvKGRhdF90PDE+KDEpKTsKCQkJICAgCW1vZHVsZS0+Y2xvY2tfaGkoZGF0X3Q8
MT4oMSkpOwoJCSAgICB9CgkJICAgIG1vZHVsZS0+Y2xvY2tfbG8oZGF0X3Q8MT4oMCkpOwoJCSAg
ICByZXR1cm4gaXRvcyhjeWNsZXMpOwoKCQl9IGVsc2UgaWYgKHRva2Vuc1swXSA9PSAicGVlayIp
IHsKCQkJLy8gTEVHQUNZIEZVTkNUSU9OOiBkbyBub3QgdXNlIGluIG5ldyBjb2RlCgkJCS8vIElO
OiAgcGVlayA8bm9kZV9uYW1lPiB8IHBlZWsgPG1lbV9uYW1lPiA8bWVtX2luZGV4PgoJCQkvLyBP
VVQ6IHZhbHVlCgkJCWlmICghY2hlY2tfY29tbWFuZF9sZW5ndGgodG9rZW5zLCAxLCAyKSkgeyBy
ZXR1cm4gImVycm9yIjsgfQoJCQljZXJyIDw8ICJwZWVrIGlzIGRlcHJlY2F0ZWQsIHVzZSB3aXJl
X3BlZWsgb3IgbWVtX3BlZWsiIDw8IHN0ZDo6ZW5kbDsKCQkJaWYgKHRva2Vucy5zaXplKCkgPT0g
MikgewoJCQkJcmV0dXJuIGdldF9kYXRfYnlfbmFtZSh0b2tlbnNbMV0pLT5nZXRfdmFsdWUoKTsK
CQkJfSBlbHNlIGlmICh0b2tlbnMuc2l6ZSgpID09IDMpIHsKCQkJCXJldHVybiBnZXRfbWVtX2J5
X25hbWUodG9rZW5zWzFdKS0+Z2V0X2VsZW1lbnQodG9rZW5zWzJdKTsKCQkJfQoJCX0gZWxzZSBp
ZiAodG9rZW5zWzBdID09ICJwb2tlIikgewoJCQkvLyBMRUdBQ1kgRlVOQ1RJT046IGRvIG5vdCB1
c2UgaW4gbmV3IGNvZGUKCQkJLy8gSU46ICBwb2tlIDxub2RlX25hbWU+IDx2YWx1ZT4gfCBwb2tl
IDxtZW1fbmFtZT4gPG1lbV9pbmRleD4gPHZhbHVlPgoJCQkvLyBPVVQ6IHRydWUgKG9uIHN1Y2Nl
c3MpLCBmYWxzZSAob24gZmFpbHVyZSkKCQkJaWYgKCFjaGVja19jb21tYW5kX2xlbmd0aCh0b2tl
bnMsIDIsIDMpKSB7IHJldHVybiAiIjsgfQoJCQljZXJyIDw8ICJwb2tlIGlzIGRlcHJlY2F0ZWQs
IHVzZSB3aXJlX3Bva2Ugb3IgbWVtX3Bva2UiIDw8IHN0ZDo6ZW5kbDsKCQkJYm9vbCBzdWNjZXNz
OwoJCQlpZiAodG9rZW5zLnNpemUoKSA9PSAzKSB7CgkJCQlzdWNjZXNzID0gZ2V0X2RhdF9ieV9u
YW1lKHRva2Vuc1sxXSktPnNldF92YWx1ZSh0b2tlbnNbMl0pOwoJCQl9IGVsc2UgaWYgKHRva2Vu
cy5zaXplKCkgPT0gNCkgewoJCQkJc3VjY2VzcyA9IGdldF9tZW1fYnlfbmFtZSh0b2tlbnNbMV0p
LT5zZXRfZWxlbWVudCh0b2tlbnNbMl0sIHRva2Vuc1szXSk7CgkJCX0KCQkJcmV0dXJuIHN1Y2Nl
c3MgPyAidHJ1ZSIgOiAiZmFsc2UiOwoKCQl9IGVsc2UgaWYgKHRva2Vuc1swXSA9PSAid2lyZV9w
ZWVrIikgewoJCQkvLyBJTjogIHdpcmVfcGVlayA8bm9kZV9uYW1lPgoJCQkvLyBPVVQ6IHZhbHVl
CgkJCWlmICghY2hlY2tfY29tbWFuZF9sZW5ndGgodG9rZW5zLCAxLCAxKSkgeyByZXR1cm4gImVy
cm9yIjsgfQoJCQlyZXR1cm4gZ2V0X2RhdF9ieV9uYW1lKHRva2Vuc1sxXSktPmdldF92YWx1ZSgp
OwoJCX0gZWxzZSBpZiAodG9rZW5zWzBdID09ICJ3aXJlX3Bva2UiKSB7CgkJCS8vIElOOiAgd2ly
ZV9wb2tlIDxub2RlX25hbWU+IDx2YWx1ZT4KCQkJLy8gT1VUOiBvayAob24gc3VjY2VzcykKCQkJ
aWYgKCFjaGVja19jb21tYW5kX2xlbmd0aCh0b2tlbnMsIDIsIDIpKSB7IHJldHVybiAiZXJyb3Ii
OyB9CgkJCWJvb2wgc3VjY2VzcyA9IGdldF9kYXRfYnlfbmFtZSh0b2tlbnNbMV0pLT5zZXRfdmFs
dWUodG9rZW5zWzJdKTsKCQkJcmV0dXJuIHN1Y2Nlc3MgPyAib2siIDogImVycm9yIjsKCQl9IGVs
c2UgaWYgKHRva2Vuc1swXSA9PSAibWVtX3BlZWsiKSB7CgkJCS8vIElOOiAgbWVtX3BlZWsgPG1l
bV9uYW1lPiA8bWVtX2luZGV4PgoJCQkvLyBPVVQ6IHZhbHVlCgkJCWlmICghY2hlY2tfY29tbWFu
ZF9sZW5ndGgodG9rZW5zLCAyLCAyKSkgeyByZXR1cm4gImVycm9yIjsgfQoJCQlyZXR1cm4gZ2V0
X21lbV9ieV9uYW1lKHRva2Vuc1sxXSktPmdldF9lbGVtZW50KHRva2Vuc1syXSk7CgkJfSBlbHNl
IGlmICh0b2tlbnNbMF0gPT0gIm1lbV9wb2tlIikgewoJCQkvLyBJTjogIG1lbV9wb2tlIDxtZW1f
bmFtZT4gPG1lbV9pbmRleD4gPHZhbHVlPgoJCQkvLyBPVVQ6IG9rIChvbiBzdWNjZXNzKQoJCQlp
ZiAoIWNoZWNrX2NvbW1hbmRfbGVuZ3RoKHRva2VucywgMywgMykpIHsgcmV0dXJuICJlcnJvciI7
IH0KCQkJYm9vbCBzdWNjZXNzID0gZ2V0X21lbV9ieV9uYW1lKHRva2Vuc1sxXSktPnNldF9lbGVt
ZW50KHRva2Vuc1syXSwgdG9rZW5zWzNdKTsKCQkJcmV0dXJuIHN1Y2Nlc3MgPyAib2siIDogImVy
cm9yIjsKCgkJfSBlbHNlIGlmICh0b2tlbnNbMF0gPT0gImxpc3Rfd2lyZXMiKSB7CgkJCS8vIElO
OiAgbGlzdF93aXJlcwoJCQkvLyBPVVQ6IGxpc3Qgb2Ygd2lyZXMKCQkJaWYgKCFjaGVja19jb21t
YW5kX2xlbmd0aCh0b2tlbnMsIDAsIDApKSB7IHJldHVybiAiZXJyb3IiOyB9CgkJCXN0ZDo6c3Ry
aW5nIG91dCA9ICIiOwoJCQlmb3IgKHN0ZDo6bWFwPGNvbnN0IGNoYXIqLCBkYXRfYXBpX2Jhc2Uq
Pjo6aXRlcmF0b3IgaXQgPSBkYXRfdGFibGUuYmVnaW4oKTsgaXQgIT0gZGF0X3RhYmxlLmVuZCgp
OyBpdCsrKSB7CgkJCQlvdXQgPSBvdXQgKyBpdC0+c2Vjb25kLT5nZXRfcGF0aG5hbWUoKSArICIg
IjsKCQkJfQoJCQlpZiAob3V0LnNpemUoKSA+PSAxKSB7CgkJCQlyZXR1cm4gb3V0LnN1YnN0cigw
LCBvdXQuc2l6ZSgpIC0gMSk7CgkJCX0gZWxzZSB7CgkJCQlyZXR1cm4gIiI7CgkJCX0KCgkJfSBl
bHNlIGlmICh0b2tlbnNbMF0gPT0gImxpc3RfbWVtcyIpIHsKCQkJLy8gSU46ICBsaXN0X21lbXMK
CQkJLy8gT1VUOiBsaXN0IG9mIG1lbW9yaWVzCgkJCWlmICghY2hlY2tfY29tbWFuZF9sZW5ndGgo
dG9rZW5zLCAwLCAwKSkgeyByZXR1cm4gImVycm9yIjsgfQoJCQlzdGQ6OnN0cmluZyBvdXQgPSAi
IjsKCQkJZm9yIChzdGQ6Om1hcDxjb25zdCBjaGFyKiwgbWVtX2FwaV9iYXNlKj46Oml0ZXJhdG9y
IGl0ID0gbWVtX3RhYmxlLmJlZ2luKCk7IGl0ICE9IG1lbV90YWJsZS5lbmQoKTsgaXQrKykgewoJ
CQkJb3V0ID0gb3V0ICsgaXQtPnNlY29uZC0+Z2V0X3BhdGhuYW1lKCkgKyAiICI7CgkJCX0KCQkJ
aWYgKG91dC5zaXplKCkgPj0gMSkgewoJCQkJcmV0dXJuIG91dC5zdWJzdHIoMCwgb3V0LnNpemUo
KSAtIDEpOwoJCQl9IGVsc2UgewoJCQkJcmV0dXJuICIiOwoJCQl9CgoJCX0gZWxzZSBpZiAodG9r
ZW5zWzBdID09ICJ3aXJlX3dpZHRoIikgewoJCQkvLyBJTjogIHdpcmVfd2lkdGggPG5vZGU+CgkJ
CS8vIE9VVDogYml0d2lkdGggb2Ygd2lyZQoJCQlpZiAoIWNoZWNrX2NvbW1hbmRfbGVuZ3RoKHRv
a2VucywgMSwgMSkpIHsgcmV0dXJuICJlcnJvciI7IH0KCQkJcmV0dXJuIGdldF9kYXRfYnlfbmFt
ZSh0b2tlbnNbMV0pLT5nZXRfd2lkdGgoKTsKCQl9IGVsc2UgaWYgKHRva2Vuc1swXSA9PSAibWVt
X3dpZHRoIikgewoJCQkvLyBJTjogIG1lbV93aWR0aCA8bm9kZT4KCQkJLy8gT1VUOiBiaXR3aWR0
aCBvZiBtZW1vcnkgZWxlbWVudAoJCQlpZiAoIWNoZWNrX2NvbW1hbmRfbGVuZ3RoKHRva2Vucywg
MSwgMSkpIHsgcmV0dXJuICJlcnJvciI7IH0KCQkJcmV0dXJuIGdldF9tZW1fYnlfbmFtZSh0b2tl
bnNbMV0pLT5nZXRfd2lkdGgoKTsKCQl9IGVsc2UgaWYgKHRva2Vuc1swXSA9PSAibWVtX2RlcHRo
IikgewoJCQkvLyBJTjogIG1lbV9kZXB0aCA8bm9kZT4KCQkJLy8gT1VUOiBlbGVtZW50cyBpbiBt
ZW1vcnkKCQkJaWYgKCFjaGVja19jb21tYW5kX2xlbmd0aCh0b2tlbnMsIDEsIDEpKSB7IHJldHVy
biAiZXJyb3IiOyB9CgkJCXJldHVybiBnZXRfbWVtX2J5X25hbWUodG9rZW5zWzFdKS0+Z2V0X2Rl
cHRoKCk7CgoJCX0gZWxzZSBpZiAodG9rZW5zWzBdID09ICJyZWZlcmVuY2VkX3NuYXBzaG90X3Nh
dmUiKSB7CgkJCS8vIEJFVEEgRlVOQ1RJT046IHNlbWFudGljcyBzdWJqZWN0IHRvIGNoYW5nZSwg
dXNlIHdpdGggY2F1dGlvbgoJCQkvLyBJTjogIHJlZmVyZW5jZWRfc25hcHNob3Rfc2F2ZSA8bmFt
ZT4KCQkJLy8gT1VUOiBSZWZlcmVuY2UgbmFtZSAoYW4gYXJiaXRyYXJ5IHN0cmluZykgZm9yIHNh
dmVkIHNuYXBzaG90CgkJCS8vICAgICAgb2YgY3VycmVudCBzdGF0ZSwgc2hvdWxkIGJlIGVxdWl2
YWxlbnQgdG8gdGhlIGlucHV0LgoJCQkvLyBDYXV0aW9uOiB0aGUgc3RhdGUgbWF5IG5vdCBiZSBz
ZWxmLWNvbnNpc3RlbnQgKGkuZS4gY2xrX2xvCgkJCS8vIGRvZXMgbm90IG5lZWQgdG8gaGF2ZSBi
ZWVuIGFwcGxpZWQgYmVmb3JlIHRoaXMsIGFuZCBjYWxscyB0bwoJCQkvLyBjbGtfbG8gaW1tZWRp
YXRlbHkgYWZ0ZXIgcmVzdG9yaW5nIG1heSBjaGFuZ2UgdGhlIHN0YXRlKS4KCQkJaWYgKCFjaGVj
a19jb21tYW5kX2xlbmd0aCh0b2tlbnMsIDEsIDEpKSB7IHJldHVybiAiZXJyb3IiOyB9CgkJCW1v
ZF90ICpzbmFwc2hvdCA9IG1vZHVsZS0+Y2xvbmUoKTsKCQkJc25hcHNob3RfdGFibGVbdG9rZW5z
WzFdXSA9IHNuYXBzaG90OwoJCQlyZXR1cm4gdG9rZW5zWzFdOwoJCX0gZWxzZSBpZiAodG9rZW5z
WzBdID09ICJyZWZlcmVuY2VkX3NuYXBzaG90X3Jlc3RvcmUiKSB7CgkJCS8vIEJFVEEgRlVOQ1RJ
T046IHNlbWFudGljcyBzdWJqZWN0IHRvIGNoYW5nZSwgdXNlIHdpdGggY2F1dGlvbgoJCQkvLyBJ
TjogIHJlZmVyZW5jZWRfc25hcHNob3RfcmVzdG9yZSA8bmFtZT4KCQkJLy8gT1VUOiBvayAob24g
c3VjY2VzcykKCQkJaWYgKCFjaGVja19jb21tYW5kX2xlbmd0aCh0b2tlbnMsIDEsIDEpKSB7IHJl
dHVybiAiZXJyb3IiOyB9CgkJCW1vZF90ICpzbmFwc2hvdCA9IGdldF9zbmFwc2hvdF9ieV9yZWZl
cmVuY2UodG9rZW5zWzFdKTsKCQkJaWYgKHNuYXBzaG90ID09IE5VTEwpIHsJcmV0dXJuICJlcnJv
ciI7CX0KCQkJYm9vbCBzdWNjZXNzID0gbW9kdWxlLT5zZXRfY2lyY3VpdF9mcm9tKHNuYXBzaG90
KTsKCQkJcmV0dXJuIHN1Y2Nlc3MgPyAib2siIDogImVycm9yIjsKCgkJfSBlbHNlIHsKCQkJc3Rk
OjpjZXJyIDw8ICJVbmtub3duIGNvbW1hbmQ6ICciIDw8IHRva2Vuc1swXSA8PCAiJyIgPDwgc3Rk
OjplbmRsOwoJCX0KCQlyZXR1cm4gImVycm9yIjsKCX0KCgl2b2lkIHJlYWRfZXZhbF9wcmludF9s
b29wKCkgewoJCXdoaWxlICh0cnVlKSB7CgkJICAgIHN0ZDo6c3RyaW5nIHN0cl9pbjsKCQkgICAg
Z2V0bGluZShjaW4sIHN0cl9pbik7CgkJICAgIGlmICh0ZWVmaWxlICE9IE5VTEwpIHsKCQkgICAg
ICAgIGZwcmludGYodGVlZmlsZSwgIiVzXG4iLCBzdHJfaW4uY19zdHIoKSk7CgkJICAgICAgICBm
Zmx1c2godGVlZmlsZSk7CgkJICAgIH0KCQkgICAgaWYgKHN0cl9pbiA9PSAicXVpdCIpIHsKCQkg
ICAgCWJyZWFrOwoJCSAgICB9IGVsc2UgewoJCSAgICAJY291dCA8PCBldmFsX2NvbW1hbmQoc3Ry
X2luKSA8PCBzdGQ6OmVuZGw7CgkJICAgIH0KCQl9Cgl9Cgpwcm90ZWN0ZWQ6CglGSUxFKiB0ZWVm
aWxlOwoJbW9kX3QqIG1vZHVsZTsKCgkvLyBNYXBwaW5nIHRhYmxlIGZ1bmN0aW9ucwoJdmlydHVh
bCB2b2lkIGluaXRfbWFwcGluZ190YWJsZSgpID0gMDsKCglkYXRfYXBpX2Jhc2UqIGdldF9kYXRf
YnlfbmFtZShzdGQ6OnN0cmluZyBuYW1lKSB7CgkJaWYgKGRhdF90YWJsZS5maW5kKG5hbWUuY19z
dHIoKSkgIT0gZGF0X3RhYmxlLmVuZCgpKSB7CgkJCXJldHVybiBkYXRfdGFibGVbbmFtZS5jX3N0
cigpXTsKCQl9IGVsc2UgewoJCQlzdGQ6OmNlcnIgPDwgIlVuYWJsZSB0byBmaW5kIGRhdCAnIiA8
PCBuYW1lIDw8ICInIiA8PCBzdGQ6OmVuZGw7CgkJCXJldHVybiAmdGhpc19kYXRfZHVtbXk7CgkJ
fQoJfQoJbWVtX2FwaV9iYXNlKiBnZXRfbWVtX2J5X25hbWUoc3RkOjpzdHJpbmcgbmFtZSkgewoJ
CWlmIChtZW1fdGFibGUuZmluZChuYW1lLmNfc3RyKCkpICE9IG1lbV90YWJsZS5lbmQoKSkgewoJ
CQlyZXR1cm4gbWVtX3RhYmxlW25hbWUuY19zdHIoKV07CgkJfSBlbHNlIHsKCQkJc3RkOjpjZXJy
IDw8ICJVbmFibGUgdG8gZmluZCBtZW0gJyIgPDwgbmFtZSA8PCAiJyIgPDwgc3RkOjplbmRsOwoJ
CQlyZXR1cm4gJnRoaXNfbWVtX2R1bW15OwoJCX0KCX0KCgltb2RfdCogZ2V0X3NuYXBzaG90X2J5
X3JlZmVyZW5jZShzdGQ6OnN0cmluZyBuYW1lKSB7CgkJaWYgKHNuYXBzaG90X3RhYmxlLmZpbmQo
bmFtZSkgIT0gc25hcHNob3RfdGFibGUuZW5kKCkpIHsKCQkJcmV0dXJuIHNuYXBzaG90X3RhYmxl
W25hbWVdOwoJCX0gZWxzZSB7CgkJCXN0ZDo6Y2VyciA8PCAiVW5hYmxlIHRvIGZpbmQgc25hcHNo
b3QgcmVmZXJlbmNlICciIDw8IG5hbWUgPDwgIiciIDw8IHN0ZDo6ZW5kbDsKCQkJcmV0dXJuIE5V
TEw7CgkJfQoJfQoKCWNsYXNzIHN0cmluZ19jb21wYXJhdG9yIHsKCXB1YmxpYzoKCQlib29sIG9w
ZXJhdG9yKCkoY29uc3QgY2hhciogeCwgY29uc3QgY2hhciogeSkgewoJCQlyZXR1cm4gc3RyY21w
KHgsIHkpIDwgMDsKCQl9Cgl9OwoKCXN0ZDo6bWFwPGNvbnN0IGNoYXIqLCBkYXRfYXBpX2Jhc2Uq
LCBzdHJpbmdfY29tcGFyYXRvcj4gZGF0X3RhYmxlOwoJc3RkOjptYXA8Y29uc3QgY2hhciosIG1l
bV9hcGlfYmFzZSosIHN0cmluZ19jb21wYXJhdG9yPiBtZW1fdGFibGU7CgkvLyBUT0RPOiByZXBs
YWNlIHRoZSBkdW1teSB3aXRoIGV4cGxpY2l0IE5VTEwgY2hlY2tzIC0gdGhpcyBpcyBzaW1wbGUK
CS8vIGJ1dCBhIGJpdCBpbmVsZWdhbnQKCWRhdF9kdW1teSB0aGlzX2RhdF9kdW1teTsKCW1lbV9k
dW1teSB0aGlzX21lbV9kdW1teTsKCgkvLyBTbmFwc2hvdCBmdW5jdGlvbnMKCXN0ZDo6bWFwPHN0
ZDo6c3RyaW5nLCBtb2RfdCo+IHNuYXBzaG90X3RhYmxlOwp9OwoKI2VuZGlmCgAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAuL2VtdWxhdG9yX21vZC5oAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAMDAwMDY0NAAwMDAxNzUwADAwMDE3NTAAMDAwMDAxNDAwMzMAMTIzNTcyNzU0MTEAMDEz
NDA1ACAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHVzdGFyICAA
cGFsbWVyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwYWxtZXIAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAC8vIEhlYWRlciBmb3IgQ2hpc2VsIGVtdWxhdG9yIG1vZHVsZQov
LyBkZWZpbmVzIHRoZSBtb2RfdCBjbGFzcyBhcyB3ZWxsIGFzIGJpdCBvcGVyYXRpb24gZnVuY3Rp
b25zCgojaWZuZGVmIF9fSVNfRU1VTEFUT1JfTU9EX18KI2RlZmluZSBfX0lTX0VNVUxBVE9SX01P
RF9fCgojcHJhZ21hIEdDQyBkaWFnbm9zdGljIHB1c2gKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBp
Z25vcmVkICItV3VudXNlZC1wYXJhbWV0ZXIiCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3Jl
ZCAiLVdzaWduLWNvbXBhcmUiCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMgaWdub3JlZCAiLVdwYXJl
bnRoZXNlcyIKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBpZ25vcmVkICItV3JldHVybi10eXBlIgoj
cHJhZ21hIEdDQyBkaWFnbm9zdGljIGlnbm9yZWQgIi1XY2hhci1zdWJzY3JpcHRzIgojcHJhZ21h
IEdDQyBkaWFnbm9zdGljIGlnbm9yZWQgIi1XdHlwZS1saW1pdHMiCiNwcmFnbWEgR0NDIGRpYWdu
b3N0aWMgaWdub3JlZCAiLVd1bnVzZWQtZnVuY3Rpb24iCiNwcmFnbWEgR0NDIGRpYWdub3N0aWMg
aWdub3JlZCAiLVd1bnVzZWQtdmFyaWFibGUiCgojaW5jbHVkZSA8YXNzZXJ0Lmg+CiNpbmNsdWRl
IDxpbnR0eXBlcy5oPgojaW5jbHVkZSA8c3RkaW8uaD4KI2luY2x1ZGUgPGxpbWl0cy5oPgojaW5j
bHVkZSA8bWF0aC5oPgojaW5jbHVkZSA8dmVjdG9yPgojaW5jbHVkZSA8c3RkYXJnLmg+CiNpbmNs
dWRlIDxzdHJpbmcuaD4KI2luY2x1ZGUgPHRpbWUuaD4KI2luY2x1ZGUgPHN0cmluZz4KI2luY2x1
ZGUgPG1hcD4KI2luY2x1ZGUgPHN0ZGxpYi5oPgojaW5jbHVkZSA8aW9zdHJlYW0+CiNpbmNsdWRl
IDxmc3RyZWFtPgojaW5jbHVkZSA8c3RkZXhjZXB0PgoKdXNpbmcgbmFtZXNwYWNlIHN0ZDsKCnR5
cGVkZWYgdWludDY0X3QgdmFsX3Q7CnR5cGVkZWYgaW50NjRfdCBzdmFsX3Q7CnR5cGVkZWYgdWlu
dDMyX3QgaGFsZl92YWxfdDsKI2lmIGRlZmluZWQoX19HTlVDX18pICYmIGRlZmluZWQoX19TSVpF
T0ZfSU5UMTI4X18pCiNkZWZpbmUgX19IQVZFX0RVQl9WQUxfVF9fCnR5cGVkZWYgdW5zaWduZWQg
X19pbnQxMjggZHViX3ZhbF90OwojZW5kaWYKCnVuaW9uIGZsbzJpbnRfdCB7CiAgZmxvYXQgIGY7
CiAgdmFsX3QgIGk7Cn07CgppbmxpbmUgZmxvYXQgdG9GbG9hdCAodmFsX3QgeCkgewogIGZsbzJp
bnRfdCBmMmk7CiAgZjJpLmkgPSB4OwogIHJldHVybiBmMmkuZjsKfQoKaW5saW5lIHZhbF90IGZy
b21GbG9hdCAoZmxvYXQgeCkgewogIGZsbzJpbnRfdCBmMmk7CiAgZjJpLmYgPSB4OwogIHJldHVy
biBmMmkuaTsKfQoKdW5pb24gZGJsMmludF90IHsKICBkb3VibGUgZjsKICB2YWxfdCAgaTsKfTsK
CmlubGluZSBkb3VibGUgdG9Eb3VibGUgKHZhbF90IHgpIHsKICBkYmwyaW50X3QgZjJpOwogIGYy
aS5pID0geDsKICByZXR1cm4gZjJpLmY7Cn0KCmlubGluZSB2YWxfdCBmcm9tRG91YmxlIChkb3Vi
bGUgeCkgewogIGRibDJpbnRfdCBmMmk7CiAgZjJpLmYgPSB4OwogIHJldHVybiBmMmkuaTsKfQoK
I2RlZmluZSBURVJOQVJZKGMsIHQsIGYpICgoZikgXiAoKChmKSBeICh0KSkgJiAtKGMpKSkKCiNp
ZiBkZWZpbmVkKF9fR05VQ19fKSAmJiBkZWZpbmVkKF9feDg2XzY0X18pCiNkZWZpbmUgVEVSTkFS
WV8xKGMsIHQsIGYpICh7IFwKICB2YWxfdCBfX3JlczsgXAogIGlmICghX19idWlsdGluX2NvbnN0
YW50X3AoYykpIHsgXAogICAgX19yZXMgPSAoZik7IFwKICAgIHZhbF90IF9fdCA9ICh0KTsgXAog
ICAgdWludDhfdCBfX2MgPSAoYyk7IFwKICAgIGFzbSAoInRlc3RiICQxLCAlMTsgY21vdm5lICUy
LCAlMCIgOiAiK3IiKF9fcmVzKSA6ICJybSIoX19jKSwgInJtIihfX3QpIDogImNjIik7IFwKICB9
IGVsc2UgX19yZXMgPSBURVJOQVJZKGMsIHQsIGYpOyBcCiAgX19yZXM7IH0pCiNlbHNlCiNkZWZp
bmUgVEVSTkFSWV8xKGMsIHQsIGYpIFRFUk5BUlkoYywgdCwgZikKI2VuZGlmCgojZGVmaW5lIE1B
U0sodiwgYykgKCh2KSAmIC0odmFsX3QpKGMpKQojaWZuZGVmIE1JTgojZGVmaW5lIE1JTihhLCBi
KSBURVJOQVJZKChhKSA8IChiKSwgKGEpLCAoYikpCiNlbmRpZgojaWZuZGVmIE1BWAojZGVmaW5l
IE1BWChhLCBiKSBURVJOQVJZKChhKSA+IChiKSwgKGEpLCAoYikpCiNlbmRpZgojZGVmaW5lIENM
QU1QKGEsIG1pbiwgbWF4KSBNQVgoTUlOKGEsIG1heCksIG1pbikKCnRlbXBsYXRlPHVpbnQzMl90
IHgsIHVpbnQzMl90IHNoaWZ0ZWQ9MCwgYm9vbCBzdGlja3k9ZmFsc2U+IHN0cnVjdCBDZWlsTG9n
IHsKICAgIHN0YXRpYyB1aW50MzJfdCBjb25zdCB2ID0gQ2VpbExvZzwoeCA+PiAxKSwgc2hpZnRl
ZCArIDEsIHN0aWNreSB8ICh4ICYgMSk+Ojp2Owp9OwoKdGVtcGxhdGU8dWludDMyX3Qgc2hpZnRl
ZCwgYm9vbCBzdGlja3k+IHN0cnVjdCBDZWlsTG9nPDAsIHNoaWZ0ZWQsIHN0aWNreT4gewogICAg
c3RhdGljIHVpbnQzMl90IGNvbnN0IHYgPSAtMTsKfTsKCnRlbXBsYXRlPHVpbnQzMl90IHNoaWZ0
ZWQsIGJvb2wgc3RpY2t5PiBzdHJ1Y3QgQ2VpbExvZzwxLCBzaGlmdGVkLCBzdGlja3k+IHsKICAg
IHN0YXRpYyB1aW50MzJfdCBjb25zdCB2ID0gc3RpY2t5ID8gc2hpZnRlZCArIDEgOiBzaGlmdGVk
Owp9OwoKI2RlZmluZSB2YWxfbl9iaXRzKCkgKHNpemVvZih2YWxfdCkqOCkKI2RlZmluZSB2YWxf
bl9oYWxmX2JpdHMoKSAodmFsX25fYml0cygpLzIpCiNkZWZpbmUgdmFsX2FsbF9vbmVzKCkgdmFs
X2FsbF9vbmVzX29yX3plcm9lcygxKQojZGVmaW5lIHZhbF9hbGxfb25lc19vcl96ZXJvZXMoYml0
KSAodmFsX3QoMCkgLSB2YWxfdChiaXQpKQojZGVmaW5lIHZhbF9uX3dvcmRzKG5fYml0cykgKDEr
KChuX2JpdHMpLTEpL3ZhbF9uX2JpdHMoKSkKI2RlZmluZSB2YWxfbl9oYWxmX3dvcmRzKG5fYml0
cykgKDErKChuX2JpdHMpLTEpL3ZhbF9uX2hhbGZfYml0cygpKQojZGVmaW5lIHZhbF90b3BfYml0
KHYpICh2YWxfdCh2KSA+PiAodmFsX25fYml0cygpLTEpKQojZGVmaW5lIHZhbF9uX2Z1bGxfd29y
ZHMobl9iaXRzKSAoKG5fYml0cykvdmFsX25fYml0cygpKQojZGVmaW5lIHZhbF9uX3dvcmRfYml0
cyhuX2JpdHMpICgobl9iaXRzKSAlIHZhbF9uX2JpdHMoKSkKaW5saW5lIHZhbF90IHZhbF9uX25p
YnMoIHZvaWQgKSB7IHJldHVybiB2YWxfbl9iaXRzKCk+PjI7IH0KaW5saW5lIHZhbF90IHZhbF9o
YWxmX21hc2soIHZvaWQgKSB7IHJldHVybiAoKCh2YWxfdCkxKTw8KHZhbF9uX2hhbGZfYml0cygp
KSktMTsgfQppbmxpbmUgdmFsX3QgdmFsX2xvX2hhbGYoIHZhbF90IG5fYml0cyApIHsgcmV0dXJu
IG5fYml0cyAmIHZhbF9oYWxmX21hc2soKTsgfQppbmxpbmUgdmFsX3QgdmFsX2hpX2hhbGYoIHZh
bF90IG5fYml0cyApIHsgcmV0dXJuIG5fYml0cyA+PiB2YWxfbl9oYWxmX2JpdHMoKTsgfQppbmxp
bmUgdmFsX3QgdmFsX25fcmVtX3dvcmRfYml0cyggdmFsX3Qgbl9iaXRzICkgeyByZXR1cm4gdmFs
X25fYml0cygpIC0gdmFsX25fd29yZF9iaXRzKG5fYml0cyk7IH0KLy9pbmxpbmUgdmFsX3QgZHVi
X3ZhbF9sb19oYWxmKCBkdWJfdmFsX3QgYml0cyApIHsgcmV0dXJuICh2YWxfdCliaXRzOyB9Ci8v
aW5saW5lIHZhbF90IGR1Yl92YWxfaGlfaGFsZiggZHViX3ZhbF90IGJpdHMgKSB7IHJldHVybiAo
dmFsX3QpKGJpdHMgPj4gdmFsX25fYml0cygpKTsgfQoKCmlubGluZSB2b2lkICB2YWxfdG9faGFs
Zl92YWxzICggdmFsX3QgKmZ2YWxzLCBoYWxmX3ZhbF90ICpodmFscywgaW50IG5mICkgewogIGZv
ciAoaW50IGkgPSAwOyBpIDwgbmY7IGkrKykgewogICAgaHZhbHNbaSoyXSAgID0gdmFsX2xvX2hh
bGYoZnZhbHNbaV0pOwogICAgaHZhbHNbaSoyKzFdID0gdmFsX2hpX2hhbGYoZnZhbHNbaV0pOwog
IH0KfQppbmxpbmUgdm9pZCAgaGFsZl92YWxfdG9fdmFscyAoIGhhbGZfdmFsX3QgKmh2YWxzLCB2
YWxfdCAqdmFscywgaW50IG5mICkgewogIGZvciAoaW50IGkgPSAwOyBpIDwgbmY7IGkrKykKICAg
IHZhbHNbaV0gPSAoKHZhbF90KWh2YWxzW2kqMisxXSA8PCB2YWxfbl9oYWxmX2JpdHMoKSkgfCBo
dmFsc1tpKjJdOwp9Cgp0ZW1wbGF0ZSA8aW50IHc+IGNsYXNzIGRhdF90Owp0ZW1wbGF0ZSA8aW50
IHc+IGNsYXNzIGRhdHpfdDsKCnRlbXBsYXRlIDxpbnQgdz4gaW50IGRhdHpfZXEoZGF0X3Q8dz4g
ZDEsIGRhdHpfdDx3PiBkMik7Cgp0ZW1wbGF0ZSA8aW50IHc+IGlubGluZSBkYXRfdDx3PiBEQVQo
dmFsX3QgdmFsdWUpIHsKICBkYXRfdDx3PiByZXModmFsdWUpOwogIHJldHVybiByZXM7IH0KCnRl
bXBsYXRlIDxpbnQgdz4gaW5saW5lIGRhdF90PHc+IERBVCh2YWxfdCB2YWwxLCB2YWxfdCB2YWww
KSB7CiAgZGF0X3Q8dz4gcmVzOyByZXMudmFsdWVzWzBdID0gdmFsMDsgcmVzLnZhbHVlc1sxXSA9
IHZhbDE7IHJldHVybiByZXM7Cn0KCmNvbnN0IHN0YXRpYyBjaGFyIGhleF9kaWdzW10gPQogIHsn
MCcsICcxJywgJzInLCAnMycsICc0JywgJzUnLCAnNicsICc3JywgJzgnLCAnOScsICdhJywgJ2In
LCAnYycsICdkJywgJ2UnLCAnZicgfTsKCnN0YXRpYyB2b2lkIGFkZF9uICh2YWxfdCBkW10sIHZh
bF90IHMwW10sIHZhbF90IHMxW10sIGludCBudywgaW50IG5iKSB7CiAgdmFsX3QgY2FycnkgPSAw
OwogIGZvciAoaW50IGkgPSAwOyBpIDwgbnc7IGkrKykgewogICAgZFtpXSA9IHMwW2ldICsgczFb
aV0gKyBjYXJyeTsKICAgIGNhcnJ5ID0gKChzMFtpXSArIHMxW2ldKSA8IHMwW2ldKSB8fCAoZFtp
XSA8IGNhcnJ5KTsKICB9Cn0KCnN0YXRpYyB2b2lkIG5lZ19uICh2YWxfdCBkW10sIHZhbF90IHMw
W10sIGludCBudywgaW50IG5iKSB7CiAgdmFsX3QgYm9ycm93ID0gMDsKICBmb3IgKGludCBpID0g
MDsgaSA8IG53OyBpKyspIHsKICAgIGRbaV0gID0gLXMwW2ldIC0gYm9ycm93OwogICAgYm9ycm93
ID0gczBbaV0gfHwgZFtpXTsKICB9Cn0KCnN0YXRpYyB2b2lkIHN1Yl9uICh2YWxfdCBkW10sIHZh
bF90IHMwW10sIHZhbF90IHMxW10sIGludCBudywgaW50IG5iKSB7CiAgdmFsX3QgYm9ycm93ID0g
MDsKICBmb3IgKGludCBpID0gMDsgaSA8IG53OyBpKyspIHsKICAgIGRbaV0gID0gczBbaV0gLSBz
MVtpXSAtIGJvcnJvdzsKICAgIGJvcnJvdyA9IChzMFtpXSA8IChzMFtpXSAtIHMxW2ldKSkgfHwg
KHMwW2ldIC0gczFbaV0pIDwgZFtpXTsKICB9Cn0KCnN0YXRpYyB2b2lkIG11bF9uICh2YWxfdCBk
W10sIHZhbF90IHMwW10sIHZhbF90IHMxW10sIGludCBuYjAsIGludCBuYjEpIHsKLy8gQWRhcHRl
ZCBmcm9tIEhhY2tlcidzIERlbGlnaHQsIGZyb20gS251dGgKI2lmIEJZVEVfT1JERVIgIT0gTElU
VExFX0VORElBTgojIGVycm9yIG11bF9uIGFzc3VtZXMgYSBsaXR0bGUtZW5kaWFuIGFyY2hpdGVj
dHVyZQojZW5kaWYKICBpbnQgbmJkID0gbmIwICsgbmIxOwogIGZvciAoaW50IGkgPSAwOyBpIDwg
dmFsX25fd29yZHMobmJkKTsgaSsrKQogICAgZFtpXSA9IDA7CgogIGhhbGZfdmFsX3QqIHcgPSBy
ZWludGVycHJldF9jYXN0PGhhbGZfdmFsX3QqPihkKTsKICBoYWxmX3ZhbF90KiB1ID0gcmVpbnRl
cnByZXRfY2FzdDxoYWxmX3ZhbF90Kj4oczApOwogIGhhbGZfdmFsX3QqIHYgPSByZWludGVycHJl
dF9jYXN0PGhhbGZfdmFsX3QqPihzMSk7CiAgaW50IG0gPSB2YWxfbl9oYWxmX3dvcmRzKG5iMCks
IG4gPSB2YWxfbl9oYWxmX3dvcmRzKG5iMSksIHAgPSB2YWxfbl9oYWxmX3dvcmRzKG5iZCk7Cgog
IGZvciAoaW50IGogPSAwOyBqIDwgbjsgaisrKSB7CiAgICB2YWxfdCBrID0gMDsKICAgIGZvciAo
aW50IGkgPSAwOyBpIDwgTUlOKG0sIHAtaik7IGkrKykgewogICAgICB2YWxfdCB0ID0gKHZhbF90
KXVbaV0qdltqXSArIHdbaStqXSArIGs7CiAgICAgIHdbaStqXSA9IHQ7CiAgICAgIGsgPSB0ID4+
IHZhbF9uX2hhbGZfYml0cygpOwogICAgfQogICAgaWYgKGorbSA8IHApCiAgICAgIHdbaittXSA9
IGs7CiAgfQp9CgpzdGF0aWMgdm9pZCByc2hhX24gKHZhbF90IGRbXSwgdmFsX3QgczBbXSwgaW50
IGFtb3VudCwgaW50IG53LCBpbnQgdykgewoKICBpbnQgbl9zaGlmdF9iaXRzICAgICA9IGFtb3Vu
dCAlIHZhbF9uX2JpdHMoKTsKICBpbnQgbl9zaGlmdF93b3JkcyAgICA9IGFtb3VudCAvIHZhbF9u
X2JpdHMoKTsKICBpbnQgbl9yZXZfc2hpZnRfYml0cyA9IHZhbF9uX2JpdHMoKSAtIG5fc2hpZnRf
Yml0czsKICBpbnQgaXNfemVyb19jYXJyeSAgICA9IG5fc2hpZnRfYml0cyA9PSAwOwogIGludCBt
c2IgICAgICAgICAgICAgID0gczBbbnctMV0gPj4gKHcgLSBudyp2YWxfbl9iaXRzKCkgLSAxKTsK
ICB2YWxfdCBjYXJyeSA9IDA7CgogIGlmIChtc2IgPT0gMCkKICAgIGZvciAoaW50IGkgPSAwOyBp
IDwgbl9zaGlmdF93b3JkczsgaSsrKSB7CiAgICAgIGRbbnctaS0xXSA9IDA7CiAgICB9CgogIGZv
ciAoaW50IGkgPSBudy0xOyBpID49IG5fc2hpZnRfd29yZHM7IGktLSkgewogICAgdmFsX3QgdmFs
ID0gczBbaV07CiAgICBkW2ktbl9zaGlmdF93b3Jkc10gPSB2YWwgPj4gbl9zaGlmdF9iaXRzIHwg
Y2Fycnk7CiAgICBjYXJyeSAgICAgICAgICAgICAgPSBpc196ZXJvX2NhcnJ5ID8gMCA6IHZhbCA8
PCBuX3Jldl9zaGlmdF9iaXRzOwogIH0KCiAgaWYgKG1zYiA9PSAwKSB7CiAgICByZXR1cm47CiAg
fQoKICBpbnQgYm91bmRhcnkgPSAodyAtIGFtb3VudCk7CgogIGZvciAoaW50IGkgPSBudy0xOyBp
ID49IDA7IGktLSkgewogICAgaW50IGlkeCA9IGkqdmFsX25fYml0cygpOwogICAgaWYgKGlkeCAg
PiBib3VuZGFyeSkgewogICAgICBkW2ldID0gdmFsX2FsbF9vbmVzKCk7CiAgICB9IGVsc2Ugewog
ICAgICBkW2ldID0gZFtpXSB8ICh2YWxfYWxsX29uZXMoKSA8PCAoYm91bmRhcnkgLSBpZHgpKTsK
ICAgICAgZFtudy0xXSA9IGRbbnctMV0gJiAodmFsX2FsbF9vbmVzKCkgPj4gKChudy0xKSp2YWxf
bl9iaXRzKCkgLSB3KSk7CiAgICAgIHJldHVybjsKICAgIH0KICB9Cn0KCnN0YXRpYyB2b2lkIHJz
aF9uICh2YWxfdCBkW10sIHZhbF90IHMwW10sIGludCBhbW91bnQsIGludCBudykgewogIHZhbF90
IGNhcnJ5ID0gMDsKICBpbnQgbl9zaGlmdF9iaXRzICAgICA9IGFtb3VudCAlIHZhbF9uX2JpdHMo
KTsKICBpbnQgbl9zaGlmdF93b3JkcyAgICA9IGFtb3VudCAvIHZhbF9uX2JpdHMoKTsKICBpbnQg
bl9yZXZfc2hpZnRfYml0cyA9IHZhbF9uX2JpdHMoKSAtIG5fc2hpZnRfYml0czsKICBpbnQgaXNf
emVyb19jYXJyeSAgICA9IG5fc2hpZnRfYml0cyA9PSAwOwogIGZvciAoaW50IGkgPSAwOyBpIDwg
bl9zaGlmdF93b3JkczsgaSsrKQogICAgZFtudy1pLTFdID0gMDsKICBmb3IgKGludCBpID0gbnct
MTsgaSA+PSBuX3NoaWZ0X3dvcmRzOyBpLS0pIHsKICAgIHZhbF90IHZhbCA9IHMwW2ldOwogICAg
ZFtpLW5fc2hpZnRfd29yZHNdID0gdmFsID4+IG5fc2hpZnRfYml0cyB8IGNhcnJ5OwogICAgY2Fy
cnkgICAgICAgICAgICAgID0gaXNfemVyb19jYXJyeSA/IDAgOiB2YWwgPDwgbl9yZXZfc2hpZnRf
Yml0czsKICB9Cn0KCnN0YXRpYyB2b2lkIGxzaF9uICh2YWxfdCBkW10sIHZhbF90IHMwW10sIGlu
dCBhbW91bnQsIGludCBud2QsIGludCBud3MpIHsKICB2YWxfdCBjYXJyeSAgICAgICAgICA9IDA7
CiAgaW50IG5fc2hpZnRfYml0cyAgICAgPSBhbW91bnQgJSB2YWxfbl9iaXRzKCk7CiAgaW50IG5f
c2hpZnRfd29yZHMgICAgPSBhbW91bnQgLyB2YWxfbl9iaXRzKCk7CiAgaW50IG5fcmV2X3NoaWZ0
X2JpdHMgPSB2YWxfbl9iaXRzKCkgLSBuX3NoaWZ0X2JpdHM7CiAgaW50IGlzX3plcm9fY2Fycnkg
ICAgPSBuX3NoaWZ0X2JpdHMgPT0gMDsKICBmb3IgKGludCBpID0gMDsgaSA8IG53ZDsgaSsrKQog
ICAgZFtpXSA9IDA7CiAgZm9yIChpbnQgaSA9IDA7IGkgPCAobndzLW5fc2hpZnRfd29yZHMpOyBp
KyspIHsKICAgIHZhbF90IHZhbCA9IHMwW2ldOwogICAgZFtpK25fc2hpZnRfd29yZHNdID0gdmFs
IDw8IG5fc2hpZnRfYml0cyB8IGNhcnJ5OwogICAgY2FycnkgICAgICAgICAgICAgID0gaXNfemVy
b19jYXJyeSA/IDAgOiB2YWwgPj4gbl9yZXZfc2hpZnRfYml0czsKICB9Cn0KCnN0YXRpYyBpbmxp
bmUgdmFsX3QgbWFza192YWwoaW50IG4pIHsKICB2YWxfdCByZXMgPSB2YWxfYWxsX29uZXMoKSA+
PiAodmFsX25fYml0cygpLW4pOwogIHJldHVybiByZXM7Cn0KCnN0YXRpYyBpbmxpbmUgdm9pZCBt
YXNrX24gKHZhbF90IGRbXSwgaW50IG53LCBpbnQgbmIpIHsKICBpbnQgbl9mdWxsX3dvcmRzID0g
dmFsX25fZnVsbF93b3JkcyhuYik7CiAgaW50IG5fd29yZF9iaXRzICA9IHZhbF9uX3dvcmRfYml0
cyhuYik7CiAgZm9yIChpbnQgaSA9IDA7IGkgPCBuX2Z1bGxfd29yZHM7IGkrKykKICAgIGRbaV0g
PSB2YWxfYWxsX29uZXMoKTsKICBmb3IgKGludCBpID0gbl9mdWxsX3dvcmRzOyBpIDwgbnc7IGkr
KykKICAgIGRbaV0gPSAwOwogIGlmIChuX3dvcmRfYml0cyA+IDApCiAgICBkW25fZnVsbF93b3Jk
c10gPSBtYXNrX3ZhbChuX3dvcmRfYml0cyk7Cn0KCnN0YXRpYyBpbmxpbmUgdmFsX3QgbG9nMl8x
ICh2YWxfdCB2KSB7CiNpZmRlZiBfX0dOVUNfXwogIHJldHVybiBURVJOQVJZKHYgIT0gMCwgdmFs
X25fYml0cygpIC0gMSAtIF9fYnVpbHRpbl9jbHpsbCh2KSwgMCk7CiNlbHNlCiAgdmFsX3QgcjsK
ICB2YWxfdCBzaGlmdDsKICByICAgICA9ICh2ID4gMHhGRkZGRkZGRikgPDwgNTsgdiA+Pj0gcjsK
ICBzaGlmdCA9ICh2ID4gMHhGRkZGICAgICkgPDwgNDsgdiA+Pj0gc2hpZnQ7IHIgfD0gc2hpZnQ7
CiAgc2hpZnQgPSAodiA+IDB4RkYgICAgICApIDw8IDM7IHYgPj49IHNoaWZ0OyByIHw9IHNoaWZ0
OwogIHNoaWZ0ID0gKHYgPiAweEYgICAgICAgKSA8PCAyOyB2ID4+PSBzaGlmdDsgciB8PSBzaGlm
dDsKICBzaGlmdCA9ICh2ID4gMHgzICAgICAgICkgPDwgMTsgdiA+Pj0gc2hpZnQ7IHIgfD0gc2hp
ZnQ7CiAgciAgICB8PSAodiA+PiAxKTsKICByZXR1cm4gcjsKI2VuZGlmCn0KCnN0YXRpYyBpbmxp
bmUgdmFsX3QgcmV2ZXJzZV8xICh2YWxfdCB2KSB7CiAgdiA9ICgodiA+PiAgMSkgJiAweDU1NTU1
NTU1NTU1NTU1NTUpIHwgKCh2ICYgMHg1NTU1NTU1NTU1NTU1NTU1KSA8PCAgMSk7CiAgdiA9ICgo
diA+PiAgMikgJiAweDMzMzMzMzMzMzMzMzMzMzMpIHwgKCh2ICYgMHgzMzMzMzMzMzMzMzMzMzMz
KSA8PCAgMik7CiAgdiA9ICgodiA+PiAgNCkgJiAweDBGMEYwRjBGMEYwRjBGMEYpIHwgKCh2ICYg
MHgwRjBGMEYwRjBGMEYwRjBGKSA8PCAgNCk7CiAgdiA9ICgodiA+PiAgOCkgJiAweDAwRkYwMEZG
MDBGRjAwRkYpIHwgKCh2ICYgMHgwMEZGMDBGRjAwRkYwMEZGKSA8PCAgOCk7CiAgdiA9ICgodiA+
PiAxNikgJiAweDAwMDBGRkZGMDAwMEZGRkYpIHwgKCh2ICYgMHgwMDAwRkZGRjAwMDBGRkZGKSA8
PCAxNik7CiAgdiA9ICggdiA+PiAzMiAgICAgICAgICAgICAgICAgICAgICApIHwgKCB2ICAgICAg
ICAgICAgICAgICAgICAgICA8PCAzMik7CiAgcmV0dXJuIHY7Cn0KCnN0YXRpYyBpbmxpbmUgdmFs
X3QgcHJpb3JpdHlfZW5jb2RlXzEgKHZhbF90IHYpIHsKI2lmZGVmIF9fR05VQ19fCiAgcmV0dXJu
IFRFUk5BUlkodiAhPSAwLCBfX2J1aWx0aW5fY3R6bGwodiksIDApOwojZWxzZQogIGlmICh2ID09
IDApCiAgICByZXR1cm4gMDsKICB2YWxfdCByOwogIHZhbF90IHNoaWZ0OwogIHIgICAgID0gISh2
ICYgMHhGRkZGRkZGRikgPDwgNTsgdiA+Pj0gcjsKICBzaGlmdCA9ICEodiAmIDB4RkZGRiAgICAp
IDw8IDQ7IHYgPj49IHNoaWZ0OyByIHw9IHNoaWZ0OwogIHNoaWZ0ID0gISh2ICYgMHhGRiAgICAg
ICkgPDwgMzsgdiA+Pj0gc2hpZnQ7IHIgfD0gc2hpZnQ7CiAgc2hpZnQgPSAhKHYgJiAweEYgICAg
ICAgKSA8PCAyOyB2ID4+PSBzaGlmdDsgciB8PSBzaGlmdDsKICBzaGlmdCA9ICEodiAmIDB4MyAg
ICAgICApIDw8IDE7IHYgPj49IHNoaWZ0OyByIHw9IHNoaWZ0OwogIHNoaWZ0ID0gISh2ICYgMHgx
ICAgICAgICkgPDwgMDsgdiA+Pj0gc2hpZnQ7IHIgfD0gc2hpZnQ7CiAgcmV0dXJuIHI7CiNlbmRp
Zgp9CgojZGVmaW5lIGlzcG93Mih4KSAoKCh4KSAmICgoeCktMSkpID09IDApCnN0YXRpYyBpbmxp
bmUgdmFsX3QgbmV4dHBvdzJfMSh2YWxfdCB4KSB7CiAgeC0tOwogIHggfD0geCA+PiAxOwogIHgg
fD0geCA+PiAyOwogIHggfD0geCA+PiA0OwogIHggfD0geCA+PiA4OwogIHggfD0geCA+PiAxNjsK
ICB4IHw9IHggPj4gMzI7CiAgeCsrOwogIHJldHVybiB4Owp9CgovKgojZGVmaW5lIF9fRkxPQVRf
V09SRF9PUkRFUiBMSVRUTEVfRU5ESUFOCgpzdGF0aWMgaW5saW5lIHVpbnQzMl90IGxvZzJfMV8z
MiAodWludDMyX3QgdikgewogIHVuaW9uIHsgdWludDMyX3QgdVsyXTsgZG91YmxlIGQ7IH0gdDsg
Ly8gdGVtcAoKICB0LnVbX19GTE9BVF9XT1JEX09SREVSPT1MSVRUTEVfRU5ESUFOXSA9IDB4NDMz
MDAwMDA7CiAgdC51W19fRkxPQVRfV09SRF9PUkRFUiE9TElUVExFX0VORElBTl0gPSB2OwogIHQu
ZCAtPSA0NTAzNTk5NjI3MzcwNDk2LjA7CiAgcmV0dXJuICh0LnVbX19GTE9BVF9XT1JEX09SREVS
PT1MSVRUTEVfRU5ESUFOXSA+PiAyMCkgLSAweDNGRjsKfQoKc3RhdGljIGlubGluZSB2YWxfdCBs
b2cyXzEgKHZhbF90IHYpIHsKICB1aW50MzJfdCByX2xvID0gKHVpbnQzMl90KXY7CiAgdWludDMy
X3Qgcl9oaSA9ICh1aW50MzJfdCkodiA+PiAzMik7CiAgcmV0dXJuICgoKHZhbF90KWxvZzJfMV8z
MihyX2hpKSkgPDwgMzIpfCgodmFsX3QpbG9nMl8xXzMyKHJfbG8pKTsKfQoqLwoKLyoKc3RhdGlj
IGlubGluZSB2YWxfdCBsb2cyXzEgKHZhbF90IHYpIHsKICB2IHw9ICh2ID4+IDEpOwogIHYgfD0g
KHYgPj4gMik7CiAgdiB8PSAodiA+PiA0KTsKICB2IHw9ICh2ID4+IDgpOwogIHYgfD0gKHYgPj4g
MTYpOwogIHYgfD0gKHYgPj4gMzIpOwogIHJldHVybiBvbmVzNjQodikgLSAxOwp9CiovCgovKgpz
dGF0aWMgaW5saW5lIHZhbF90IGxvZzJfMSAodmFsX3QgdikgewogIHZhbF90IHJlcyA9IDA7CiAg
d2hpbGUgKHYgPj49IDEpCiAgICByZXMrKzsKICByZXR1cm4gcmVzOwp9CiovCgpzdGF0aWMgaW5s
aW5lIHZhbF90IGxvZzJfbiAodmFsX3QgczBbXSwgaW50IG53KSB7CiAgdmFsX3Qgb2ZmID0gKG53
LTEpKnZhbF9uX2JpdHMoKTsKICBmb3IgKGludCBpID0gbnctMTsgaSA+PSAwOyBpLS0pIHsKICAg
IHZhbF90IHMwaSA9IHMwW2ldOwogICAgaWYgKHMwaSA+IDApIHsKICAgICAgdmFsX3QgcmVzID0g
bG9nMl8xKHMwaSk7CiAgICAgIHJldHVybiByZXMgKyBvZmY7CiAgICB9CiAgICBvZmYgLT0gdmFs
X25fYml0cygpOwogIH0KICByZXR1cm4gMDsKfQoKdGVtcGxhdGUgPGludCBudz4Kc3RydWN0IGJp
dF93b3JkX2Z1bnMgewogIHN0YXRpYyB2b2lkIGZpbGwgKHZhbF90IGRbXSwgdmFsX3QgczApIHsK
ICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnc7IGkrKykKICAgICAgZFtpXSA9IHMwOwogIH0KICBz
dGF0aWMgdm9pZCBmaWxsX25iICh2YWxfdCBkW10sIHZhbF90IHMwLCBpbnQgbmIpIHsKICAgIG1h
c2tfbihkLCBudywgbmIpOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudzsgaSsrKQogICAgICBk
W2ldID0gZFtpXSAmIHMwOwogICAgLy8gcHJpbnRmKCJGSUxMLU5CIE5cbiIpOwogIH0KICBzdGF0
aWMgdm9pZCBjb3B5ICh2YWxfdCBkW10sIHZhbF90IHMwW10sIGludCBzd3cpIHsKICAgIGlmIChz
d3cgPiBudykgewogICAgICBmb3IgKGludCBpID0gMDsgaSA8IG53OyBpKyspIHsKICAgICAgICAv
LyBwcmludGYoIkEgSSAlZFxuIiwgaSk7IGZmbHVzaChzdGRvdXQpOwogICAgICAgIGRbaV0gPSBz
MFtpXTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgZm9yIChpbnQgaSA9IDA7IGkgPCBzd3c7
IGkrKykgewogICAgICAgIC8vIHByaW50ZigiQiBJICVkXG4iLCBpKTsgZmZsdXNoKHN0ZG91dCk7
CiAgICAgICAgZFtpXSA9IHMwW2ldOwogICAgICB9CiAgICAgIGZvciAoaW50IGkgPSBzd3c7IGkg
PCBudzsgaSsrKSB7CiAgICAgICAgLy8gcHJpbnRmKCJDIEkgJWRcbiIsIGkpOyBmZmx1c2goc3Rk
b3V0KTsKICAgICAgICBkW2ldID0gMDsKICAgICAgfQogICAgfQogIH0KICBzdGF0aWMgdm9pZCBt
YXNrICh2YWxfdCBkW10sIGludCBuYikgewogICAgbWFza19uKGQsIG53LCBuYik7CiAgfQogIHN0
YXRpYyB2b2lkIGFkZCAodmFsX3QgZFtdLCB2YWxfdCBzMFtdLCB2YWxfdCBzMVtdLCBpbnQgbmIp
IHsKICAgIGFkZF9uKGQsIHMwLCBzMSwgbncsIG5iKTsKICB9CiAgc3RhdGljIHZvaWQgbmVnICh2
YWxfdCBkW10sIHZhbF90IHMwW10sIGludCBuYikgewogICAgbmVnX24oZCwgczAsIG53LCBuYik7
CiAgfQogIHN0YXRpYyB2b2lkIHN1YiAodmFsX3QgZFtdLCB2YWxfdCBzMFtdLCB2YWxfdCBzMVtd
LCBpbnQgbmIpIHsKICAgIHN1Yl9uKGQsIHMwLCBzMSwgbncsIG5iKTsKICB9CiAgc3RhdGljIHZv
aWQgbXVsICh2YWxfdCBkW10sIHZhbF90IHMwW10sIHZhbF90IHMxW10sIGludCBuYjAsIGludCBu
YjEpIHsKICAgIG11bF9uKGQsIHMwLCBzMSwgbmIwLCBuYjEpOwogIH0KICBzdGF0aWMgdm9pZCBi
aXRfeG9yICh2YWxfdCBkW10sIHZhbF90IHMwW10sIHZhbF90IHMxW10pIHsKICAgIGZvciAoaW50
IGkgPSAwOyBpIDwgbnc7IGkrKykKICAgICAgZFtpXSA9IHMwW2ldIF4gczFbaV07CiAgfQogIHN0
YXRpYyB2b2lkIGJpdF9hbmQgKHZhbF90IGRbXSwgdmFsX3QgczBbXSwgdmFsX3QgczFbXSkgewog
ICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudzsgaSsrKQogICAgICBkW2ldID0gczBbaV0gJiBzMVtp
XTsKICB9CiAgc3RhdGljIHZvaWQgYml0X29yICh2YWxfdCBkW10sIHZhbF90IHMwW10sIHZhbF90
IHMxW10pIHsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnc7IGkrKykKICAgICAgZFtpXSA9IHMw
W2ldIHwgczFbaV07CiAgfQogIHN0YXRpYyB2b2lkIGJpdF9uZWcgKHZhbF90IGRbXSwgdmFsX3Qg
czBbXSwgaW50IG5iKSB7CiAgICB2YWxfdCBtc2tbbnddOwogICAgbWFza19uKG1zaywgbncsIG5i
KTsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbnc7IGkrKykKICAgICAgZFtpXSA9IH5zMFtpXSAm
IG1za1tpXTsKICB9CiAgc3RhdGljIGJvb2wgbHR1ICh2YWxfdCBzMFtdLCB2YWxfdCBzMVtdKSB7
CiAgICB2YWxfdCBkaWZmW253XTsKICAgIHN1YihkaWZmLCBzMCwgczEsIG53KnZhbF9uX2JpdHMo
KSk7CiAgICByZXR1cm4gdmFsX3RvcF9iaXQoZGlmZltudy0xXSk7CiAgfQogIHN0YXRpYyBib29s
IGx0ICh2YWxfdCBzMFtdLCB2YWxfdCBzMVtdLCBpbnQgdykgewogICAgaW50IG1zYl8wID0gKHMw
WzFdID4+ICh3IC0gKG53LTEpKnZhbF9uX2JpdHMoKSAtIDEpKSAmIDB4MTsKICAgIGludCBtc2Jf
MSA9IChzMVsxXSA+PiAodyAtIChudy0xKSp2YWxfbl9iaXRzKCkgLSAxKSkgJiAweDE7CiAgICBp
ZiAobXNiXzAgIT0gbXNiXzEpIHsKICAgICAgcmV0dXJuIG1zYl8wOwogICAgfSBlbHNlIHsKICAg
ICAgdmFsX3QgZGlmZltud107CiAgICAgIHN1YihkaWZmLCBzMCwgczEsIG53KnZhbF9uX2JpdHMo
KSk7CiAgICAgIHJldHVybiB2YWxfdG9wX2JpdChkaWZmW253LTFdKTsKICAgIH0KICB9CiAgc3Rh
dGljIGJvb2wgbHRldSAodmFsX3QgczBbXSwgdmFsX3QgczFbXSkgewogICAgdmFsX3QgZGlmZltu
d107CiAgICBzdWIoZGlmZiwgczEsIHMwLCBudyp2YWxfbl9iaXRzKCkpOwogICAgcmV0dXJuICF2
YWxfdG9wX2JpdChkaWZmW253LTFdKTsKICB9CiAgc3RhdGljIGJvb2wgbHRlICh2YWxfdCBzMFtd
LCB2YWxfdCBzMVtdLCBpbnQgdykgewogICAgaW50IG1zYl8wID0gKHMwWzFdID4+ICh3IC0gKG53
LTEpKnZhbF9uX2JpdHMoKSAtIDEpKSAmIDB4MTsKICAgIGludCBtc2JfMSA9IChzMVsxXSA+PiAo
dyAtIChudy0xKSp2YWxfbl9iaXRzKCkgLSAxKSkgJiAweDE7CiAgICBpZiAobXNiXzAgIT0gbXNi
XzEpIHsKICAgICAgcmV0dXJuIG1zYl8wOwogICAgfSBlbHNlIHsKICAgICAgdmFsX3QgZGlmZltu
d107CiAgICAgIHN1YihkaWZmLCBzMSwgczAsIG53KnZhbF9uX2JpdHMoKSk7CiAgICAgIHJldHVy
biAhdmFsX3RvcF9iaXQoZGlmZltudy0xXSk7CiAgICB9CiAgfQogIHN0YXRpYyBib29sIGVxICh2
YWxfdCBzMFtdLCB2YWxfdCBzMVtdKSB7CiAgICBmb3IgKGludCBpID0gMDsgaSA8IG53OyBpKysp
CiAgICAgIGlmIChzMFtpXSAhPSBzMVtpXSkKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICByZXR1
cm4gdHJ1ZTsKICB9CiAgc3RhdGljIGJvb2wgbmVxICh2YWxfdCBzMFtdLCB2YWxfdCBzMVtdKSB7
CiAgICByZXR1cm4gIWVxKHMwLCBzMSk7CiAgfQogIHN0YXRpYyB2b2lkIHJzaGEgKHZhbF90IGRb
XSwgdmFsX3QgczBbXSwgaW50IGFtb3VudCwgaW50IHcpIHsKICAgIHJzaGFfbihkLCBzMCwgYW1v
dW50LCBudywgdyk7CiAgfQogIHN0YXRpYyB2b2lkIHJzaCAodmFsX3QgZFtdLCB2YWxfdCBzMFtd
LCBpbnQgYW1vdW50KSB7CiAgICByc2hfbihkLCBzMCwgYW1vdW50LCBudyk7CiAgfQogIHN0YXRp
YyB2b2lkIGxzaCAodmFsX3QgZFtdLCB2YWxfdCBzMFtdLCBpbnQgYW1vdW50KSB7CiAgICBsc2hf
bihkLCBzMCwgYW1vdW50LCBudywgbncpOwogIH0KICBzdGF0aWMgdm9pZCBleHRyYWN0ICh2YWxf
dCBkW10sIHZhbF90IHMwW10sIGludCBlLCBpbnQgcywgaW50IG5iKSB7CiAgICAvLyBUT0RPOiBG
SU5JU0ggVEhJUwogICAgY29uc3QgaW50IGJ3ID0gZS1zKzE7CiAgICB2YWxfdCBtc2tbbnddOwog
ICAgbWFza19uKG1zaywgbncsIG5iKTsKICAgIGlmIChzID09IDApIHsKICAgICAgLy8gcHJpbnRm
KCJFWFQgRSAlZCBTICVkIE5XICVkIE5CICVkOiAiLCBlLCBzLCBudywgbmIpOwogICAgICBmb3Ig
KGludCBpID0gMDsgaSA8IG53OyBpKyspIHsKICAgICAgICBkW2ldID0gczBbaV0gJiBtc2tbaV07
CiAgICAgICAgLy8gcHJpbnRmKCIlZDolbGx4ICIsIGksIGRbaV0pOwogICAgICB9CiAgICB9IGVs
c2UgewogICAgICByc2hfbihkLCBzMCwgcywgbncpOwogICAgICAvLyBwcmludGYoIkVYVCBFICVk
IFMgJWQgTlcgJWQgTkIgJWQ6ICIsIGUsIHMsIG53LCBuYik7CiAgICAgIGZvciAoaW50IGkgPSAw
OyBpIDwgbnc7IGkrKykgewogICAgICAgIC8vIHByaW50ZigiSSVkOlIlbGx4Ok0lbGx4OiIsIGks
IGRbaV0sIG1za1tpXSk7CiAgICAgICAgZFtpXSA9IGRbaV0gJiBtc2tbaV07CiAgICAgICAgLy8g
cHJpbnRmKCJEJWxseCAiLCBkW2ldKTsKICAgICAgfQogICAgfQogICAgLy8gcHJpbnRmKCJcbiIp
OwogIH0KCiAgc3RhdGljIHZvaWQgaW5qZWN0ICh2YWxfdCBkW10sIHZhbF90IHMwW10sIGludCBl
LCBpbnQgcykgewogICAgLy8gT3Bwb3NpdGUgb2YgZXh0cmFjdDogQXNzaWduIHMwIHRvIGEgc3Vi
ZmllbGQgb2YgZC4KICAgIGNvbnN0IGludCBidyA9IGUtcysxOwogICAgdmFsX3QgbXNrW253XTsK
ICAgIHZhbF90IG1za19sc2hbbnddOwogICAgdmFsX3QgczBfbHNoW253XTsKICAgIG1hc2tfbiht
c2ssIG53LCBidyk7CiAgICBsc2hfbihtc2tfbHNoLCBtc2ssIHMsIG53LCBudyk7CiAgICBsc2hf
bihzMF9sc2gsIHMwLCBzLCBudywgbncpOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBudzsgaSsr
KSB7CiAgICAgIGRbaV0gPSAoZFtpXSAmIH5tc2tfbHNoW2ldKSB8IChzMF9sc2hbaV0gJiBtc2tf
bHNoW2ldKTsKICAgIH0KICB9CgogIHN0YXRpYyB2b2lkIHNldCAodmFsX3QgZFtdLCB2YWxfdCBz
MFtdKSB7CiAgICBmb3IgKGludCBpID0gMDsgaSA8IG53OyBpKyspCiAgICAgIGRbaV0gPSBzMFtp
XTsKICB9CiAgc3RhdGljIHZvaWQgbG9nMiAodmFsX3QgZFtdLCB2YWxfdCBzMFtdKSB7CiAgICBk
WzBdID0gbG9nMl9uKHMwLCBudyk7CiAgfQp9OwoKdGVtcGxhdGUgPD4Kc3RydWN0IGJpdF93b3Jk
X2Z1bnM8MT4gewogIHN0YXRpYyB2b2lkIGZpbGwgKHZhbF90IGRbXSwgdmFsX3QgczApIHsKICAg
IGRbMF0gPSBzMDsKICB9CiAgc3RhdGljIHZvaWQgZmlsbF9uYiAodmFsX3QgZFtdLCB2YWxfdCBz
MCwgaW50IG5iKSB7CiAgICBkWzBdID0gbWFza192YWwobmIpICYgczA7CiAgfQogIHN0YXRpYyB2
b2lkIGNvcHkgKHZhbF90IGRbXSwgdmFsX3QgczBbXSwgaW50IHN3dykgewogICAgZFswXSA9IHMw
WzBdOwogIH0KICBzdGF0aWMgdm9pZCBtYXNrICh2YWxfdCBkW10sIGludCBuYikgewogICAgZFsw
XSA9IG1hc2tfdmFsKG5iKTsKICB9CiAgc3RhdGljIHZvaWQgYWRkICh2YWxfdCBkW10sIHZhbF90
IHMwW10sIHZhbF90IHMxW10sIGludCBuYikgewogICAgZFswXSA9IChzMFswXSArIHMxWzBdKSAm
IG1hc2tfdmFsKG5iKTsKICB9CiAgc3RhdGljIHZvaWQgc3ViICh2YWxfdCBkW10sIHZhbF90IHMw
W10sIHZhbF90IHMxW10sIGludCBuYikgewogICAgZFswXSA9IChzMFswXSAtIHMxWzBdKSAmIG1h
c2tfdmFsKG5iKTsKICB9CiAgc3RhdGljIHZvaWQgbmVnICh2YWxfdCBkW10sIHZhbF90IHMwW10s
IGludCBuYikgewogICAgZFswXSA9ICgtIHMwWzBdKSAmIG1hc2tfdmFsKG5iKTsKICB9CiAgc3Rh
dGljIHZvaWQgbXVsICh2YWxfdCBkW10sIHZhbF90IHMwW10sIHZhbF90IHMxW10sIGludCBuYjAs
IGludCBuYjEpIHsKICAgIGRbMF0gPSBzMFswXSAqIHMxWzBdOwogIH0KICBzdGF0aWMgYm9vbCBs
dHUgKHZhbF90IHMwW10sIHZhbF90IHMxW10pIHsKICAgIHJldHVybiAoczBbMF0gPCBzMVswXSk7
CiAgfQogIHN0YXRpYyBib29sIGx0ICh2YWxfdCBzMFtdLCB2YWxfdCBzMVtdLCBpbnQgdykgewog
ICAgc3ZhbF90IGEgPSBzMFswXSA8PCAodmFsX25fYml0cygpIC0gdyk7CiAgICBzdmFsX3QgYiA9
IHMxWzBdIDw8ICh2YWxfbl9iaXRzKCkgLSB3KTsKICAgIHJldHVybiAoYSA8IGIpOwogIH0KICBz
dGF0aWMgYm9vbCBsdGV1ICh2YWxfdCBzMFtdLCB2YWxfdCBzMVtdKSB7CiAgICByZXR1cm4gKHMw
WzBdIDw9IHMxWzBdKTsKICB9CiAgc3RhdGljIGJvb2wgbHRlICh2YWxfdCBzMFtdLCB2YWxfdCBz
MVtdLCBpbnQgdykgewogICAgc3ZhbF90IGEgPSBzMFswXSA8PCAodmFsX25fYml0cygpIC0gdyk7
CiAgICBzdmFsX3QgYiA9IHMxWzBdIDw8ICh2YWxfbl9iaXRzKCkgLSB3KTsKICAgIHJldHVybiAo
YSA8PSBiKTsKICB9CiAgc3RhdGljIHZvaWQgYml0X25lZyAodmFsX3QgZFtdLCB2YWxfdCBzMFtd
LCBpbnQgbmIpIHsKICAgIGRbMF0gPSB+czBbMF0gJiBtYXNrX3ZhbChuYik7CiAgfQogIHN0YXRp
YyB2b2lkIGJpdF94b3IgKHZhbF90IGRbXSwgdmFsX3QgczBbXSwgdmFsX3QgczFbXSkgewogICAg
ZFswXSA9IChzMFswXSBeIHMxWzBdKTsKICB9CiAgc3RhdGljIHZvaWQgYml0X2FuZCAodmFsX3Qg
ZFtdLCB2YWxfdCBzMFtdLCB2YWxfdCBzMVtdKSB7CiAgICBkWzBdID0gKHMwWzBdICYgczFbMF0p
OwogIH0KICBzdGF0aWMgdm9pZCBiaXRfb3IgKHZhbF90IGRbXSwgdmFsX3QgczBbXSwgdmFsX3Qg
czFbXSkgewogICAgZFswXSA9IChzMFswXSB8IHMxWzBdKTsKICB9CiAgc3RhdGljIGJvb2wgZXEg
KHZhbF90IHMwW10sIHZhbF90IHMxW10pIHsKICAgIHJldHVybiBzMFswXSA9PSBzMVswXTsKICB9
CiAgc3RhdGljIGJvb2wgbmVxICh2YWxfdCBzMFtdLCB2YWxfdCBzMVtdKSB7CiAgICByZXR1cm4g
czBbMF0gIT0gczFbMF07CiAgfQogIHN0YXRpYyB2b2lkIGxzaCAodmFsX3QgZFtdLCB2YWxfdCBz
MFtdLCBpbnQgYW1vdW50KSB7CiAgICBkWzBdID0gKHMwWzBdIDw8IGFtb3VudCk7CiAgfQogIHN0
YXRpYyB2b2lkIHJzaCAodmFsX3QgZFtdLCB2YWxfdCBzMFtdLCBpbnQgYW1vdW50KSB7CiAgICBk
WzBdID0gKHMwWzBdID4+IGFtb3VudCk7CiAgfQogIHN0YXRpYyB2b2lkIHJzaGEgKHZhbF90IGRb
XSwgdmFsX3QgczBbXSwgaW50IGFtb3VudCwgaW50IHcpIHsKICAgIGRbMF0gPSBzMFswXSA8PCAo
dmFsX25fYml0cygpIC0gdyk7CiAgICBkWzBdID0gKHN2YWxfdChkWzBdKSA+PiAodmFsX25fYml0
cygpIC0gdyArIGFtb3VudCkpICYgbWFza192YWwodyk7CiAgfQogIHN0YXRpYyB2b2lkIGV4dHJh
Y3QgKHZhbF90IGRbXSwgdmFsX3QgczBbXSwgaW50IGUsIGludCBzLCBpbnQgbmIpIHsKICAgIGNv
bnN0IGludCBidyA9IGUtcysxOwogICAgZFswXSA9IChzMFswXSA+PiBzKSAmIG1hc2tfdmFsKGJ3
KTsKICB9CgogIHN0YXRpYyB2b2lkIGluamVjdCAodmFsX3QgZFtdLCB2YWxfdCBzMFtdLCBpbnQg
ZSwgaW50IHMpIHsKICAgIC8vIE9wcG9zaXRlIG9mIGV4dHJhY3Q6IEFzc2lnbiBzMCB0byBhIHN1
YmZpZWxkIG9mIGQuCiAgICBjb25zdCBpbnQgYncgPSBlLXMrMTsKICAgIHZhbF90IG1zayA9IG1h
c2tfdmFsKGJ3KTsKICAgIGRbMF0gPSAoKHMwWzBdICYgbXNrKSA8PCBzKSB8IChkWzBdICYgfiht
c2sgPDwgcykpOwogIH0KCiAgc3RhdGljIHZvaWQgc2V0ICh2YWxfdCBkW10sIHZhbF90IHMwW10p
IHsKICAgIGRbMF0gPSBzMFswXTsKICB9CiAgc3RhdGljIHZvaWQgbG9nMiAodmFsX3QgZFtdLCB2
YWxfdCBzMFtdKSB7CiAgICBkWzBdID0gbG9nMl8xKHMwWzBdKTsKICB9Cn07Cgp0ZW1wbGF0ZSA8
PgpzdHJ1Y3QgYml0X3dvcmRfZnVuczwyPiB7CiAgc3RhdGljIHZvaWQgZmlsbCAodmFsX3QgZFtd
LCB2YWxfdCBzMCkgewogICAgZFswXSA9IHMwOwogICAgZFsxXSA9IHMwOwogIH0KICBzdGF0aWMg
dm9pZCBmaWxsX25iICh2YWxfdCBkW10sIHZhbF90IHMwLCBpbnQgbmIpIHsKICAgIGRbMF0gPSBz
MDsKICAgIGRbMV0gPSBtYXNrX3ZhbChuYiAtIHZhbF9uX2JpdHMoKSkgJiBzMDsKICB9CiAgc3Rh
dGljIHZvaWQgY29weSAodmFsX3QgZFtdLCB2YWxfdCBzMFtdLCBpbnQgc3d3KSB7CiAgICBkWzBd
ID0gczBbMF07CiAgICBkWzFdID0gc3d3ID4gMSA/IHMwWzFdIDogMDsKICB9CiAgc3RhdGljIHZv
aWQgbWFzayAodmFsX3QgZFtdLCBpbnQgbmIpIHsKICAgIGRbMF0gPSB2YWxfYWxsX29uZXMoKTsK
ICAgIGRbMV0gPSBtYXNrX3ZhbChuYiAtIHZhbF9uX2JpdHMoKSk7CiAgfQogIHN0YXRpYyB2b2lk
IGFkZCAodmFsX3QgZFtdLCB2YWxfdCB4W10sIHZhbF90IHlbXSwgaW50IG5iKSB7CiAgICB2YWxf
dCB4MCAgICAgPSB4WzBdOwogICAgdmFsX3Qgc3VtMCAgID0geDAgKyB5WzBdOwogICAgdmFsX3Qg
Y2FycnkwID0gKHN1bTAgPCB4MCk7CiAgICBkWzBdICAgICAgICAgPSBzdW0wOwogICAgdmFsX3Qg
c3VtMSAgID0geFsxXSArIHlbMV0gKyBjYXJyeTA7CiAgICBkWzFdICAgICAgICAgPSBzdW0xOwog
IH0KICBzdGF0aWMgdm9pZCBzdWIgKHZhbF90IGRbXSwgdmFsX3QgczBbXSwgdmFsX3QgczFbXSwg
aW50IG5iKSB7CiAgICB2YWxfdCBkMCA9IHMwWzBdIC0gczFbMF07CiAgICBkWzFdID0gczBbMV0g
LSBzMVsxXSAtIChzMFswXSA8IGQwKTsKICAgIGRbMF0gPSBkMDsKICB9CiAgc3RhdGljIHZvaWQg
bmVnICh2YWxfdCBkW10sIHZhbF90IHMwW10sIGludCBuYikgewogICAgdmFsX3QgZDAgPSAtczBb
MF07CiAgICBkWzFdID0gLXMwWzFdIC0gKHMwWzBdICE9IDApOwogICAgZFswXSA9IGQwOwogIH0K
ICBzdGF0aWMgdm9pZCBtdWwgKHZhbF90IGRbXSwgdmFsX3QgczBbXSwgdmFsX3QgczFbXSwgaW50
IG5iMCwgaW50IG5iMSkgewojaWZkZWYgX19IQVZFX0RVQl9WQUxfVF9fCiAgICBkdWJfdmFsX3Qg
YSA9IHMwWzBdLCBiID0gczFbMF07CiAgICBpZiAobmIwID4gdmFsX25fYml0cygpKSBhIHw9IGR1
Yl92YWxfdChzMFsxXSkgPDwgdmFsX25fYml0cygpOwogICAgaWYgKG5iMSA+IHZhbF9uX2JpdHMo
KSkgYiB8PSBkdWJfdmFsX3QoczFbMV0pIDw8IHZhbF9uX2JpdHMoKTsKICAgIGR1Yl92YWxfdCBy
ZXMgPSBhICogYjsKICAgIGRbMF0gPSByZXM7CiAgICBkWzFdID0gcmVzID4+IHZhbF9uX2JpdHMo
KTsKI2Vsc2UKICAgIG11bF9uKGQsIHMwLCBzMSwgbmIwLCBuYjEpOwojZW5kaWYKICB9CiAgc3Rh
dGljIGJvb2wgbHR1ICh2YWxfdCBzMFtdLCB2YWxfdCBzMVtdKSB7CiAgICByZXR1cm4gKChzMFsx
XSA8IHMxWzFdKSB8IChzMFsxXSA9PSBzMVsxXSAmIHMwWzBdIDwgczFbMF0pKTsKICB9CiAgc3Rh
dGljIGJvb2wgbHQgKHZhbF90IHMwW10sIHZhbF90IHMxW10sIGludCB3KSB7CiAgICBpbnQgbXNi
XzAgPSAoczBbMV0gPj4gKHcgLSB2YWxfbl9iaXRzKCkgLSAxKSkgJiAweDE7CiAgICBpbnQgbXNi
XzEgPSAoczFbMV0gPj4gKHcgLSB2YWxfbl9iaXRzKCkgLSAxKSkgJiAweDE7CiAgICBpbnQgY29u
ZCAgPSBtc2JfMCBeIG1zYl8xOwogICAgcmV0dXJuIChjb25kICYmIG1zYl8wKQogICAgICAgIHx8
ICghY29uZCAmJiAoKHMwWzFdIDwgczFbMV0pIHwgKHMwWzFdID09IHMxWzFdICYgczBbMF0gPCBz
MVswXSkpKTsKICB9CiAgc3RhdGljIGJvb2wgbHRldSAodmFsX3QgczBbXSwgdmFsX3QgczFbXSkg
ewogICAgcmV0dXJuICgoczBbMV0gPCBzMVsxXSkgfCAoczBbMV0gPT0gczFbMV0gJiBzMFswXSA8
PSBzMVswXSkpOwogIH0KICBzdGF0aWMgYm9vbCBsdGUgKHZhbF90IHMwW10sIHZhbF90IHMxW10s
IGludCB3KSB7CiAgICBpbnQgbXNiXzAgPSAoczBbMV0gPj4gKHcgLSB2YWxfbl9iaXRzKCkgLSAx
KSkgJiAweDE7CiAgICBpbnQgbXNiXzEgPSAoczFbMV0gPj4gKHcgLSB2YWxfbl9iaXRzKCkgLSAx
KSkgJiAweDE7CiAgICBpbnQgY29uZCA9IG1zYl8wIF4gbXNiXzE7CiAgICByZXR1cm4gKGNvbmQg
JiYgbXNiXzApCiAgICAgICAgfHwgKCFjb25kICYmICgoczBbMV0gPCBzMVsxXSkgfCAoczBbMV0g
PT0gczFbMV0gJiBzMFswXSA8PSBzMVswXSkpKTsKICB9CiAgc3RhdGljIHZvaWQgYml0X3hvciAo
dmFsX3QgZFtdLCB2YWxfdCBzMFtdLCB2YWxfdCBzMVtdKSB7CiAgICBkWzBdID0gKHMwWzBdIF4g
czFbMF0pOwogICAgZFsxXSA9IChzMFsxXSBeIHMxWzFdKTsKICB9CiAgc3RhdGljIHZvaWQgYml0
X2FuZCAodmFsX3QgZFtdLCB2YWxfdCBzMFtdLCB2YWxfdCBzMVtdKSB7CiAgICBkWzBdID0gKHMw
WzBdICYgczFbMF0pOwogICAgZFsxXSA9IChzMFsxXSAmIHMxWzFdKTsKICB9CiAgc3RhdGljIHZv
aWQgYml0X29yICh2YWxfdCBkW10sIHZhbF90IHMwW10sIHZhbF90IHMxW10pIHsKICAgIGRbMF0g
PSAoczBbMF0gfCBzMVswXSk7CiAgICBkWzFdID0gKHMwWzFdIHwgczFbMV0pOwogIH0KICBzdGF0
aWMgdm9pZCBiaXRfbmVnICh2YWxfdCBkW10sIHZhbF90IHMwW10sIGludCBuYikgewogICAgZFsw
XSA9IH5zMFswXTsKICAgIGRbMV0gPSB+czBbMV0gJiBtYXNrX3ZhbChuYiAtIHZhbF9uX2JpdHMo
KSk7CiAgfQogIHN0YXRpYyBib29sIGVxICh2YWxfdCBzMFtdLCB2YWxfdCBzMVtdKSB7CiAgICBy
ZXR1cm4gKHMwWzBdID09IHMxWzBdKSAmIChzMFsxXSA9PSBzMVsxXSk7CiAgfQogIHN0YXRpYyBi
b29sIG5lcSAodmFsX3QgczBbXSwgdmFsX3QgczFbXSkgewogICAgcmV0dXJuIChzMFswXSAhPSBz
MVswXSkgfCAoczBbMV0gIT0gczFbMV0pOwogIH0KICBzdGF0aWMgdm9pZCBleHRyYWN0ICh2YWxf
dCBkW10sIHZhbF90IHMwW10sIGludCBlLCBpbnQgcywgaW50IG5iKSB7CiAgICB2YWxfdCBtc2tb
Ml07CiAgICBjb25zdCBpbnQgYncgPSBlLXMrMTsKICAgIG1hc2tfbihtc2ssIDIsIGJ3KTsKICAg
IGlmIChzID09IDApIHsKICAgICAgZFswXSA9IHMwWzBdICYgbXNrWzBdOwogICAgICBkWzFdID0g
czBbMV0gJiBtc2tbMV07CiAgICB9IGVsc2UgewogICAgICByc2goZCwgczAsIHMpOwogICAgICBk
WzBdID0gZFswXSAmIG1za1swXTsKICAgICAgZFsxXSA9IGRbMV0gJiBtc2tbMV07CiAgICB9CiAg
fQoKICBzdGF0aWMgdm9pZCBpbmplY3QgKHZhbF90IGRbXSwgdmFsX3QgczBbXSwgaW50IGUsIGlu
dCBzKSB7CiAgICAvLyBPcHBvc2l0ZSBvZiBleHRyYWN0OiBBc3NpZ24gczAgdG8gYSBzdWJmaWVs
ZCBvZiBkLgogICAgY29uc3QgaW50IGJ3ID0gZS1zKzE7CiAgICB2YWxfdCBtc2tbMl07CiAgICB2
YWxfdCBtc2tfbHNoWzJdOwogICAgdmFsX3QgczBfbHNoWzJdOwogICAgbWFza19uKG1zaywgMiwg
YncpOwogICAgbHNoX24obXNrX2xzaCwgbXNrLCBzLCAyLCAyKTsKICAgIGxzaF9uKHMwX2xzaCwg
czAsIHMsIDIsIDIpOwogICAgZFswXSA9IChkWzBdICYgfm1za19sc2hbMF0pIHwgKHMwX2xzaFsw
XSAmIG1za19sc2hbMF0pOwogICAgZFsxXSA9IChkWzFdICYgfm1za19sc2hbMV0pIHwgKHMwX2xz
aFsxXSAmIG1za19sc2hbMV0pOwogIH0KCiAgc3RhdGljIHZvaWQgcnNoYSAodmFsX3QgZFtdLCB2
YWxfdCBzMFtdLCBpbnQgYW1vdW50LCBpbnQgdykgewogICAgc3ZhbF90IGhpID0gczBbMV0gPDwg
KDIqdmFsX25fYml0cygpIC0gdyk7CiAgICBpZiAoYW1vdW50ID49IHZhbF9uX2JpdHMoKSkgewog
ICAgICBkWzBdID0gaGkgPj4gKGFtb3VudCAtIHcgKyB2YWxfbl9iaXRzKCkpOwogICAgICBkWzFd
ID0gaGkgPj4gKHZhbF9uX2JpdHMoKSAtIDEpOwogICAgICBkWzFdID0gZFsxXSA+PiAoMip2YWxf
bl9iaXRzKCkgLSB3KTsKICAgIH0gZWxzZSBpZiAoYW1vdW50ID09IDApIHsKICAgICAgZFswXSA9
IHMwWzBdOwogICAgICBkWzFdID0gczBbMV07CiAgICB9IGVsc2UgewogICAgICBpbnQgcyA9IDIq
dmFsX25fYml0cygpIC0gdyArIGFtb3VudDsKICAgICAgZFswXSA9IHMwWzBdID4+IGFtb3VudDsK
ICAgICAgZFswXSA9IGRbMF0gfCAoKGhpID4+ICgyKnZhbF9uX2JpdHMoKSAtIHcpKSA8PCAodmFs
X25fYml0cygpIC0gYW1vdW50KSk7CiAgICAgIGRbMV0gPSBoaSA+PiAocyA+PSB2YWxfbl9iaXRz
KCkgPyB2YWxfbl9iaXRzKCktMSA6IHMpOwogICAgICBkWzFdID0gZFsxXSAmIG1hc2tfdmFsKHcg
LSB2YWxfbl9iaXRzKCkpOwogICAgfQogIH0KICBzdGF0aWMgdm9pZCByc2ggKHZhbF90IGRbXSwg
dmFsX3QgczBbXSwgaW50IGFtb3VudCkgewogICAgaWYgKGFtb3VudCA+PSB2YWxfbl9iaXRzKCkp
IHsKICAgICAgZFsxXSA9IDA7CiAgICAgIGRbMF0gPSBzMFsxXSA+PiAoYW1vdW50IC0gdmFsX25f
Yml0cygpKTsKICAgIH0gZWxzZSBpZiAoYW1vdW50ID09IDApIHsKICAgICAgZFswXSA9IHMwWzBd
OwogICAgICBkWzFdID0gczBbMV07CiAgICB9IGVsc2UgewogICAgICBkWzFdID0gczBbMV0gPj4g
YW1vdW50OwogICAgICBkWzBdID0gKHMwWzFdIDw8ICh2YWxfbl9iaXRzKCkgLSBhbW91bnQpKSB8
IChzMFswXSA+PiBhbW91bnQpOwogICAgfQogIH0KICBzdGF0aWMgdm9pZCBsc2ggKHZhbF90IGRb
XSwgdmFsX3QgczBbXSwgaW50IGFtb3VudCkgewogICAgaWYgKGFtb3VudCA9PSAwKQogICAgewog
ICAgICBkWzFdID0gczBbMV07CiAgICAgIGRbMF0gPSBzMFswXTsKICAgIH0gZWxzZSBpZiAoYW1v
dW50ID49IHZhbF9uX2JpdHMoKSkgewogICAgICBkWzFdID0gczBbMF0gPDwgKGFtb3VudCAtIHZh
bF9uX2JpdHMoKSk7CiAgICAgIGRbMF0gPSAwOwogICAgfSBlbHNlIHsKICAgICAgZFsxXSA9IChz
MFsxXSA8PCBhbW91bnQpIHwgKHMwWzBdID4+ICh2YWxfbl9iaXRzKCkgLSBhbW91bnQpKTsKICAg
ICAgZFswXSA9IChzMFswXSA8PCBhbW91bnQpOwogICAgfQogIH0KICBzdGF0aWMgdm9pZCBzZXQg
KHZhbF90IGRbXSwgdmFsX3QgczBbXSkgewogICAgZFswXSA9IHMwWzBdOwogICAgZFsxXSA9IHMw
WzFdOwogIH0KICBzdGF0aWMgdm9pZCBsb2cyICh2YWxfdCBkW10sIHZhbF90IHMwW10pIHsKICAg
IHZhbF90IHMwMSA9IHMwWzFdOwogICAgaWYgKHMwMSA+IDApCiAgICAgIGRbMF0gPSBsb2cyXzEo
czAxKSArIHZhbF9uX2JpdHMoKTsKICAgIGVsc2UKICAgICAgZFswXSA9IGxvZzJfMShzMFswXSk7
CiAgICAvLyBkWzBdID0gbG9nMl9uKHMwLCAyKTsKICB9Cn07CnRlbXBsYXRlIDw+CnN0cnVjdCBi
aXRfd29yZF9mdW5zPDM+IHsKICBzdGF0aWMgdm9pZCBmaWxsICh2YWxfdCBkW10sIHZhbF90IHMw
KSB7CiAgICBkWzBdID0gczA7CiAgICBkWzFdID0gczA7CiAgICBkWzJdID0gczA7CiAgfQogIHN0
YXRpYyB2b2lkIGZpbGxfbmIgKHZhbF90IGRbXSwgdmFsX3QgczAsIGludCBuYikgewogICAgZFsw
XSA9IHMwOwogICAgZFsxXSA9IHMwOwogICAgZFsyXSA9IG1hc2tfdmFsKG5iIC0gMip2YWxfbl9i
aXRzKCkpICYgczA7CiAgfQogIHN0YXRpYyB2b2lkIGNvcHkgKHZhbF90IGRbXSwgdmFsX3QgczBb
XSwgaW50IHN3dykgewogICAgZFswXSA9IHMwWzBdOwogICAgZFsxXSA9IHN3dyA+IDEgPyBzMFsx
XSA6IDA7CiAgICBkWzJdID0gc3d3ID4gMiA/IHMwWzJdIDogMDsKICB9CiAgc3RhdGljIHZvaWQg
bWFzayAodmFsX3QgZFtdLCBpbnQgbmIpIHsKICAgIGRbMF0gPSB2YWxfYWxsX29uZXMoKTsKICAg
IGRbMV0gPSB2YWxfYWxsX29uZXMoKTsKICAgIGRbMl0gPSBtYXNrX3ZhbChuYiAtIDIqdmFsX25f
Yml0cygpKTsKICB9CiAgc3RhdGljIHZvaWQgYWRkICh2YWxfdCBkW10sIHZhbF90IHMwW10sIHZh
bF90IHMxW10sIGludCBuYikgewogICAgYWRkX24oZCwgczAsIHMxLCAzLCBuYik7CiAgfQogIHN0
YXRpYyB2b2lkIHN1YiAodmFsX3QgZFtdLCB2YWxfdCBzMFtdLCB2YWxfdCBzMVtdLCBpbnQgbmIp
IHsKICAgIHN1Yl9uKGQsIHMwLCBzMSwgMywgbmIpOwogIH0KICBzdGF0aWMgdm9pZCBuZWcgKHZh
bF90IGRbXSwgdmFsX3QgczBbXSwgaW50IG5iKSB7CiAgICBuZWdfbihkLCBzMCwgMywgbmIpOwog
IH0KICBzdGF0aWMgdm9pZCBtdWwgKHZhbF90IGRbXSwgdmFsX3QgczBbXSwgdmFsX3QgczFbXSwg
aW50IG5iMCwgaW50IG5iMSkgewogICAgbXVsX24oZCwgczAsIHMxLCBuYjAsIG5iMSk7CiAgfQog
IHN0YXRpYyBib29sIGx0dSAodmFsX3QgczBbXSwgdmFsX3QgczFbXSkgewogICAgcmV0dXJuICgo
czBbMl0gPCBzMVsyXSkgfCAoKHMwWzJdID09IHMxWzJdKSAmICgoczBbMV0gPCBzMVsxXSkgfCAo
KHMwWzFdID09IHMxWzFdKSAmIChzMFswXSA8IHMxWzBdKSkpKSk7CiAgfQogIHN0YXRpYyBib29s
IGx0ICh2YWxfdCBzMFtdLCB2YWxfdCBzMVtdLCBpbnQgdykgewogICAgaW50IG1zYl8wID0gKHMw
WzFdID4+ICh3IC0gMip2YWxfbl9iaXRzKCkgLSAxKSkgJiAweDE7CiAgICBpbnQgbXNiXzEgPSAo
czFbMV0gPj4gKHcgLSAyKnZhbF9uX2JpdHMoKSAtIDEpKSAmIDB4MTsKICAgIGludCBjb25kICA9
IG1zYl8wIF4gbXNiXzE7CiAgICByZXR1cm4gKGNvbmQgJiYgbXNiXzApCiAgICAgICAgfHwgKCFj
b25kICYmICgoKHMwWzJdIDwgczFbMl0pIHwgKChzMFsyXSA9PSBzMVsyXSkgJiAoKHMwWzFdIDwg
czFbMV0pIHwgKChzMFsxXSA9PSBzMVsxXSkgJiAoczBbMF0gPCBzMVswXSkpKSkpKSk7CiAgfQog
IHN0YXRpYyBib29sIGx0ZXUgKHZhbF90IHMwW10sIHZhbF90IHMxW10pIHsKICAgIHJldHVybiAo
KHMwWzJdIDwgczFbMl0pIHwgKChzMFsyXSA9PSBzMVsyXSkgJiAoKHMwWzFdIDwgczFbMV0pIHwg
KChzMFsxXSA9PSBzMVsxXSkgJiAoczBbMF0gPD0gczFbMF0pKSkpKTsKICB9CiAgc3RhdGljIGJv
b2wgbHRlICh2YWxfdCBzMFtdLCB2YWxfdCBzMVtdLCBpbnQgdykgewogICAgaW50IG1zYl8wID0g
KHMwWzFdID4+ICh3IC0gMip2YWxfbl9iaXRzKCkgLSAxKSkgJiAweDE7CiAgICBpbnQgbXNiXzEg
PSAoczFbMV0gPj4gKHcgLSAyKnZhbF9uX2JpdHMoKSAtIDEpKSAmIDB4MTsKICAgIGludCBjb25k
ICA9IG1zYl8wIF4gbXNiXzE7CiAgICByZXR1cm4gKGNvbmQgJiYgbXNiXzApCiAgICAgICAgfHwg
KCFjb25kICYmICgoczBbMl0gPCBzMVsyXSkgfCAoKHMwWzJdID09IHMxWzJdKSAmICgoczBbMV0g
PCBzMVsxXSkgfCAoKHMwWzFdID09IHMxWzFdKSAmIChzMFswXSA8PSBzMVswXSkpKSkpKTsKICB9
CiAgc3RhdGljIHZvaWQgYml0X3hvciAodmFsX3QgZFtdLCB2YWxfdCBzMFtdLCB2YWxfdCBzMVtd
KSB7CiAgICBkWzBdID0gKHMwWzBdIF4gczFbMF0pOwogICAgZFsxXSA9IChzMFsxXSBeIHMxWzFd
KTsKICAgIGRbMl0gPSAoczBbMl0gXiBzMVsyXSk7CiAgfQogIHN0YXRpYyB2b2lkIGJpdF9hbmQg
KHZhbF90IGRbXSwgdmFsX3QgczBbXSwgdmFsX3QgczFbXSkgewogICAgZFswXSA9IChzMFswXSAm
IHMxWzBdKTsKICAgIGRbMV0gPSAoczBbMV0gJiBzMVsxXSk7CiAgICBkWzJdID0gKHMwWzJdICYg
czFbMl0pOwogIH0KICBzdGF0aWMgdm9pZCBiaXRfb3IgKHZhbF90IGRbXSwgdmFsX3QgczBbXSwg
dmFsX3QgczFbXSkgewogICAgZFswXSA9IChzMFswXSB8IHMxWzBdKTsKICAgIGRbMV0gPSAoczBb
MV0gfCBzMVsxXSk7CiAgICBkWzJdID0gKHMwWzJdIHwgczFbMl0pOwogIH0KICBzdGF0aWMgdm9p
ZCBiaXRfbmVnICh2YWxfdCBkW10sIHZhbF90IHMwW10sIGludCBuYikgewogICAgZFswXSA9IH5z
MFswXTsKICAgIGRbMV0gPSB+czBbMV07CiAgICBkWzJdID0gfnMwWzJdICYgbWFza192YWwobmIg
LSAyKnZhbF9uX2JpdHMoKSk7CiAgfQogIHN0YXRpYyBib29sIGVxICh2YWxfdCBzMFtdLCB2YWxf
dCBzMVtdKSB7CiAgICByZXR1cm4gKHMwWzBdID09IHMxWzBdKSAmIChzMFsxXSA9PSBzMVsxXSkg
JiAoczBbMl0gPT0gczFbMl0pOwogIH0KICBzdGF0aWMgYm9vbCBuZXEgKHZhbF90IHMwW10sIHZh
bF90IHMxW10pIHsKICAgIHJldHVybiAoczBbMF0gIT0gczFbMF0pIHwgKHMwWzFdICE9IHMxWzFd
KSB8IChzMFsyXSAhPSBzMVsyXSk7CiAgfQogIHN0YXRpYyB2b2lkIGV4dHJhY3QgKHZhbF90IGRb
XSwgdmFsX3QgczBbXSwgaW50IGUsIGludCBzLCBpbnQgbmIpIHsKICAgIHZhbF90IG1za1szXTsK
ICAgIGNvbnN0IGludCBidyA9IGUtcysxOwogICAgbWFza19uKG1zaywgMywgYncpOwogICAgaWYg
KHMgPT0gMCkgewogICAgICBkWzBdID0gczBbMF0gJiBtc2tbMF07CiAgICAgIGRbMV0gPSBzMFsx
XSAmIG1za1sxXTsKICAgICAgZFsyXSA9IHMwWzJdICYgbXNrWzJdOwogICAgfSBlbHNlIHsKICAg
ICAgcnNoKGQsIHMwLCBzKTsKICAgICAgZFswXSA9IGRbMF0gJiBtc2tbMF07CiAgICAgIGRbMV0g
PSBkWzFdICYgbXNrWzFdOwogICAgICBkWzJdID0gZFsyXSAmIG1za1syXTsKICAgIH0KICB9Cgog
IHN0YXRpYyB2b2lkIGluamVjdCAodmFsX3QgZFtdLCB2YWxfdCBzMFtdLCBpbnQgZSwgaW50IHMp
IHsKICAgIGNvbnN0IGludCBidyA9IGUtcysxOwogICAgdmFsX3QgbXNrWzNdOwogICAgdmFsX3Qg
bXNrX2xzaFszXTsKICAgIHZhbF90IHMwX2xzaFszXTsKICAgIG1hc2tfbihtc2ssIDMsIGJ3KTsK
ICAgIGxzaF9uKG1za19sc2gsIG1zaywgcywgMywgMyk7CiAgICBsc2hfbihzMF9sc2gsIHMwLCBz
LCAzLCAzKTsKICAgIGRbMF0gPSAoZFswXSAmIH5tc2tfbHNoWzBdKSB8IChzMF9sc2hbMF0gJiBt
c2tfbHNoWzBdKTsKICAgIGRbMV0gPSAoZFsxXSAmIH5tc2tfbHNoWzFdKSB8IChzMF9sc2hbMV0g
JiBtc2tfbHNoWzFdKTsKICAgIGRbMl0gPSAoZFsyXSAmIH5tc2tfbHNoWzJdKSB8IChzMF9sc2hb
Ml0gJiBtc2tfbHNoWzJdKTsKICB9CgogIHN0YXRpYyB2b2lkIHJzaGEgKHZhbF90IGRbXSwgdmFs
X3QgczBbXSwgaW50IGFtb3VudCwgaW50IHcpIHsKICAgIHJzaGFfbihkLCBzMCwgYW1vdW50LCAz
LCB3KTsKICB9CiAgc3RhdGljIHZvaWQgcnNoICh2YWxfdCBkW10sIHZhbF90IHMwW10sIGludCBh
bW91bnQpIHsKICAgIHJzaF9uKGQsIHMwLCBhbW91bnQsIDMpOwogIH0KICBzdGF0aWMgdm9pZCBs
c2ggKHZhbF90IGRbXSwgdmFsX3QgczBbXSwgaW50IGFtb3VudCkgewogICAgbHNoX24oZCwgczAs
IGFtb3VudCwgMywgMyk7CiAgfQogIHN0YXRpYyB2b2lkIGxvZzIgKHZhbF90IGRbXSwgdmFsX3Qg
czBbXSkgewogICAgZFswXSA9IGxvZzJfbihzMCwgMyk7CiAgfQogIHN0YXRpYyB2b2lkIHNldCAo
dmFsX3QgZFtdLCB2YWxfdCBzMFtdKSB7CiAgICBkWzBdID0gczBbMF07CiAgICBkWzFdID0gczBb
MV07CiAgICBkWzJdID0gczBbMl07CiAgfQp9OwoKc3RhdGljIHZhbF90IF9fcmFuZF92YWwodmFs
X3QqIHNlZWQpIHsKICB2YWxfdCB4ID0gKnNlZWQ7CiAgKnNlZWQgPSAoeCA8PCAxKSBeICgtKHN2
YWxfdCh4KSA8IDApICYgMHgxQik7CiAgcmV0dXJuIHg7Cn0KCnRlbXBsYXRlIDxpbnQgdz4KY2xh
c3MgZGF0X3QgewogcHVibGljOgogIGNvbnN0IHN0YXRpYyBpbnQgbl93b3JkcyA9ICgodyAtIDEp
IC8gNjQpICsgMTsKICAvLyBjb25zdCBzdGF0aWMgaW50IG5fd29yZHMgPSAodyA+PiBDZWlsTG9n
PHNpemVvZih2YWxfdCkqOD46OnYpICsgMTsKICB2YWxfdCB2YWx1ZXNbbl93b3Jkc107CiAgaW5s
aW5lIGludCB3aWR0aCAoIHZvaWQgKSB7IHJldHVybiB3OyB9CiAgaW5saW5lIGludCBuX3dvcmRz
X29mICggdm9pZCApIHsgcmV0dXJuIG5fd29yZHM7IH0KICBpbmxpbmUgYm9vbCB0b19ib29sICgg
dm9pZCApIHsgcmV0dXJuIGxvX3dvcmQoKSAhPSAwOyB9CiAgaW5saW5lIHZhbF90IGxvX3dvcmQg
KCB2b2lkICkgeyByZXR1cm4gdmFsdWVzWzBdOyB9CiAgaW5saW5lIHVuc2lnbmVkIGxvbmcgdG9f
dWxvbmcgKCB2b2lkICkgeyByZXR1cm4gKHVuc2lnbmVkIGxvbmcpbG9fd29yZCgpOyB9CgogIHN0
ZDo6c3RyaW5nIHRvX3N0ciAoKSB7CiAgICBzdGQ6OnN0cmluZyBycmVzLCByZXM7CiAgICBpbnQg
bm4gPSAoaW50KWNlaWxmKHcgLyA0LjApOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuX3dvcmRz
OyBpKyspIHsKICAgICAgaW50IG5fbmlicyA9IG5uIDwgdmFsX25fbmlicygpID8gbm4gOiB2YWxf
bl9uaWJzKCk7CiAgICAgIGZvciAoaW50IGogPSAwOyBqIDwgbl9uaWJzOyBqKyspIHsKICAgICAg
ICB1aW50OF90IG5pYiA9ICh2YWx1ZXNbaV0gPj4gKGoqNCkpJjB4ZjsKICAgICAgICBycmVzLnB1
c2hfYmFjayhoZXhfZGlnc1tuaWJdKTsKICAgICAgfQogICAgICBubiAtPSB2YWxfbl9iaXRzKCkv
NDsKICAgIH0KICAgIHJlcy5wdXNoX2JhY2soJzAnKTsKICAgIHJlcy5wdXNoX2JhY2soJ3gnKTsK
ICAgIGZvciAoaW50IGkgPSAwOyBpIDwgcnJlcy5zaXplKCk7IGkrKykKICAgICAgcmVzLnB1c2hf
YmFjayhycmVzW3JyZXMuc2l6ZSgpLWktMV0pOwogICAgcmV0dXJuIHJlczsKICB9CiAgdm9pZCBy
YW5kb21pemUodmFsX3QqIHNlZWQpIHsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgbl93b3Jkczsg
aSsrKQogICAgICB2YWx1ZXNbaV0gPSBfX3JhbmRfdmFsKHNlZWQpOwogICAgaWYgKHZhbF9uX3dv
cmRfYml0cyh3KSkKICAgICAgdmFsdWVzW25fd29yZHMtMV0gJj0gbWFza192YWwodmFsX25fd29y
ZF9iaXRzKHcpKTsKICB9CiAgaW5saW5lIGRhdF90PHc+ICgpIHsKICB9CiAgdGVtcGxhdGUgPGlu
dCBzdz4KICBpbmxpbmUgZGF0X3Q8dz4gKGNvbnN0IGRhdF90PHN3PiYgc3JjKSB7CiAgICBiaXRf
d29yZF9mdW5zPG5fd29yZHM+Ojpjb3B5KHZhbHVlcywgKHZhbF90KilzcmMudmFsdWVzLCBzcmMu
bl93b3Jkcyk7CiAgICBpZiAoc3cgIT0gdyAmJiB2YWxfbl93b3JkX2JpdHModykpCiAgICAgIHZh
bHVlc1tuX3dvcmRzLTFdICY9IG1hc2tfdmFsKHZhbF9uX3dvcmRfYml0cyh3KSk7CiAgfQogIGlu
bGluZSBkYXRfdDx3PiAoY29uc3QgZGF0X3Q8dz4mIHNyYykgewogICAgYml0X3dvcmRfZnVuczxu
X3dvcmRzPjo6c2V0KHZhbHVlcywgKHZhbF90KilzcmMudmFsdWVzKTsKICB9CiAgc3RhdGljIGlu
bGluZSBkYXRfdDx3PiBmcm9tX3ZhbHModmFsX3QgdmFsW25fd29yZHNdKSB7CiAgICBkYXRfdDx3
PiByZXM7CiAgICBmb3IgKGludCBpID0gMDsgaSA8IG5fd29yZHM7IGkrKykKICAgICAgcmVzLnZh
bHVlc1tpXSA9IHZhbFtpXTsKICAgIHJldHVybiByZXM7CiAgfQogIGlubGluZSBkYXRfdDx3PiAo
dmFsX3QgdmFsKSB7CiAgICB2YWx1ZXNbMF0gPSB2YWw7CiAgICBmb3IgKGludCBpID0gMTsgaSA8
IG5fd29yZHM7IGkrKykKICAgICAgdmFsdWVzW2ldID0gMDsKICB9CiAgdGVtcGxhdGUgPGludCBz
dz4KICBkYXRfdDx3PiBtYXNrKGRhdF90PHN3PiBmaWxsLCBpbnQgbikgewogICAgZGF0X3Q8dz4g
cmVzOwogICAgYml0X3dvcmRfZnVuczxuX3dvcmRzPjo6bWFzayhyZXMudmFsdWVzLCBuKTsKICAg
IHJldHVybiByZXM7CiAgfQogIHRlbXBsYXRlIDxpbnQgZHc+CiAgZGF0X3Q8ZHc+IG1hc2soaW50
IG4pIHsKICAgIGRhdF90PGR3PiByZXM7CiAgICByZXR1cm4gcmVzLm1hc2soKnRoaXMsIG4pOwog
IH0KICB0ZW1wbGF0ZSA8aW50IG4+CiAgaW5saW5lIGRhdF90PG4+IG1hc2sodm9pZCkgewogICAg
ZGF0X3Q8bj4gcmVzID0gbWFzazxuPihuKTsKICAgIHJldHVybiByZXM7CiAgfQogIHZhbF90IG9w
ZXJhdG9yIFtdIChzaXplX3QgaSkgewogICAgICByZXR1cm4gdmFsdWVzW2ldOwogIH0KICBkYXRf
dDx3PiBvcGVyYXRvciArICggZGF0X3Q8dz4gbyApIHsKICAgIGRhdF90PHc+IHJlczsKICAgIGJp
dF93b3JkX2Z1bnM8bl93b3Jkcz46OmFkZChyZXMudmFsdWVzLCB2YWx1ZXMsIG8udmFsdWVzLCB3
KTsKICAgIHJldHVybiByZXM7CiAgfQogIGRhdF90PHc+IG9wZXJhdG9yIC0gKCBkYXRfdDx3PiBv
ICkgewogICAgZGF0X3Q8dz4gcmVzOwogICAgYml0X3dvcmRfZnVuczxuX3dvcmRzPjo6c3ViKHJl
cy52YWx1ZXMsIHZhbHVlcywgby52YWx1ZXMsIHcpOwogICAgcmV0dXJuIHJlczsKICB9CiAgZGF0
X3Q8dz4gb3BlcmF0b3IgLSAoICkgewogICAgcmV0dXJuIH4oKnRoaXMpICsgREFUPHc+KDEpOwog
IH0KICB0ZW1wbGF0ZSA8aW50IHcyPgogIGRhdF90PHcrdzI+IG9wZXJhdG9yICogKCBkYXRfdDx3
Mj4gbyApIHsKICAgIGRhdF90PHcrdzI+IHJlczsKICAgIGJpdF93b3JkX2Z1bnM8dmFsX25fd29y
ZHModyt3Mik+OjptdWwocmVzLnZhbHVlcywgdmFsdWVzLCBvLnZhbHVlcywgdywgdzIpOwogICAg
cmV0dXJuIHJlczsKICB9CiAgdGVtcGxhdGUgPGludCB3Mj4KICBkYXRfdDx3K3cyPiBmaXhfdGlt
ZXNfZml4KCBkYXRfdDx3Mj4gbyApIHsKICAgIGlmICh3K3cyIDw9IHZhbF9uX2JpdHMoKSkgewog
ICAgICBzdmFsX3QgYSA9IHN2YWxfdCh2YWx1ZXNbMF0gPDwgKHZhbF9uX2JpdHMoKS13KSkgPj4g
KHZhbF9uX2JpdHMoKS13KTsKICAgICAgc3ZhbF90IGIgPSBzdmFsX3Qoby52YWx1ZXNbMF0gPDwg
KHZhbF9uX2JpdHMoKS13MikpID4+ICh2YWxfbl9iaXRzKCktdzIpOwogICAgICByZXR1cm4gZGF0
X3Q8dyt3Mj4oKGEgKiBiKSAmIG1hc2tfdmFsKHcrdzIpKTsKICAgIH0gZWxzZSB7CiAgICAgIHZh
bF90IHNnbl9hID0gbXNiKCk7CiAgICAgIGRhdF90PHc+IGFic19hID0gc2duX2EgPyAtKCp0aGlz
KSA6ICgqdGhpcyk7CiAgICAgIHZhbF90IHNnbl9iID0gby5tc2IoKTsKICAgICAgZGF0X3Q8dzI+
IGFic19iID0gc2duX2IgPyAtbyA6IG87CiAgICAgIGRhdF90PHcrdzI+IHJlcyA9IGFic19hICog
YWJzX2I7CiAgICAgIHJldHVybiAoc2duX2EgXiBzZ25fYikgPyAtcmVzIDogcmVzOwogICAgfQog
IH0KICBkYXRfdDx3PiBvcGVyYXRvciAvICggZGF0X3Q8dz4gbyApIHsKICAgIGRhdF90PHc+IHJl
cygwKTsKICAgIGlmIChvID09IDApIHsKICAgICAgcmVzLmZpbGxfYml0KDEpOwogICAgfSBlbHNl
IGlmIChuX3dvcmRzID09IDEpIHsKICAgICAgcmVzLnZhbHVlc1swXSA9IHZhbHVlc1swXSAvIG8u
dmFsdWVzWzBdOwogICAgfSBlbHNlIHsKICAgICAgZGF0X3Q8Mip3PiBwID0gKnRoaXMsIGQgPSBv
OwogICAgICBkID0gZCA8PCB3OwoKICAgICAgZm9yIChpbnQgaSA9IHctMTsgaSA+PSAwOyBpLS0p
IHsKICAgICAgICBwID0gcCA8PCAxOwogICAgICAgIGlmIChwID49IGQpIHsKICAgICAgICAgIHAg
PSBwIC0gZDsKICAgICAgICAgIHJlcy52YWx1ZXNbaSAvIHZhbF9uX2JpdHMoKV0gfD0gdmFsX3Qo
MSkgPDwgKGkgJSB2YWxfbl9iaXRzKCkpOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0
dXJuIHJlczsKICB9CiAgZGF0X3Q8dz4gb3BlcmF0b3IgJSAoIGRhdF90PHc+IG8gKSB7CiAgICBy
ZXR1cm4gKnRoaXMgLSAqdGhpcyAvIG8gKiBvOwogIH0KICBkYXRfdDx3K3c+IHVmaXhfdGltZXNf
Zml4KCBkYXRfdDx3PiBvICkgewogICAgcmV0dXJuIG8uZml4X3RpbWVzX3VmaXgoKnRoaXMpOwog
IH0KICB0ZW1wbGF0ZTxpbnQgdzI+CiAgZGF0X3Q8dyt3Mj4gZml4X3RpbWVzX3VmaXgoIGRhdF90
PHcyPiBvICkgewogICAgaWYgKHcrdzIgPD0gdmFsX25fYml0cygpKSB7CiAgICAgIHN2YWxfdCBh
ID0gc3ZhbF90KHZhbHVlc1swXSA8PCAodmFsX25fYml0cygpLXcpKSA+PiAodmFsX25fYml0cygp
LXcpOwogICAgICByZXR1cm4gZGF0X3Q8dyt3Mj4oKGEgKiBvLnZhbHVlc1swXSkgJiBtYXNrX3Zh
bCh3K3cyKSk7CiAgICB9IGVsc2UgewogICAgICB2YWxfdCBzZ25fYSA9IG1zYigpOwogICAgICBk
YXRfdDx3PiBhYnNfYSA9IHNnbl9hID8gLSgqdGhpcykgOiAoKnRoaXMpOwogICAgICBkYXRfdDx3
K3cyPiByZXMgPSBhYnNfYSAqIG87CiAgICAgIHJldHVybiBzZ25fYSA/IC1yZXMgOiByZXM7CiAg
ICB9CiAgfQogIGlubGluZSBib29sIG9wZXJhdG9yIDwgKCBkYXRfdDx3PiBvICkgewogICAgcmV0
dXJuIGJpdF93b3JkX2Z1bnM8bl93b3Jkcz46Omx0dSh2YWx1ZXMsIG8udmFsdWVzKTsKICB9CiAg
aW5saW5lIGJvb2wgb3BlcmF0b3IgPD0gKCBkYXRfdDx3PiBvICkgewogICAgcmV0dXJuIGJpdF93
b3JkX2Z1bnM8bl93b3Jkcz46Omx0ZXUodmFsdWVzLCBvLnZhbHVlcyk7CiAgfQogIGlubGluZSBi
b29sIG9wZXJhdG9yID4gKCBkYXRfdDx3PiBvICkgewogICAgcmV0dXJuIG8gPCAqdGhpczsKICB9
CiAgaW5saW5lIGJvb2wgb3BlcmF0b3IgPj0gKCBkYXRfdDx3PiBvICkgewogICAgcmV0dXJuIG8g
PD0gKnRoaXM7CiAgfQogIGlubGluZSBib29sIGx0ICggZGF0X3Q8dz4gbyApIHsKICAgIHJldHVy
biBiaXRfd29yZF9mdW5zPG5fd29yZHM+OjpsdCh2YWx1ZXMsIG8udmFsdWVzLCB3KTsKICB9CiAg
aW5saW5lIGJvb2wgbHRlICggZGF0X3Q8dz4gbyApIHsKICAgIHJldHVybiBiaXRfd29yZF9mdW5z
PG5fd29yZHM+OjpsdGUodmFsdWVzLCBvLnZhbHVlcywgdyk7CiAgfQogIGlubGluZSBib29sIGd0
ICggZGF0X3Q8dz4gbyApIHsKICAgIHJldHVybiBvLmx0KCp0aGlzKTsKICB9CiAgaW5saW5lIGJv
b2wgZ3RlICggZGF0X3Q8dz4gbyApIHsKICAgIHJldHVybiBvLmx0ZSgqdGhpcyk7CiAgfQogIGRh
dF90PHc+IG9wZXJhdG9yIF4gKCBkYXRfdDx3PiBvICkgewogICAgZGF0X3Q8dz4gcmVzOwogICAg
Yml0X3dvcmRfZnVuczxuX3dvcmRzPjo6Yml0X3hvcihyZXMudmFsdWVzLCB2YWx1ZXMsIG8udmFs
dWVzKTsKICAgIHJldHVybiByZXM7CiAgfQogIGRhdF90PHc+IG9wZXJhdG9yICYgKCBkYXRfdDx3
PiBvICkgewogICAgZGF0X3Q8dz4gcmVzOwogICAgYml0X3dvcmRfZnVuczxuX3dvcmRzPjo6Yml0
X2FuZChyZXMudmFsdWVzLCB2YWx1ZXMsIG8udmFsdWVzKTsKICAgIHJldHVybiByZXM7CiAgfQog
IGRhdF90PHc+IG9wZXJhdG9yIHwgKCBkYXRfdDx3PiBvICkgewogICAgZGF0X3Q8dz4gcmVzOwog
ICAgYml0X3dvcmRfZnVuczxuX3dvcmRzPjo6Yml0X29yKHJlcy52YWx1ZXMsIHZhbHVlcywgby52
YWx1ZXMpOwogICAgcmV0dXJuIHJlczsKICB9CiAgZGF0X3Q8dz4gb3BlcmF0b3IgfiAoIHZvaWQg
KSB7CiAgICBkYXRfdDx3PiByZXM7CiAgICBiaXRfd29yZF9mdW5zPG5fd29yZHM+OjpiaXRfbmVn
KHJlcy52YWx1ZXMsIHZhbHVlcywgdyk7CiAgICByZXR1cm4gcmVzOwogIH0KICBpbmxpbmUgZGF0
X3Q8MT4gb3BlcmF0b3IgISAoIHZvaWQgKSB7CiAgICByZXR1cm4gREFUPDE+KCFsb193b3JkKCkp
OwogIH0KICBkYXRfdDwxPiBvcGVyYXRvciAmJiAoIGRhdF90PDE+IG8gKSB7CiAgICByZXR1cm4g
REFUPDE+KGxvX3dvcmQoKSAmIG8ubG9fd29yZCgpKTsKICB9CiAgZGF0X3Q8MT4gb3BlcmF0b3Ig
fHwgKCBkYXRfdDwxPiBvICkgewogICAgcmV0dXJuIERBVDwxPihsb193b3JkKCkgfCBvLmxvX3dv
cmQoKSk7CiAgfQogIGJvb2wgb3BlcmF0b3IgPT0gKCBkYXRfdDx3PiBvICkgewogICAgcmV0dXJu
IGJpdF93b3JkX2Z1bnM8bl93b3Jkcz46OmVxKHZhbHVlcywgby52YWx1ZXMpOwogIH0KICBib29s
IG9wZXJhdG9yID09ICggZGF0el90PHc+IG8gKSB7CiAgICByZXR1cm4gbyA9PSAqdGhpczsKICB9
CiAgYm9vbCBvcGVyYXRvciAhPSAoIGRhdF90PHc+IG8gKSB7CiAgICByZXR1cm4gYml0X3dvcmRf
ZnVuczxuX3dvcmRzPjo6bmVxKHZhbHVlcywgby52YWx1ZXMpOwogIH0KICBkYXRfdDx3PiBvcGVy
YXRvciA8PCAoIGludCBhbW91bnQgKSB7CiAgICBkYXRfdDx3PiByZXM7CiAgICBiaXRfd29yZF9m
dW5zPG5fd29yZHM+Ojpsc2gocmVzLnZhbHVlcywgdmFsdWVzLCBhbW91bnQpOwogICAgaWYgKHZh
bF9uX3dvcmRfYml0cyh3KSkKICAgICAgcmVzLnZhbHVlc1tuX3dvcmRzLTFdICY9IG1hc2tfdmFs
KHZhbF9uX3dvcmRfYml0cyh3KSk7CiAgICByZXR1cm4gcmVzOwogIH0KICBpbmxpbmUgZGF0X3Q8
dz4gb3BlcmF0b3IgPDwgKCBkYXRfdDx3PiBvICkgewogICAgcmV0dXJuICp0aGlzIDw8IG8ubG9f
d29yZCgpOwogIH0KICBkYXRfdDx3PiBvcGVyYXRvciA+PiAoIGludCBhbW91bnQgKSB7CiAgICBk
YXRfdDx3PiByZXM7CiAgICBiaXRfd29yZF9mdW5zPG5fd29yZHM+Ojpyc2gocmVzLnZhbHVlcywg
dmFsdWVzLCBhbW91bnQpOwogICAgcmV0dXJuIHJlczsKICB9CiAgaW5saW5lIGRhdF90PHc+IG9w
ZXJhdG9yID4+ICggZGF0X3Q8dz4gbyApIHsKICAgIHJldHVybiAqdGhpcyA+PiBvLmxvX3dvcmQo
KTsKICB9CiAgZGF0X3Q8dz4gcnNoYSAoIGRhdF90PHc+IG8pIHsKICAgIGRhdF90PHc+IHJlczsK
ICAgIGludCBhbW91bnQgPSBvLmxvX3dvcmQoKTsKICAgIGJpdF93b3JkX2Z1bnM8bl93b3Jkcz46
OnJzaGEocmVzLnZhbHVlcywgdmFsdWVzLCBhbW91bnQsIHcpOwogICAgcmV0dXJuIHJlczsKICB9
CiAgZGF0X3Q8dz4mIG9wZXJhdG9yID0gKCBkYXRfdDx3PiBvICkgewogICAgYml0X3dvcmRfZnVu
czxuX3dvcmRzPjo6c2V0KHZhbHVlcywgby52YWx1ZXMpOwogICAgcmV0dXJuICp0aGlzOwogIH0K
ICBkYXRfdDx3PiBmaWxsX2JpdCggdmFsX3QgYml0ICkgewogICAgZGF0X3Q8dz4gcmVzOwogICAg
dmFsX3Qgd29yZCA9IDBMIC0gYml0OwogICAgYml0X3dvcmRfZnVuczxuX3dvcmRzPjo6ZmlsbF9u
YihyZXMudmFsdWVzLCB3b3JkLCB3KTsKICAgIHJldHVybiByZXM7CiAgfQogIC8vIFRPRE86IFNQ
RUVEIFRISVMgVVAKICBkYXRfdDx3PiBmaWxsX2J5dGUoIHZhbF90IGJ5dGUsIGludCBuYiwgaW50
IG4gKSB7CiAgICBkYXRfdDx3PiByZXM7CiAgICBiaXRfd29yZF9mdW5zPG5fd29yZHM+OjpmaWxs
KHJlcy52YWx1ZXMsIDBMKTsKICAgIGZvciAoc2l6ZV90IGkgPSAwOyBpIDwgbjsgaSsrKQogICAg
ICByZXMgPSAocmVzIDw8IG5iKSB8IGJ5dGU7CiAgICByZXR1cm4gcmVzOwogIH0KICB0ZW1wbGF0
ZSA8aW50IGR3LCBpbnQgbj4KICBkYXRfdDxkdz4gZmlsbCggdm9pZCApIHsKICAgIC8vIFRPRE86
IEdFVCBSSUQgT0YgSUYnUwogICAgZGF0X3Q8ZHc+IHJlczsKICAgIGlmICh3ID09IDEpIHsKICAg
ICAgcmV0dXJuIHJlcy5maWxsX2JpdChsb193b3JkKCkpOwogICAgfSBlbHNlIHsKICAgICAgcmV0
dXJuIHJlcy5maWxsX2J5dGUobG9fd29yZCgpLCB3LCBuKTsKICAgIH0KICB9CiAgdGVtcGxhdGUg
PGludCBkdywgaW50IG53PgogIGRhdF90PGR3PiBmaWxsKCBkYXRfdDxudz4gbiApIHsKICAgIC8v
IFRPRE86IEdFVCBSSUQgT0YgSUYnUwogICAgZGF0X3Q8ZHc+IHJlczsKICAgIGlmICh3ID09IDEp
IHsKICAgICAgcmV0dXJuIHJlcy5maWxsX2JpdChsb193b3JkKCkmMSk7CiAgICB9IGVsc2Ugewog
ICAgICByZXR1cm4gcmVzLmZpbGxfYnl0ZShsb193b3JkKCksIHcsIG4pOwogICAgfQogIH0KICB0
ZW1wbGF0ZSA8aW50IGR3PgogIGRhdF90PGR3PiBleHRyYWN0KCkgewogICAgZGF0X3Q8ZHc+IHJl
czsKICAgIGludCBpOwogICAgZm9yIChpID0gMDsgaSA8IHZhbF9uX2Z1bGxfd29yZHMoZHcpOyBp
KyspCiAgICAgIHJlcy52YWx1ZXNbaV0gPSB2YWx1ZXNbaV07CiAgICBpZiAodmFsX25fd29yZF9i
aXRzKGR3KSkKICAgICAgcmVzLnZhbHVlc1tpXSA9IHZhbHVlc1tpXSAmIG1hc2tfdmFsKHZhbF9u
X3dvcmRfYml0cyhkdykpOwogICAgcmV0dXJuIHJlczsKICB9CiAgdGVtcGxhdGUgPGludCBkdz4K
ICBkYXRfdDxkdz4gZXh0cmFjdCh2YWxfdCBlLCB2YWxfdCBzKSB7CiAgICBkYXRfdDx3PiB4ID0g
KCp0aGlzID4+IHMpOwogICAgcmV0dXJuIHguZXh0cmFjdDxkdz4oKTsKICB9CiAgdGVtcGxhdGUg
PGludCBkdywgaW50IGl3ZSwgaW50IGl3cz4KICBpbmxpbmUgZGF0X3Q8ZHc+IGV4dHJhY3QoZGF0
X3Q8aXdlPiBlLCBkYXRfdDxpd3M+IHMpIHsKICAgIHJldHVybiBleHRyYWN0PGR3PihlLmxvX3dv
cmQoKSwgcy5sb193b3JkKCkpOwogIH0KCiAgdGVtcGxhdGUgPGludCBzdz4KICBkYXRfdDx3PiBp
bmplY3QoZGF0X3Q8c3c+IHNyYywgdmFsX3QgZSwgdmFsX3QgcykgewogICAgLy8gTW9kaWZ5IHRo
aXMudmFsdWVzIGluIHBsYWNlLgogICAgZGF0X3Q8dz4gaW5qZWN0X3NyYyhzcmMpOyAvLyBFbmxh
cmdlZCBpZiBuZWVkZWQgdG8gbWF0Y2ggaW5qZWN0X2RzdAogICAgYml0X3dvcmRfZnVuczxuX3dv
cmRzPjo6aW5qZWN0KHZhbHVlcywgaW5qZWN0X3NyYy52YWx1ZXMsIGUsIHMpOwogICAgcmV0dXJu
ICp0aGlzOwogIH0KCiAgdGVtcGxhdGUgPGludCBzdywgaW50IGl3ZSwgaW50IGl3cz4KICBpbmxp
bmUgZGF0X3Q8dz4gaW5qZWN0KGRhdF90PHN3PiBzcmMsIGRhdF90PGl3ZT4gZSwgZGF0X3Q8aXdz
PiBzKSB7CiAgICByZXR1cm4gaW5qZWN0PHc+KHNyYywgZS5sb193b3JkKCksIHMubG9fd29yZCgp
KTsKICB9CgoKICB0ZW1wbGF0ZSA8aW50IGR3PgogIGlubGluZSBkYXRfdDxkdz4gbG9nMigpIHsK
ICAgIGRhdF90PGR3PiByZXM7CiAgICBiaXRfd29yZF9mdW5zPG5fd29yZHM+Ojpsb2cyKHJlcy52
YWx1ZXMsIHZhbHVlcyk7CiAgICByZXR1cm4gcmVzOwogIH0KICBpbmxpbmUgdmFsX3QgYml0KHZh
bF90IGIpIHsKICAgIHJldHVybiAodmFsdWVzW3ZhbF9uX2Z1bGxfd29yZHMoYildID4+IHZhbF9u
X3dvcmRfYml0cyhiKSkgJiAxOwogIH0KICBpbmxpbmUgdmFsX3QgbXNiKCkgewogICAgcmV0dXJu
IHZhbHVlc1tuX3dvcmRzLTFdID4+IHZhbF9uX3dvcmRfYml0cyh3LTEpOwogIH0KICB0ZW1wbGF0
ZSA8aW50IGl3PgogIGlubGluZSBkYXRfdDwxPiBiaXQoZGF0X3Q8aXc+IGIpIHsKICAgIHJldHVy
biBiaXQoYi5sb193b3JkKCkpOwogIH0KfTsKCnRlbXBsYXRlIDxpbnQgdz4Kc3RkOjpzdHJpbmcg
ZGF0X3RvX3N0cihjb25zdCBkYXRfdDx3PiYgeCkgewogIGNoYXIgc1t3XTsKICBzW2RhdF90b19z
dHIocywgeCldID0gMDsKICByZXR1cm4gczsKfQoKc3RhdGljIF9faW5saW5lX18gaW50IG5fZGln
aXRzKGludCB3LCBpbnQgYmFzZSkgewogIHJldHVybiAoaW50KWNlaWwobG9nKDIpL2xvZyhiYXNl
KSp3KTsKfQoKdGVtcGxhdGUgPGludCB3PgppbnQgZGF0X3RvX3N0cihjaGFyKiBzLCBkYXRfdDx3
PiB4LCBpbnQgYmFzZSA9IDE2LCBjaGFyIHBhZCA9ICcwJykgewogIGludCBuX2RpZ3MgPSBuX2Rp
Z2l0cyh3LCBiYXNlKTsKICBpbnQgaiA9IG5fZGlncy0xLCBkaWdpdDsKCiAgZG8gewogICAgaWYg
KGlzcG93MihiYXNlKSkgewogICAgICBkaWdpdCA9IHgubG9fd29yZCgpICYgKGJhc2UtMSk7CiAg
ICAgIHggPSB4ID4+IGxvZzJfMShiYXNlKTsKICAgIH0gZWxzZSB7CiAgICAgIGRpZ2l0ID0gKHgg
JSBiYXNlKS5sb193b3JkKCk7CiAgICAgIHggPSB4IC8gYmFzZTsKICAgIH0KICAgIHNbal0gPSAo
ZGlnaXQgPj0gMTAgPyAnYSctMTAgOiAnMCcpICsgZGlnaXQ7CiAgfSB3aGlsZSAoLS1qID49IDAg
JiYgeCAhPSAwKTsKCiAgZm9yICggOyBqID49IDA7IGotLSkKICAgIHNbal0gPSBwYWQ7CgogIHJl
dHVybiBuX2RpZ3M7Cn0KCnN0YXRpYyBfX2lubGluZV9fIGludCBkYXRfdG9fc3RyKGNoYXIqIHMs
IHZhbF90IHgsIGludCBiYXNlID0gMTYsIGNoYXIgcGFkID0gJzAnKSB7CiAgcmV0dXJuIGRhdF90
b19zdHI8c2l6ZW9mKHZhbF90KSo4PihzLCBkYXRfdDxzaXplb2YodmFsX3QpKjg+KHgpLCBiYXNl
LCBwYWQpOwp9Cgp0ZW1wbGF0ZSA8aW50IHc+CmludCBmaXhfdG9fc3RyKGNoYXIqIHMsIGRhdF90
PHc+IHgsIGludCBiYXNlID0gMTYsIGNoYXIgcGFkID0gJzAnKSB7CiAgYm9vbCBuZWcgPSB4Lm1z
YigpOwogIHNbMF0gPSBuZWc7CiAgaW50IGxlbiA9IGRhdF90b19zdHI8dz4ocysxLCBuZWcgPyAt
eCA6IHgsIGJhc2UsIHBhZCk7CiAgcmV0dXJuIGxlbisxOwp9CgpzdGF0aWMgX19pbmxpbmVfXyBp
bnQgZmxvX2RpZ2l0cyhpbnQgbSwgaW50IGUpIHsKICByZXR1cm4gMiArIG5fZGlnaXRzKG0sIDEw
KSArIDIgKyBuX2RpZ2l0cyhlLCAxMCk7Cn0KCnRlbXBsYXRlIDxpbnQgdz4KaW50IGZsb190b19z
dHIoY2hhciogcywgZGF0X3Q8dz4geCwgY2hhciBwYWQgPSAnICcpIHsKICBjaGFyIGJ1ZlsxMDAw
XTsKICBpbnQgbl9kaWdzID0gKHcgPT0gMzIpID8gZmxvX2RpZ2l0cygzMiwgOCkgOiBmbG9fZGln
aXRzKDUyLCAxMSk7CiAgZG91YmxlIHZhbCA9ICh3ID09IDMyKSA/IHRvRmxvYXQoeC52YWx1ZXNb
MF0pIDogdG9Eb3VibGUoeC52YWx1ZXNbMF0pOwogIC8vIHNwcmludGYoYnVmLCAiJWQgJWQlKmUi
LCB3LCBuX2RpZ3MsIG5fZGlncywgdmFsKTsKICBzcHJpbnRmKGJ1ZiwgIiUqZSIsIG5fZGlncywg
dmFsKTsKICBhc3NlcnQoc3RybGVuKGJ1ZikgPD0gbl9kaWdzKTsKICBmb3IgKGludCBpID0gMDsg
aSA8IG5fZGlnczsgaSsrKQogICAgc1tpXSA9IChpIDwgc3RybGVuKGJ1ZikpID8gYnVmW2ldIDog
cGFkOwogIHNbbl9kaWdzXSA9IDA7CiAgLy8gcHJpbnRmKCJOLURJR1MgPSAlZCBCVUYgJWx1IFBB
RCAlbHVcbiIsIG5fZGlncywgc3RybGVuKGJ1ZiksIG5fZGlncy1zdHJsZW4oYnVmKSk7CiAgLy8g
cmV0dXJuIHN0cmxlbihidWYpOwogIHJldHVybiBuX2RpZ3M7Cn0KCnRlbXBsYXRlIDxpbnQgdz4K
aW50IGRhdF9hc19zdHIoY2hhciogcywgY29uc3QgZGF0X3Q8dz4mIHgpIHsKICBpbnQgaSwgajsK
ICBmb3IgKGkgPSAwLCBqID0gKHcvOC0xKSo4OyBpIDwgdy84OyBpKyssIGogLT0gOCkgewogICAg
Y2hhciBjaCA9IHgudmFsdWVzW2ovdmFsX25fYml0cygpXSA+PiAoaiAlIHZhbF9uX2JpdHMoKSk7
CiAgICBpZiAoY2ggPT0gMCkgYnJlYWs7CiAgICBzW2ldID0gY2g7CiAgfQogIGZvciAoIDsgaSA8
IHcvODsgaSsrKQogICAgc1tpXSA9ICcgJzsKICByZXR1cm4gdy84Owp9CgpzdGF0aWMgX19pbmxp
bmVfXyBpbnQgZGF0X2FzX3N0cihjaGFyKiBzLCB2YWxfdCB4KSB7CiAgcmV0dXJuIGRhdF9hc19z
dHIocywgZGF0X3Q8c2l6ZW9mKHZhbF90KSo4Pih4KSk7Cn0KCiNpZiBfX2NwbHVzcGx1cyA+PSAy
MDExMDNMCnN0YXRpYyB2b2lkIF9fYXR0cmlidXRlX18oKHVudXNlZCkpIGRhdF9mb3JtYXQoY2hh
ciogcywgY29uc3QgY2hhciogZm10KQp7CiAgZm9yIChjaGFyIGM7IChjID0gKmZtdCk7IGZtdCsr
KSB7CiAgICBpZiAoYyA9PSAnJScgJiYgKisrZm10ICE9ICclJykKICAgICAgYWJvcnQoKTsKICAg
ICpzKysgPSBjOwogIH0KfQoKdGVtcGxhdGUgPHR5cGVuYW1lIFQsIHR5cGVuYW1lLi4uIEFyZ3M+
CnN0YXRpYyB2b2lkIGRhdF9mb3JtYXQoY2hhciogcywgY29uc3QgY2hhciogZm10LCBUIHZhbHVl
LCBBcmdzLi4uIGFyZ3MpCnsKICB3aGlsZSAoKmZtdCkgewogICAgaWYgKCpmbXQgPT0gJyUnKSB7
CiAgICAgIHN3aXRjaChmbXRbMV0pIHsKICAgICAgICBjYXNlICdlJzogcyArPSBmbG9fdG9fc3Ry
KHMsIHZhbHVlLCAnICcpOyBicmVhazsKICAgICAgICBjYXNlICdoJzogcyArPSBkYXRfdG9fc3Ry
KHMsIHZhbHVlLCAxNiwgJzAnKTsgYnJlYWs7CiAgICAgICAgY2FzZSAnYic6IHMgKz0gZGF0X3Rv
X3N0cihzLCB2YWx1ZSwgMiwgJzAnKTsgYnJlYWs7CiAgICAgICAgY2FzZSAnZCc6IHMgKz0gZGF0
X3RvX3N0cihzLCB2YWx1ZSwgMTAsICcgJyk7IGJyZWFrOwogICAgICAgIGNhc2UgJ3MnOiBzICs9
IGRhdF9hc19zdHIocywgdmFsdWUpOyBicmVhazsKICAgICAgICBjYXNlICclJzogKnMrKyA9ICcl
JzsgYnJlYWs7CiAgICAgICAgZGVmYXVsdDogYWJvcnQoKTsKICAgICAgfQogICAgICByZXR1cm4g
ZGF0X2Zvcm1hdChzLCBmbXQgKyAyLCBhcmdzLi4uKTsKICAgIH0gZWxzZSB7CiAgICAgICpzKysg
PSAqZm10Kys7CiAgICB9CiAgfQogIGFib3J0KCk7Cn0KCnRlbXBsYXRlIDxpbnQgdywgdHlwZW5h
bWUuLi4gQXJncz4Kc3RhdGljIGRhdF90PHc+IGRhdF9mb3JtYXQoY29uc3QgY2hhciogZm10LCBB
cmdzLi4uIGFyZ3MpCnsKI2lmIEJZVEVfT1JERVIgIT0gTElUVExFX0VORElBTgojIGVycm9yIGRh
dF9mb3JtYXQgYXNzdW1lcyBhIGxpdHRsZS1lbmRpYW4gYXJjaGl0ZWN0dXJlCiNlbmRpZgogIGNo
YXIgc3RyW3cvOCsxXTsKICBkYXRfZm9ybWF0KHN0ciwgZm10LCBhcmdzLi4uKTsKCiAgZGF0X3Q8
dz4gcmVzOwogIHJlcy52YWx1ZXNbcmVzLm5fd29yZHMtMV0gPSAwOwogIGZvciAoaW50IGkgPSAw
OyBpIDwgdy84OyBpKyspCiAgICAoKGNoYXIqKXJlcy52YWx1ZXMpW3cvOC0xLWldID0gc3RyW2ld
OwogIHJldHVybiByZXM7Cn0KCnRlbXBsYXRlIDxpbnQgdywgdHlwZW5hbWUuLi4gQXJncz4Kc3Rh
dGljIHNzaXplX3QgZGF0X2ZwcmludGYoRklMRSogZiwgY29uc3QgY2hhciogZm10LCBBcmdzLi4u
IGFyZ3MpCnsKICBjaGFyIHN0clt3LzgrMV07CiAgZGF0X2Zvcm1hdChzdHIsIGZtdCwgYXJncy4u
Lik7CiAgcmV0dXJuIGZ3cml0ZShzdHIsIDEsIHcvOCwgZik7Cn0KI2VuZGlmIC8qIEMrKzExICov
Cgp0ZW1wbGF0ZSA8aW50IHcsIGludCBzdz4gaW5saW5lIGRhdF90PHc+IERBVChkYXRfdDxzdz4g
ZGF0KSB7CiAgZGF0X3Q8dz4gcmVzKGRhdCk7CiAgcmV0dXJuIHJlczsKfQoKdGVtcGxhdGUgPGlu
dCB3PiBpbmxpbmUgZGF0X3Q8dz4gTElUKHZhbF90IHZhbHVlKSB7CiAgcmV0dXJuIERBVDx3Pih2
YWx1ZSk7Cn0KCnRlbXBsYXRlIDxpbnQgdz4KaW5saW5lIGRhdF90PHc+IG11eCAoIGRhdF90PDE+
IHQsIGRhdF90PHc+IGMsIGRhdF90PHc+IGEgKSB7CiAgZGF0X3Q8dz4gbWFzazsKICBiaXRfd29y
ZF9mdW5zPHZhbF9uX3dvcmRzKHcpPjo6ZmlsbChtYXNrLnZhbHVlcywgLXQubG9fd29yZCgpKTsK
ICByZXR1cm4gYSBeICgoYSBeIGMpICYgbWFzayk7Cn0KCnRlbXBsYXRlIDxpbnQgdz4KY2xhc3Mg
ZGF0el90IDogcHVibGljIGRhdF90PHc+IHsKIHB1YmxpYzoKICBkYXRfdDx3PiBtYXNrOwogIGlu
bGluZSBib29sIG9wZXJhdG9yID09ICggZGF0X3Q8dz4gbyApIHsKICAgIGRhdF90PHc+IG1hc2tl
ZCA9IChvICYgbWFzayk7CiAgICByZXR1cm4gKG8gJiBtYXNrKSA9PSAoZGF0X3Q8dz4pKnRoaXM7
CiAgfQp9OwoKdGVtcGxhdGUgPGludCB3PiBkYXR6X3Q8dz4gaW5saW5lIExJVFoodmFsX3QgdmFs
dWUsIHZhbF90IG1hc2spIHsKICBkYXR6X3Q8dz4gcmVzOyByZXMubWFzay52YWx1ZXNbMF0gPSBt
YXNrOyByZXMudmFsdWVzWzBdID0gdmFsdWU7IHJldHVybiByZXM7Cn0KCnRlbXBsYXRlIDwgaW50
IHcsIGludCB3MSwgaW50IHcyID4KaW5saW5lIGRhdF90PHc+IGNhdChkYXRfdDx3MT4gZDEsIGRh
dF90PHcyPiBkMikgewogIGlmICh3IDw9IHZhbF9uX2JpdHMoKSAmJiB3MSArIHcyID09IHcpCiAg
ICByZXR1cm4gREFUPHc+KGQxLnZhbHVlc1swXSA8PCAodzIgJiAodmFsX25fYml0cygpLTEpKSB8
IGQyLnZhbHVlc1swXSk7CiAgcmV0dXJuIERBVDx3PigoREFUPHc+KGQxKSA8PCB3MikgfCBEQVQ8
dz4oZDIpKTsKfQoKdGVtcGxhdGUgPCBpbnQgdzEgPgppbmxpbmUgZGF0X3Q8MT4gcmVkdWN0aW9u
X2FuZChkYXRfdDx3MT4gZCkgewogIHJldHVybiBEQVQ8MT4oZCA9PSB+REFUPHcxPigwKSk7Cn0K
CnRlbXBsYXRlIDwgaW50IHcxID4KaW5saW5lIGRhdF90PDE+IHJlZHVjdGlvbl9vcihkYXRfdDx3
MT4gZCkgewogIHJldHVybiBEQVQ8MT4oZCAhPSBEQVQ8dzE+KDApKTsKfQoKLy8gSSBhbSBPKG4p
IHdoZXJlIG4gaXMgbnVtYmVyIG9mIGJpdHMgaW4gdmFsX3QuIEZ1dHVyZSBvcHRpbWl6YXRpb24g
d291bGQgYmUgbG9nKG4pLgp0ZW1wbGF0ZSA8IGludCB3MSA+CmlubGluZSBkYXRfdDwxPiByZWR1
Y3Rpb25feG9yKGRhdF90PHcxPiBkKSB7CiAgZGF0X3Q8MT4gcmVzID0gREFUPDE+KDApOwogIHZh
bF90IHdvcmQgPSBkLnZhbHVlc1swXTsKCiAgZm9yIChpbnQgaSA9IDE7IGkgPCBkLm5fd29yZHNf
b2YoKTsgaSsrKQogICAgICB3b3JkIF49IGQudmFsdWVzW2ldOwogIGZvciAoaW50IGkgPSAwOyBp
IDwgc2l6ZW9mKHZhbF90KSo4OyBpKyspIHsKICAgICAgcmVzID0gcmVzIF4gREFUPDE+KHdvcmQg
JiAxKTsKICAgICAgd29yZCA9IHdvcmQgPj4gMTsKICB9CgogIHJldHVybiByZXM7Cn0KCnRlbXBs
YXRlIDxpbnQgdywgaW50IGQ+CmNsYXNzIG1lbV90IHsKIHB1YmxpYzoKICBkYXRfdDx3PiBjb250
ZW50c1tkXTsKICB2YWxfdCBkdW1teV9zZWVkOwogIHZhbF90KiBzZWVkcDsKCiAgaW50IHdpZHRo
KCkgewogICAgcmV0dXJuIHc7CiAgfQogIGludCBsZW5ndGgoKSB7CiAgICByZXR1cm4gZDsKICB9
CgogIHRlbXBsYXRlIDxpbnQgaXc+CiAgZGF0X3Q8dz4gZ2V0IChkYXRfdDxpdz4gaWR4KSB7CiAg
ICByZXR1cm4gZ2V0KGlkeC5sb193b3JkKCkgJiAobmV4dHBvdzJfMShkKS0xKSk7CiAgfQogIGRh
dF90PHc+IGdldCAodmFsX3QgaWR4KSB7CiAgICBpZiAoIWlzcG93MihkKSAmJiBpZHggPj0gZCkg
ewogICAgICBkYXRfdDx3PiByZXM7CiAgICAgIHJlcy5yYW5kb21pemUoc2VlZHApOwogICAgICBy
ZXR1cm4gcmVzOwogICAgfQogICAgcmV0dXJuIGNvbnRlbnRzW2lkeF07CiAgfQogIHZhbF90IGdl
dCAodmFsX3QgaWR4LCBpbnQgd29yZCkgewogICAgaWYgKCFpc3BvdzIoZCkgJiYgaWR4ID49IGQp
CiAgICAgIHJldHVybiBfX3JhbmRfdmFsKHNlZWRwKSAmICh3b3JkID09IHZhbF9uX3dvcmRzKHcp
ICYmIHZhbF9uX3dvcmRfYml0cyh3KSA/IG1hc2tfdmFsKHcpIDogLTFMKTsKICAgIHJldHVybiBj
b250ZW50c1tpZHhdLnZhbHVlc1t3b3JkXTsKICB9CgogIHRlbXBsYXRlIDxpbnQgaXc+CiAgdm9p
ZCBwdXQgKGRhdF90PGl3PiBpZHgsIGRhdF90PHc+IHZhbCkgewogICAgcHV0KGlkeC5sb193b3Jk
KCksIHZhbCk7CiAgfQogIHZvaWQgcHV0ICh2YWxfdCBpZHgsIGRhdF90PHc+IHZhbCkgewogICAg
aWYgKGlzcG93MihkKSB8fCBpZHggPCBkKQogICAgICBjb250ZW50c1tpZHhdID0gdmFsOwogIH0K
ICB2YWxfdCBwdXQgKHZhbF90IGlkeCwgaW50IHdvcmQsIHZhbF90IHZhbCkgewogICAgaWYgKGlz
cG93MihkKSB8fCBpZHggPCBkKQogICAgICBjb250ZW50c1tpZHhdLnZhbHVlc1t3b3JkXSA9IHZh
bDsKICB9CgogIHZvaWQgcHJpbnQgKCB2b2lkICkgewogICAgZm9yIChpbnQgaiA9IDA7IGogPCBk
LzQ7IGorKykgewogICAgICBmb3IgKGludCBpID0gMDsgaSA8IDQ7IGkrKykgewogICAgICAgIGlu
dCBpZHggPSBqKjQraTsKICAgICAgICBwcmludGYoInwlMmQ6ICUxNmxseHwgIiwgaWR4LCBjb250
ZW50c1tpZHhdLmxvX3dvcmQoKSk7CiAgICAgIH0KICAgICAgcHJpbnRmKCJcbiIpOwogICAgfQog
IH0KICBtZW1fdDx3LGQ+ICgpIHsKICAgIGR1bW15X3NlZWQgPSAxOwogICAgc2VlZHAgPSAmZHVt
bXlfc2VlZDsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZDsgaSsrKQogICAgICBjb250ZW50c1tp
XSA9IERBVDx3PigwKTsKICB9CiAgdm9pZCByYW5kb21pemUodmFsX3QqIHNlZWQpIHsKICAgIHNl
ZWRwID0gc2VlZDsKICAgIGZvciAoaW50IGkgPSAwOyBpIDwgZDsgaSsrKQogICAgICBjb250ZW50
c1tpXS5yYW5kb21pemUoc2VlZCk7CiAgfQogIHNpemVfdCByZWFkX2hleChjb25zdCBjaGFyICpo
ZXhGaWxlTmFtZSkgewogICAgaWZzdHJlYW0gaWZwKGhleEZpbGVOYW1lKTsKICAgIGlmIChpZnAu
ZmFpbCgpKSB7CiAgICAgIHByaW50ZigiW2Vycm9yXSBVbmFibGUgdG8gb3BlbiBoZXggZGF0YSBm
aWxlICVzXG4iLCBoZXhGaWxlTmFtZSk7CiAgICAgIHJldHVybiAtMTsKICAgIH0KICAgIHN0ZDo6
c3RyaW5nIGhleF9saW5lOwogICAgZGF0X3Q8dz4gaGV4X2RhdDsKICAgIGZvciAoaW50IGFkZHIg
PSAwOyBhZGRyIDwgZCAmJiAhaWZwLmVvZigpOykgewogICAgICBnZXRsaW5lKGlmcCwgaGV4X2xp
bmUpOwogICAgICBpZiAoZGF0X2Zyb21faGV4KGhleF9saW5lLCBoZXhfZGF0KSA+IDApIHsKCWNv
bnRlbnRzW2FkZHIrK10gPSBoZXhfZGF0OwogICAgICB9CiAgICB9CiAgICBpZnAuY2xvc2UoKTsK
ICAgIHJldHVybiAwOwogIH0KfTsKCnN0YXRpYyBjaGFyIGhleF90b19jaGFyW10gPSAiMDEyMzQ1
Njc4OWFiY2RlZiI7CgpzdGF0aWMgaW50ICBjaGFyX3RvX2hleFtdID0gewogIC0xLC0xLC0xLC0x
LC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLAogIC0xLC0xLC0xLC0xLC0xLC0x
LC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLAogIC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0x
LC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLAogICAwLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5
LC0xLC0xLC0xLC0xLC0xLC0xLAogIC0xLDEwLDExLDEyLDEzLDE0LDE1LC0xLC0xLC0xLC0xLC0x
LC0xLC0xLC0xLC0xLAogIC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0x
LC0xLC0xLAogIC0xLDEwLDExLDEyLDEzLDE0LDE1LC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0x
LAogIC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLAogIC0x
LC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLAogIC0xLC0xLC0x
LC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLAogIC0xLC0xLC0xLC0xLC0x
LC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLAogIC0xLC0xLC0xLC0xLC0xLC0xLC0x
LC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLAogIC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0x
LC0xLC0xLC0xLC0xLC0xLC0xLC0xLAogIC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0x
LC0xLC0xLC0xLC0xLC0xLAogIC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0x
LC0xLC0xLC0xLAogIC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0xLC0x
LC0xIH07CgovLyBkYXRfZnJvbV9oZXg6IFJlYWQgYSBoZXggdmFsdWUgZnJvbSBhIHN0ZDo6c3Ry
aW5nIGludG8gYSBnaXZlbiBkYXRfdCB2YXJpYWJsZS4KLy8gQXV0aG9yOiBCLiBSaWNoYXJkcywg
Zm9yIHBhcnNpbmcgZGF0YSBmb3JtYXR0ZWQgZm9yIFZlcmlsb2cgJHJlYWRtZW1oCi8vIEFyZ3Vt
ZW50czoKLy8gICBoZXhfbGluZSAgQSBzdHJpbmcgY29udGFpbmluZyBoZXggbnVtYmVycyB3aXRo
IGVtYmVkZGVkIHgsIF8gY2hhcmFjdGVycwovLyAgIHJlcyAgICAgICBBIGRhdF90IG9iamVjdCB0
byBmaWxsIGluIHdpdGggYSByZXR1cm4gdmFsdWUKLy8gICBvZmZzZXQgICAgU3RhcnRpbmcgaW5k
ZXggaW4gaGV4X2xpbmUKLy8gUmV0dXJuIHZhbHVlOgovLyAgIFN1Y2Nlc3M6IHJldHVybnMgbmV4
dCBjaGFyYWN0ZXIgb2Zmc2V0Ci8vICAgRmFpbDogICAgMAp0ZW1wbGF0ZSA8aW50IHc+CnNpemVf
dCBkYXRfZnJvbV9oZXgoc3RkOjpzdHJpbmcgaGV4X2xpbmUsIGRhdF90PHc+JiByZXMsIHNpemVf
dCBvZmZzZXQgPSAwKSB7CiAgc2l6ZV90IGZpcnN0X2RpZ2l0LCBsYXN0X2RpZ2l0LCBjb21tZW50
OwoKICAvLyBTY2FuIGZvciB0aGUgaGV4IGRhdGEgYm91bmRzLgogIGNvbW1lbnQgPSBoZXhfbGlu
ZS5maW5kX2ZpcnN0X29mKCIvIiwgb2Zmc2V0KTsKICBmaXJzdF9kaWdpdCA9IGhleF9saW5lLmZp
bmRfZmlyc3Rfb2YoIjAxMjM0NTY3ODlhYmNkZWZBQkNERUYiLCBvZmZzZXQpOwogIGlmIChmaXJz
dF9kaWdpdCA9PSBzdGQ6OnN0cmluZzo6bnBvcykgcmV0dXJuIDA7CiAgaWYgKGNvbW1lbnQgIT0g
c3RkOjpzdHJpbmc6Om5wb3MgJiYgY29tbWVudCA8IGZpcnN0X2RpZ2l0KSByZXR1cm4gMDsKICBs
YXN0X2RpZ2l0ID0gaGV4X2xpbmUuZmluZF9maXJzdF9ub3Rfb2YoIjAxMjM0NTY3ODlhYmNkZWZB
QkNERUZfeFgiLCBmaXJzdF9kaWdpdCk7CiAgaWYgKGxhc3RfZGlnaXQgPT0gc3RkOjpzdHJpbmc6
Om5wb3MpIHsKICAgIGxhc3RfZGlnaXQgPSBoZXhfbGluZS5sZW5ndGgoKSAtIDE7CiAgfSBlbHNl
IHsKICAgIGxhc3RfZGlnaXQtLTsKICB9CgogIC8vIENvbnZlcnQgdGhlIGhleCBkYXRhIHRvIGEg
ZGF0X3QsIGZyb20gcmlnaHQgdG8gbGVmdC4KICBpbnQgZGlnaXRfdmFsOwogIHZhbF90IHdvcmRf
YWNjdW0gPSAwOwogIGludCBkaWdpdCwgd19pbmRleCwgYml0OwogIGZvciAoZGlnaXQgPSBsYXN0
X2RpZ2l0LCB3X2luZGV4ID0gMCwgYml0ID0gMDsgZGlnaXQgPj0gKGludClmaXJzdF9kaWdpdCAm
JiB3X2luZGV4IDwgcmVzLm5fd29yZHM7IGRpZ2l0LS0pIHsKICAgIGRpZ2l0X3ZhbCA9IGNoYXJf
dG9faGV4W2hleF9saW5lW2RpZ2l0XV07CiAgICBpZiAoZGlnaXRfdmFsID49IDApIHsKICAgICAg
d29yZF9hY2N1bSB8PSAoKHZhbF90KWRpZ2l0X3ZhbCkgPDwgYml0OwogICAgICBiaXQgKz0gNDsK
ICAgICAgaWYgKGJpdCA9PSA2NCkgewoJcmVzLnZhbHVlc1t3X2luZGV4XSA9IHdvcmRfYWNjdW07
Cgl3b3JkX2FjY3VtID0gMEw7CgliaXQgPSAwOwoJd19pbmRleCsrOwogICAgICB9CiAgICB9CiAg
fQogIGlmIChiaXQgIT0gMCkgewogICAgcmVzLnZhbHVlc1t3X2luZGV4XSA9IHdvcmRfYWNjdW07
CiAgfQogIC8vIFJldHVybiBhIHBvaW50ZXIgdG8gdGhlIGNoYXJhY3RlciBhZnRlciB0aGUgY29u
dmVydGVkIHZhbHVlLgogIHJldHVybiBsYXN0X2RpZ2l0ICsgMTsKfQoKI3ByYWdtYSBHQ0MgcHVz
aF9vcHRpb25zCiNwcmFnbWEgR0NDIG9wdGltaXplICgibm8tc3RhY2stcHJvdGVjdG9yIikKCnRl
bXBsYXRlIDxpbnQgcywgaW50IHc+CnZvaWQgZGF0X2R1bXAgKEZJTEUqIGYsIGNvbnN0IGRhdF90
PHc+JiB2YWwsIHZhbF90IG5hbWUpIHsKICBzaXplX3QgcG9zID0gMDsKICBjaGFyIHN0clsxICsg
dyArIDEgKyBzICsgMV07CgogIHN0cltwb3MrK10gPSAnYic7CiAgZm9yIChpbnQgaSA9IDA7IGkg
PCB3OyBpKyspCiAgICBzdHJbcG9zICsgdy1pLTFdID0gJzAnICsgKCh2YWwudmFsdWVzW2kvdmFs
X25fYml0cygpXSA+PiAoaSV2YWxfbl9iaXRzKCkpKSAmIDEpOwogIHBvcyArPSB3OwoKICBzdHJb
cG9zKytdID0gJyAnOwogIGZvciAoaW50IGkgPSAwOyBpIDwgczsgaSsrKSB7CiAgICBzdHJbcG9z
KytdID0gbmFtZTsKICAgIG5hbWUgPj49IDg7CiAgfQogIHN0cltwb3MrK10gPSAnXG4nOwoKICBm
d3JpdGUoc3RyLCAxLCBzaXplb2Yoc3RyKSwgZik7Cn0KCiNwcmFnbWEgR0NDIHBvcF9vcHRpb25z
CgppbmxpbmUgc3RkOjpzdHJpbmcgcmVhZF90b2soRklMRSogZikgewogIHN0ZDo6c3RyaW5nIHJl
czsKICBib29sIGlzX3NraXBwaW5nID0gdHJ1ZTsKICBmb3IgKDs7KSB7CiAgICBjaGFyIGMgPSBm
Z2V0YyhmKTsKICAgIGlmIChmZW9mKGYpKQogICAgICByZXR1cm4gcmVzOwogICAgaWYgKGlzX3Nr
aXBwaW5nKSB7CiAgICAgIGlmIChjaGFyX3RvX2hleFtjXSAhPSAtMSkgewogICAgICAgIHJlcy5w
dXNoX2JhY2soYyk7CiAgICAgICAgaXNfc2tpcHBpbmcgPSBmYWxzZTsKICAgICAgfQogICAgfSBl
bHNlIHsKICAgICAgaWYgKGNoYXJfdG9faGV4W2NdID09IC0xKSB7CiAgICAgICAgdW5nZXRjKGMs
IGYpOwogICAgICAgIHJldHVybiByZXM7CiAgICAgIH0KICAgICAgcmVzLnB1c2hfYmFjayhjKTsK
ICAgIH0KICB9Cn0KCnRlbXBsYXRlIDxpbnQgcywgaW50IHcsIGludCBkPgp2b2lkIGRhdF9kdW1w
KEZJTEUqIGZpbGUsIGNvbnN0IG1lbV90PHcsZD4mIHZhbCwgdmFsX3QgbmFtZSkgewp9Cgp0ZW1w
bGF0ZSA8aW50IHcsIGludCBkPiBtZW1fdDx3LGQ+IE1FTSggdm9pZCApOwoKY2xhc3MgbW9kX3Qg
ewogcHVibGljOgoJbW9kX3QoKToKCSAgZHVtcGZpbGUoTlVMTCkKICAgIHt9CiAgc3RkOjp2ZWN0
b3I8IG1vZF90KiA+IGNoaWxkcmVuOwogIHZpcnR1YWwgdm9pZCBpbml0ICggdmFsX3QgcmFuZF9p
bml0PWZhbHNlICkgeyB9OwogIHZpcnR1YWwgdm9pZCBjbG9ja19sbyAoIGRhdF90PDE+IHJlc2V0
ICkgeyB9OwogIHZpcnR1YWwgdm9pZCBjbG9ja19oaSAoIGRhdF90PDE+IHJlc2V0ICkgeyB9Owog
IHZpcnR1YWwgaW50ICBjbG9jayAoIGRhdF90PDE+IHJlc2V0ICkgeyB9OwogIHZpcnR1YWwgdm9p
ZCBzZXRDbG9ja3MgKCBzdGQ6OnZlY3RvcjwgaW50ID4mIHBlcmlvZHMgKSB7IH07CgogIC8vIFJl
dHVybnMgYSBjbG9uZSBvZiB0aGlzIG9iamVjdCdzIGNpcmN1aXQgc3RhdGUgKGJvdGggcmVnaXN0
ZXJzIGFuZCB3aXJlcykuCiAgLy8gQ3VycmVudGx5LCBpdCBpcyB1bmRlZmluZWQgd2hhdCBoYXBw
ZW5zIHRvIG90aGVyIHN0YXRlIChsaWtlIGR1bXBmaWxlIGFuZAogIC8vIHRpbWVzdGVwKSwgc28g
dXNlIHdpdGggY2FyZS4KICB2aXJ0dWFsIG1vZF90KiBjbG9uZSgpID0gMDsKICAvLyBTZXRzIHRo
aXMgbW9kdWxlJ3MgY2lyY3VpdCBzdGF0ZSAocmVnaXN0ZXJzIGFuZCB3aXJlcykgZnJvbSB0aGUg
c3JjIG1vZF90LgogIC8vIEZvciBtb2RfdCBzdWJjbGFzc2VzLCBzcmMgbXVzdCBiZSB0aGUgc2Ft
ZSBjbGFzcy4KICAvLyBSZXR1cm5zIHRydWUgb24gc3VjY2VzcywgYW5kIGZhbHNlIG9uIGZhaWx1
cmUuIEN1cnJlbnRseSwgbm8gZ3VhcmFudGVlcwogIC8vIGFyZSBtYWRlIGFib3V0IHN0YXRlIGNv
bnNpc3RlbmN5IG9uIGZhaWx1cmUsCiAgdmlydHVhbCBib29sIHNldF9jaXJjdWl0X2Zyb20obW9k
X3QqIHNyYykgPSAwOwoKICB2aXJ0dWFsIHZvaWQgcHJpbnQgKCBGSUxFKiBmICkgeyB9OwogIHZp
cnR1YWwgdm9pZCBkdW1wICggRklMRSogZiwgaW50IHQgKSB7IH07CgogIHZvaWQgc2V0X2R1bXBm
aWxlKEZJTEUqIGYpIHsKCWR1bXBmaWxlID0gZjsKICB9CgogIGludCB0aW1lc3RlcDsKCiAgdm9p
ZCBkdW1wICgpIHsKICAgIGlmIChkdW1wZmlsZSAhPSBOVUxMKSBkdW1wKGR1bXBmaWxlLCB0aW1l
c3RlcCk7CiAgICB0aW1lc3RlcCArPSAxOwogIH0KCiAgaW50IHN0ZXAgKGJvb2wgaXNfcmVzZXQs
IGludCBuKSB7CiAgICBpbnQgZGVsdGEgPSAwOwogICAgZGF0X3Q8MT4gcmVzZXQgPSBMSVQ8MT4o
aXNfcmVzZXQpOwogICAgZm9yIChpbnQgaSA9IDA7IGkgPCBuOyBpKyspIHsKICAgICAgZGVsdGEg
Kz0gY2xvY2socmVzZXQpOwogICAgICBkdW1wKCk7CiAgICB9CiAgICByZXR1cm4gZGVsdGE7CiAg
fQogcHJvdGVjdGVkOgogIEZJTEUqIGR1bXBmaWxlOwp9OwoKI2RlZmluZSBBU1NFUlQoY29uZCwg
bXNnKSB7IFwKICBpZiAoIShjb25kKSkgXAogICAgdGhyb3cgc3RkOjpydW50aW1lX2Vycm9yKCJB
c3NlcnRpb24gZmFpbGVkOiAiIG1zZyk7IFwKfQoKI3ByYWdtYSBHQ0MgZGlhZ25vc3RpYyBwb3AK
I2VuZGlmCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALi9lbXVsYXRvci5oAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMDA2NDQAMDAwMTc1MAAwMDAxNzUwADAwMDAwMDAwMTQy
ADEyMzU3Mjc1NDExADAxMjU0MgAgMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAB1c3RhciAgAHBhbG1lcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcGFsbWVyAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvLyBtZXRhaGVhZGVyIGZvciB0aGUg
Q2hpc2VsIGVtdWxhdG9yIGFuZCBBUEkKI2luY2x1ZGUgImVtdWxhdG9yX21vZC5oIgojaW5jbHVk
ZSAiZW11bGF0b3JfYXBpLmgiCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==
